(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    490102,      10585]
NotebookOptionsPosition[    463661,      10165]
NotebookOutlinePosition[    464129,      10183]
CellTagsIndexPosition[    464086,      10180]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Milestones/upgrades :", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}},
 FontSize->24,ExpressionUUID->"a76476ed-08a0-407d-a6e0-2949da3fdc82"],

Cell[CellGroupData[{

Cell["Batch processing for memory efficiency", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.889043465537898*^9, {3.9259139028182545`*^9, 
   3.925913907601715*^9}, {3.926493932376672*^9, 3.9264939499288487`*^9}, {
   3.926999284926278*^9, 3.9269993456917896`*^9}, {3.9275390075313606`*^9, 
   3.9275390138993535`*^9}, {3.952052516974724*^9, 3.952052516974724*^9}},
 FontSize->18,ExpressionUUID->"6a59745b-6ad2-4ef1-89fd-eb4066bc4f53"],

Cell["\<\
Generalize the drag calculation to cylinders, ellipsoids, spirilla, etc.\
\>", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.889043465537898*^9, {3.9259139028182545`*^9, 
   3.925913907601715*^9}, {3.926493932376672*^9, 3.9264939499288487`*^9}, {
   3.926999284926278*^9, 3.9269993456917896`*^9}, {3.9275390075313606`*^9, 
   3.9275390138993535`*^9}, {3.952052518180749*^9, 3.952052543788082*^9}},
 FontSize->18,ExpressionUUID->"cae2cf31-d2d5-486b-a36b-ac3252bfc56e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 
   3.890508677778922*^9}},ExpressionUUID->"10050003-92b2-41b0-8436-\
5d8cb5b7cce9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbd", ":=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "packageDirectory", ":=", 
   "\"\<D:\\\\Science\\\\NMI (VTPMML)\\\\MHD Project\\\\Image \
Processing\\\\Mathematica Libraries & Packages\\\\Quantile \
Regression\\\\\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"packageDirectory", "<>", "\"\<QuantileRegression.m\>\""}], "]"}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "MaTeX`"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"Filling", "\[Rule]", "None"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListDensityPlot", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListPlot3D", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TicksStyle", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"launchNukes", "[", "useKernels_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Kernels", "[", "]"}]}], "<", "#"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "-", 
          RowBox[{"Length", "@", 
           RowBox[{"Kernels", "[", "]"}]}]}], "//", "LaunchKernels"}], ",", 
        "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}], 
      "&"}], "@", "useKernels"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mainOutputFolder", "=", 
   RowBox[{"nbd", "<>", "\"\<Output\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "mainOutputFolder"}], ";"}], "//", 
   "Quiet"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"progress", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"TableForm", "@", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<Processing...\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"ProgressIndicator", "@", 
       RowBox[{"Dynamic", "[", 
        RowBox[{
         RowBox[{"x", "/", "y"}], "//", "N"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"Round", "@", "x"}]}], "<>", "\"\</\>\"", "<>", 
       RowBox[{"ToString", "@", "y"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ToString", "@", 
       RowBox[{"PercentForm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "/", "y"}], "//", "N"}], ",", 
         RowBox[{"DefaultPrintPrecision", "\[Rule]", "1"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"memoryCheck", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"\"\<Memory in use: \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemoryInUse", "[", "]"}], "/", 
        RowBox[{"1024", "^", "3"}]}], "//", "N"}], "]"}], "<>", 
     "\"\< Gb\>\""}], "//", "Print"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"memoryCleanupStart", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Memory in use: \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemoryInUse", "[", "]"}], "/", 
           RowBox[{"1024", "^", "3"}]}], "//", "N"}], "]"}], "<>", 
        "\"\< Gb\>\""}], "//", "Print"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Unprotect", "@", "Out"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ClearSystemCache", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"memoryCleanupFinalize", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "@", "Out"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Protect", "@", "Out"}], ";", "\[IndentingNewLine]", 
      RowBox[{"LaunchKernels", "@", "useKernels"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Memory in use after cleanup: \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemoryInUse", "[", "]"}], "/", 
           RowBox[{"1024", "^", "3"}]}], "//", "N"}], "]"}], "<>", 
        "\"\< Gb\>\""}], "//", "Print"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"useKernels", "=", 
   RowBox[{"2", "*", "$ProcessorCount"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "@", "monitorCounter"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontSize", "=", "16"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8169304402015343`*^9, 3.8169304572329664`*^9}, {
   3.817297782007059*^9, 3.81729778360575*^9}, {3.817308232575077*^9, 
   3.8173082329091744`*^9}, {3.8173082654542065`*^9, 
   3.8173082661323175`*^9}, {3.8173083731116056`*^9, 3.817308436969288*^9}, 
   3.8173084714569016`*^9, 3.817308641528023*^9, {3.8215187351516724`*^9, 
   3.8215187451204844`*^9}, {3.8215212453537927`*^9, 
   3.8215212812414527`*^9}, {3.8215217470822363`*^9, 3.821521772298771*^9}, {
   3.821521813453446*^9, 3.821521857595766*^9}, {3.8215222341401415`*^9, 
   3.821522259318509*^9}, {3.82152326402353*^9, 3.8215232643347263`*^9}, {
   3.821530441037798*^9, 3.821530444877508*^9}, {3.821530481189026*^9, 
   3.82153057883045*^9}, {3.821542161396227*^9, 3.821542175551358*^9}, {
   3.8215580973521657`*^9, 3.8215581067121277`*^9}, {3.821605050390068*^9, 
   3.8216050553070993`*^9}, 3.8222976400725813`*^9, {3.8223704281181946`*^9, 
   3.8223704510386715`*^9}, {3.822370484639129*^9, 3.8223706107676973`*^9}, {
   3.8223706477507224`*^9, 3.8223706492089605`*^9}, {3.828688650553396*^9, 
   3.8286886604331484`*^9}, {3.8286887169625216`*^9, 3.82868871879954*^9}, 
   3.837423323092683*^9, {3.8374471631829567`*^9, 3.837447166189891*^9}, 
   3.837482865647195*^9, {3.83748650590446*^9, 3.837486515674389*^9}, {
   3.8374865601047926`*^9, 3.8374865698484826`*^9}, {3.837573800224904*^9, 
   3.837573827721392*^9}, {3.8382948555756283`*^9, 3.8382948875230775`*^9}, {
   3.8392405080734577`*^9, 3.839240509496673*^9}, {3.845908474521624*^9, 
   3.845908486131469*^9}, {3.8460780854049487`*^9, 3.8460780863893166`*^9}, {
   3.8468449093043537`*^9, 3.846844911120497*^9}, 3.846845057328478*^9, {
   3.8468450886410856`*^9, 3.846845088896404*^9}, {3.8468451740330434`*^9, 
   3.8468451944241047`*^9}, {3.847633582605837*^9, 3.847633582957895*^9}, 
   3.8521991480171003`*^9, {3.8542845528223853`*^9, 3.854284566766261*^9}, {
   3.8546067085403414`*^9, 3.854606718740966*^9}, 3.855684893220052*^9, {
   3.88831414352378*^9, 3.8883141487731967`*^9}, {3.8889239447295322`*^9, 
   3.8889239518936615`*^9}, {3.889165761976347*^9, 3.8891657724817114`*^9}, {
   3.889898236868268*^9, 3.8898983075866747`*^9}, 3.889981877139629*^9, {
   3.8901318183226905`*^9, 3.8901318584877768`*^9}, {3.8901319074468603`*^9, 
   3.890131912198653*^9}, {3.890132095418976*^9, 3.8901321015214944`*^9}, 
   3.8901983781346855`*^9, {3.8902093468712406`*^9, 3.89020937629113*^9}, {
   3.8903842578656683`*^9, 3.8903842592897663`*^9}, {3.8907148424415026`*^9, 
   3.890714849790765*^9}, {3.890720681833416*^9, 3.8907206948838787`*^9}, {
   3.8928284198180013`*^9, 3.8928284202993*^9}, 3.892918082467703*^9, {
   3.894826375532895*^9, 3.894826378457651*^9}, {3.896368873022723*^9, 
   3.89636890499323*^9}, {3.896368974004279*^9, 3.8963689769333963`*^9}, {
   3.896437869641526*^9, 3.8964378700893507`*^9}, {3.8964393688238535`*^9, 
   3.8964393869032793`*^9}, {3.9123500618050685`*^9, 3.91235007133414*^9}, {
   3.9157387666914177`*^9, 3.915738775940425*^9}, {3.915739635929779*^9, 
   3.9157396392921734`*^9}, 3.92864067955416*^9, 3.9391099237489367`*^9, {
   3.952574433906576*^9, 3.95257445384201*^9}, 3.952574490050229*^9, {
   3.952574536803027*^9, 3.9525745651510553`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9f6bf2bf-eab3-43ac-8b5f-7574dacd0084"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Images <<", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8474400491164675`*^9, 3.8474400514841356`*^9}, {3.8905086724664745`*^9, 
  3.890508675362257*^9}},ExpressionUUID->"7fc10344-7ed1-41e1-89e5-\
a93daa297024"],

Cell["\<\
Pixel size :\[LineSeparator]
2023-10-25--18:   0.11 \[Mu]m
2023-10-23--7:   0.11 \[Mu]m
2023-10-23--4:   0.11 \[Mu]m
cocci_moment:   0.11 \[Mu]m
U_turns_for_validation:   0.11 \[Mu]m
U_turns_with_MF:   0.11 \[Mu]m
U-turns_16_apr:   0.11 \[Mu]m
U-turns_19_apr:   0.11 \[Mu]m
  --------------------------------------------------
FPS/frame duration :

2023-10-25--18:   10 fps / 100 ms
2023-10-23--7:   40 fps / 25 ms
2023-10-23--4:   50 fps / 20 ms
cocci_moment:   40 fps / 25 ms
U_turns_for_validation:   40 fps / 25 ms
U_turns_with_MF:   20 fps / 50 ms
U-turns_16_apr:   20 fps / 50 ms
U-turns_19_apr:   20 fps / 50 ms\
\>", "Abstract",
 CellChangeTimes->{{3.860734951349084*^9, 3.860735026478571*^9}, {
   3.8609146608535275`*^9, 3.8609146900929856`*^9}, 3.8609204395870028`*^9, {
   3.8609205850911922`*^9, 3.860920585251766*^9}, {3.861617003782383*^9, 
   3.861617047418807*^9}, {3.8616503848168697`*^9, 3.861650394647577*^9}, {
   3.861694332607851*^9, 3.861694365734353*^9}, {3.86169440087022*^9, 
   3.8616944709419107`*^9}, {3.861694614767084*^9, 3.861694644189275*^9}, {
   3.8616998710451202`*^9, 3.861699879369816*^9}, {3.8852939036655765`*^9, 
   3.8852939204171*^9}, {3.888395947610839*^9, 3.888395983866202*^9}, {
   3.8883964152975245`*^9, 3.888396472672748*^9}, {3.888913733747225*^9, 
   3.888913750746273*^9}, {3.8969452347374234`*^9, 3.8969452884043727`*^9}, {
   3.898162639472965*^9, 3.8981626460249853`*^9}, 3.8997981936052575`*^9, {
   3.8998709924898815`*^9, 3.899871054646696*^9}, {3.900049176114311*^9, 
   3.9000491834023952`*^9}, {3.9006757674573708`*^9, 3.900675808736613*^9}, {
   3.9006758414894085`*^9, 3.900675860241229*^9}, {3.900744452232774*^9, 
   3.9007444595306845`*^9}, {3.9156231328148594`*^9, 3.91562318337386*^9}, {
   3.917003375112545*^9, 3.9170033903040533`*^9}, {3.9170035930569696`*^9, 
   3.91700359603172*^9}, {3.917003653553728*^9, 3.917003691932147*^9}, {
   3.9170037260931644`*^9, 3.917003777433728*^9}, {3.9170388210022388`*^9, 
   3.917038861524263*^9}, {3.9174670210841994`*^9, 3.9174670467261143`*^9}, {
   3.9272892394178343`*^9, 3.927289268242099*^9}, {3.92730135573736*^9, 
   3.927301357626377*^9}, {3.927387257960538*^9, 3.9273872609211917`*^9}, {
   3.9278038369995704`*^9, 3.927803837143662*^9}, {3.927803872977233*^9, 
   3.9278038968471723`*^9}, {3.9417937111144695`*^9, 
   3.9417937666547985`*^9}},ExpressionUUID->"18851393-ebac-4058-8d97-\
b1bd19b45a11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pixelSizeMicroMeters", "=", "0.11"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameRate", "=", "40"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameDurationMiliSeconds", "=", 
   RowBox[{"1000", "/", "frameRate"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frameDurationSeconds", "=", 
    RowBox[{
     RowBox[{"frameDurationMiliSeconds", "/", "1000"}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "imageFolder", ":=", 
   "\"\<D:\\\\[BIG DATA]\\\\ACTIVE - Data From Experiments\\\\MMML \
Data\\\\Bacteria Tracking\\\\Ogre River Cocci\\\\\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subFolder", "=", "\"\<23_oct_7\\\\\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawImageFormat", "=", "\"\<*.tif\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"metadataFolder", "=", 
     RowBox[{"SetDirectory", "[", "\[IndentingNewLine]", 
      RowBox[{
      "imageFolder", "<>", 
       "\"\<U-turns with MF \
Readings\\\\From_Ivars_Drikis_U-turns\\\\uturn_field\\\\\>\""}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"metadataFiles", "=", 
     RowBox[{"FileNames", "[", "\"\<*.txt\>\"", "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"relevantDataCode", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    "$PathnameSeparator", "\[Rule]", " ", "\"\<_\>\""}]}], 
                    "]"}], "&"}], "@", 
                  RowBox[{"FileNameJoin", "@", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "3"}], "]"}], "]"}]}]}], "&"}], "@", 
                RowBox[{"StringSplit", "[", 
                 RowBox[{"#", ",", "\"\<_\>\""}], "]"}]}], "&"}], "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "@", 
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Basler acA1920-155um\>\"", ",", "rawImageFormat"}], 
               "}"}]}], "]"}]}], "&"}], "@", 
          RowBox[{"Import", "[", "\[IndentingNewLine]", 
           RowBox[{"metadataFolder", "<>", "$PathnameSeparator", "<>", 
            RowBox[{"metadataFiles", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
          "&"}], "@", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"Last", "@", 
          RowBox[{"StringSplit", "[", 
           RowBox[{"#", ",", "\"\<-\>\""}], "]"}]}]}]}], "&"}], "@", 
      RowBox[{"Last", "@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"subFolder", ",", "$PathnameSeparator"}], "]"}]}]}]}], ";"}], 
   "*)"}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileFolder", "=", 
    RowBox[{"SetDirectory", "[", 
     RowBox[{"imageFolder", "<>", "subFolder"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"#", ",", 
         RowBox[{"StringContainsQ", "@", "relevantDataCode"}]}], "]"}], "&"}],
       "@"}], "*)"}], 
    RowBox[{"(*", 
     RowBox[{"Reverse", "@"}], "*)"}], 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "rawImageFormat", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"files", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "12"}], "]"}], "]"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"output", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mainOutputFolder", "<>", 
        RowBox[{"Last", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"#", ",", "$PathnameSeparator"}], "]"}]}]}], "&"}], "@", 
      "fileFolder"}], "<>", "$PathnameSeparator"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "output"}], ";"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataCSVfolder", "=", 
   RowBox[{"output", "<>", "\"\<CSV\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "dataCSVfolder"}], ";"}], "//", "Quiet"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataCompressedfolder", "=", 
   RowBox[{"output", "<>", "\"\<Compressed Data\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateDirectory", "@", "dataCompressedfolder"}], ";"}], "//", 
  "Quiet"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8223706440166283`*^9, 3.822370655408784*^9}, {
   3.828688415466848*^9, 3.82868842302295*^9}, {3.8374366106307073`*^9, 
   3.837436612730121*^9}, {3.8374366659407735`*^9, 3.837436692066312*^9}, {
   3.8381903902811985`*^9, 3.83819039139227*^9}, {3.8381904680399017`*^9, 
   3.8381904695363336`*^9}, 3.838216530611554*^9, {3.8382191179383373`*^9, 
   3.8382191248648205`*^9}, {3.8382729728363075`*^9, 3.838272996674044*^9}, {
   3.8382863609276934`*^9, 3.8382863610304193`*^9}, {3.838305050105472*^9, 
   3.8383050674773693`*^9}, 3.8383531801353483`*^9, 3.8383552870779576`*^9, 
   3.838355950741046*^9, {3.8383583080979815`*^9, 3.838358320838064*^9}, 
   3.838358642262561*^9, 3.83835938412653*^9, {3.8383596741132855`*^9, 
   3.838359675237794*^9}, 3.8383672241736517`*^9, 3.8383677158146973`*^9, 
   3.8383782172319813`*^9, 3.8383812717115183`*^9, 3.8383919404134965`*^9, {
   3.8383951404896803`*^9, 3.838395141945258*^9}, 3.8383957508263054`*^9, 
   3.8383962092769995`*^9, 3.838440178597614*^9, {3.8384603062397842`*^9, 
   3.83846030632755*^9}, 3.8384874747868905`*^9, 3.8384886340622716`*^9, 
   3.8384898184326525`*^9, 3.8387144349807224`*^9, 3.838718387768408*^9, 
   3.838783672135442*^9, 3.8387855431967335`*^9, 3.8388052155423717`*^9, 
   3.8388052707430196`*^9, 3.8388138451768236`*^9, 3.8388182456485386`*^9, 
   3.839148895384262*^9, 3.8391507672002506`*^9, {3.8392272156353474`*^9, 
   3.8392272162187853`*^9}, 3.8392286941850123`*^9, 3.8392361561605406`*^9, 
   3.839237054370471*^9, 3.8392376434789*^9, 3.839239551639701*^9, {
   3.8392405156909723`*^9, 3.8392405166323752`*^9}, 3.8426915720122404`*^9, 
   3.8426995743483825`*^9, 3.842701441707861*^9, {3.842955349114176*^9, 
   3.842955352410673*^9}, {3.842965903750918*^9, 3.8429659307674704`*^9}, {
   3.8429674715058975`*^9, 3.8429674715916667`*^9}, 3.8429683448606544`*^9, 
   3.843012375014877*^9, 3.8430132360946603`*^9, 3.843014548711771*^9, {
   3.84303679316053*^9, 3.8430368204441023`*^9}, 3.8430372772194633`*^9, 
   3.84303914834064*^9, 3.843041855422675*^9, 3.8430425183085155`*^9, 
   3.8430441409883466`*^9, 3.8430458153123665`*^9, 3.843046434447945*^9, 
   3.8432706623841705`*^9, 3.8458140268217945`*^9, 3.8458142420373936`*^9, {
   3.845814453698887*^9, 3.845814454283103*^9}, 3.8458147898582354`*^9, 
   3.845814918747543*^9, 3.845952924411313*^9, 3.845963521992029*^9, 
   3.8459655352923117`*^9, 3.845976038814541*^9, 3.845994196093089*^9, {
   3.8460477500394373`*^9, 3.8460477510575123`*^9}, 3.8460520665603027`*^9, 
   3.8462449041652713`*^9, {3.8471795139218264`*^9, 3.8471795148409224`*^9}, 
   3.8473576654171953`*^9, 3.8473594101762486`*^9, {3.8473615178251505`*^9, 
   3.847361518712777*^9}, 3.852223868441091*^9, {3.8522241246689367`*^9, 
   3.852224127354022*^9}, 3.854283893172999*^9, 3.854283974123249*^9, {
   3.854284028747675*^9, 3.8542840361945086`*^9}, {3.8546066921224084`*^9, 
   3.8546067913507395`*^9}, 3.860576169449164*^9, 3.860576255705443*^9, 
   3.8605763894079404`*^9, {3.86057685706324*^9, 3.8605768843226213`*^9}, 
   3.8606702712773504`*^9, {3.86073503842074*^9, 3.860735065978959*^9}, 
   3.860920334990741*^9, 3.861468008499719*^9, {3.861549367591876*^9, 
   3.861549369023287*^9}, 3.8615494706474485`*^9, 3.861551661877142*^9, 
   3.8615517295575304`*^9, {3.8615519494698534`*^9, 3.86155195636662*^9}, 
   3.8616140465087533`*^9, 3.861616996296524*^9, 3.8616170617156515`*^9, 
   3.8616172704118323`*^9, 3.861650609512191*^9, 3.8616997318111105`*^9, 
   3.8616998512851644`*^9, 3.861699942200835*^9, 3.8617822044287*^9, 
   3.8617822627454386`*^9, {3.8617920886905766`*^9, 3.8617921010953455`*^9}, {
   3.8617989203499813`*^9, 3.861798928798402*^9}, {3.861799913340885*^9, 
   3.861799927804253*^9}, {3.861800345316432*^9, 3.8618003525178585`*^9}, {
   3.86181483099113*^9, 3.8618148443292217`*^9}, 3.8618688336974387`*^9, {
   3.862045267973294*^9, 3.8620452740683985`*^9}, 3.862478514969168*^9, 
   3.8625042707295294`*^9, 3.8625043084647055`*^9, {3.8626568001531677`*^9, 
   3.8626568092538567`*^9}, {3.8692176956431427`*^9, 3.8692177152949505`*^9}, 
   3.8692365233272886`*^9, 3.8692366194637704`*^9, {3.885294833725152*^9, 
   3.885294841320782*^9}, {3.8854052365747857`*^9, 3.8854052412599115`*^9}, {
   3.8854055922472963`*^9, 3.8854055938157024`*^9}, 3.8854079673340645`*^9, {
   3.8883961500345616`*^9, 3.8883962011787496`*^9}, {3.888396250859366*^9, 
   3.8883963143530865`*^9}, 3.888396982601926*^9, {3.8883970349050303`*^9, 
   3.8883970444570365`*^9}, 3.8883971606172276`*^9, {3.888397212240456*^9, 
   3.8883972183127766`*^9}, {3.8883972487367496`*^9, 
   3.8883972513682947`*^9}, {3.8883973366649513`*^9, 
   3.8883973372631006`*^9}, {3.8889140791658525`*^9, 
   3.8889140800045233`*^9}, {3.88892403175506*^9, 3.8889240614087667`*^9}, {
   3.8890246062319145`*^9, 3.889024620080434*^9}, 3.8898983423873997`*^9, 
   3.890209967495713*^9, {3.8902121628342886`*^9, 3.890212168297205*^9}, 
   3.890212277516303*^9, 3.8908333148567657`*^9, 3.8927990393754654`*^9, 
   3.892811183199755*^9, 3.8929093283190026`*^9, 3.892912004719715*^9, 
   3.8929128126642265`*^9, 3.893483408726311*^9, {3.893483851388729*^9, 
   3.893483892130946*^9}, 3.893595020789238*^9, 3.894132644798708*^9, 
   3.8941331271439743`*^9, 3.894618934796352*^9, 3.894621747010389*^9, 
   3.894699242941082*^9, 3.8947130527156296`*^9, 3.894713678325944*^9, 
   3.8947202441518464`*^9, {3.8963488777532024`*^9, 3.8963489077113276`*^9}, {
   3.8969467868259034`*^9, 3.8969468588509398`*^9}, {3.8982635394601865`*^9, 
   3.898263562949216*^9}, {3.898759769427726*^9, 3.8987598019567976`*^9}, 
   3.8987599933960953`*^9, 3.8987600433399396`*^9, 3.8987679377878556`*^9, 
   3.8987679682261624`*^9, {3.898823609208624*^9, 3.898823614940817*^9}, {
   3.899798135288001*^9, 3.899798141262788*^9}, 3.899798205324564*^9, 
   3.899798260718631*^9, 3.8998653379291897`*^9, 3.8998709288580785`*^9, 
   3.899871219183766*^9, {3.899908295322106*^9, 3.899908302384104*^9}, {
   3.8999098091507807`*^9, 3.8999098173315563`*^9}, 3.8999099102888536`*^9, {
   3.900049235941064*^9, 3.900049247275297*^9}, {3.9000531396172366`*^9, 
   3.9000531404869103`*^9}, 3.900053206135925*^9, {3.9000533014241056`*^9, 
   3.9000533036232243`*^9}, 3.9000538158076715`*^9, {3.9006757302883563`*^9, 
   3.900675752352729*^9}, {3.900675810730068*^9, 3.9006758388102922`*^9}, {
   3.900744201901579*^9, 3.9007442071667724`*^9}, 3.9007443366864543`*^9, 
   3.9007444663043346`*^9, 3.9007481036337943`*^9, {3.9007499325623226`*^9, 
   3.9007499329847755`*^9}, 3.9007505048422704`*^9, 3.900750821634945*^9, {
   3.900750929092899*^9, 3.9007509296992545`*^9}, 3.900752603234764*^9, 
   3.900752884993887*^9, 3.900758400011373*^9, {3.9007597728499203`*^9, 
   3.9007597750325212`*^9}, 3.9007603371861424`*^9, {3.900761616659289*^9, 
   3.9007616174039927`*^9}, {3.900762607528063*^9, 3.900762616811782*^9}, 
   3.900764139495187*^9, {3.9007643736861725`*^9, 3.900764390613057*^9}, {
   3.9009293353460636`*^9, 3.9009293353879995`*^9}, 3.901003457555546*^9, 
   3.901004328515649*^9, {3.90100454038593*^9, 3.9010045415784836`*^9}, {
   3.9010053825164733`*^9, 3.9010054002186365`*^9}, {3.901007361765042*^9, 
   3.901007362348482*^9}, 3.9010096542946253`*^9, 3.901014210139951*^9, {
   3.9010151977883415`*^9, 3.901015198763291*^9}, 3.9010159741095123`*^9, 
   3.9010167116786566`*^9, 3.901017424069476*^9, {3.9010342684377728`*^9, 
   3.901034269279627*^9}, 3.90105046456962*^9, 3.9011038167598157`*^9, {
   3.90110629678572*^9, 3.9011063050653276`*^9}, 3.9011077572753906`*^9, 
   3.9011084938204236`*^9, 3.9011091219313855`*^9, {3.901110810325277*^9, 
   3.9011108108517313`*^9}, 3.9011130624638166`*^9, 3.901176194085042*^9, {
   3.901177411857251*^9, 3.9011774122127504`*^9}, {3.901183577467103*^9, 
   3.901183578117106*^9}, 3.9011844896239977`*^9, {3.9011896951274295`*^9, 
   3.901189713021695*^9}, 3.901191819426858*^9, {3.9011928066007338`*^9, 
   3.901192806763069*^9}, {3.9011929300020885`*^9, 3.9011929321613026`*^9}, {
   3.9038519679505496`*^9, 3.9038519877611647`*^9}, 3.903869792991681*^9, 
   3.9038796361223636`*^9, {3.903882531259367*^9, 3.90388253405903*^9}, 
   3.9054246634798527`*^9, {3.9054442777415648`*^9, 3.905444287316186*^9}, {
   3.9054452500886927`*^9, 3.9054452566322465`*^9}, 3.9054498140913577`*^9, 
   3.9054504699692197`*^9, 3.905453125526921*^9, {3.9054541632552166`*^9, 
   3.9054541640786204`*^9}, 3.9054562166360607`*^9, {3.9122405359842844`*^9, 
   3.9122405460224133`*^9}, {3.9124478274929323`*^9, 3.912447832429183*^9}, 
   3.9126110351100693`*^9, {3.9152110415036297`*^9, 3.9152110541423683`*^9}, 
   3.9152110871219444`*^9, {3.915623191439227*^9, 3.915623203367864*^9}, {
   3.91564040047129*^9, 3.9156404269609203`*^9}, {3.9156990229590025`*^9, 
   3.9156990261536856`*^9}, {3.915739645379031*^9, 3.9157396458214436`*^9}, {
   3.9170033489206533`*^9, 3.9170033491812286`*^9}, {3.917003599793469*^9, 
   3.9170036116009316`*^9}, {3.9170036960707536`*^9, 
   3.9170037081253653`*^9}, {3.9170377419040213`*^9, 3.9170377570184894`*^9}, 
   3.917037814667392*^9, {3.917038893219248*^9, 3.917038927115818*^9}, {
   3.9170421084197254`*^9, 3.9170421420593457`*^9}, 3.9173459941949687`*^9, 
   3.917346163303742*^9, 3.917346211302823*^9, {3.9173501911028895`*^9, 
   3.917350214950756*^9}, {3.917351430391779*^9, 3.917351430493845*^9}, {
   3.917466986923622*^9, 3.9174670096496725`*^9}, {3.91746705084474*^9, 
   3.9174670546459875`*^9}, 3.9265203925954857`*^9, 3.926561268305479*^9, 
   3.926859533485247*^9, {3.9268597980407543`*^9, 3.926859799672038*^9}, {
   3.9269981155792274`*^9, 3.926998115659013*^9}, {3.9269986395082846`*^9, 
   3.926998640698818*^9}, {3.9270000961114035`*^9, 3.927000115859926*^9}, {
   3.9270001999130945`*^9, 3.9270002001553974`*^9}, {3.9272891958046045`*^9, 
   3.927289231008156*^9}, 3.927289279030757*^9, {3.927299855442247*^9, 
   3.9272998721604104`*^9}, {3.927299905282153*^9, 3.9272999787320395`*^9}, {
   3.927300152897812*^9, 3.9273001861613503`*^9}, {3.92730046571591*^9, 
   3.9273004676812954`*^9}, {3.9273005296323905`*^9, 3.927300564680994*^9}, {
   3.927300605496953*^9, 3.9273006093363633`*^9}, {3.9273010490330606`*^9, 
   3.9273010642760067`*^9}, {3.9273011449603815`*^9, 
   3.9273011652115655`*^9}, {3.927301220401112*^9, 3.9273012207653165`*^9}, {
   3.9273013240523753`*^9, 3.927301373051365*^9}, 3.9273014983511133`*^9, {
   3.927342044763954*^9, 3.927342075945857*^9}, {3.927377768821126*^9, 
   3.9273777799055786`*^9}, 3.927378190541397*^9, {3.9273782403719873`*^9, 
   3.927378245227166*^9}, {3.927383732218993*^9, 3.927383732617875*^9}, 
   3.9273867657482624`*^9, {3.9273868252274694`*^9, 3.927386926528813*^9}, {
   3.9273873049862957`*^9, 3.9273873540714116`*^9}, {3.927391251344535*^9, 
   3.9273912514156914`*^9}, 3.9274368921378107`*^9, {3.927450850815316*^9, 
   3.927450867198946*^9}, {3.92745147814145*^9, 3.9274514798217373`*^9}, {
   3.9274515394522734`*^9, 3.9274515780757914`*^9}, {3.9274764413064766`*^9, 
   3.92747648183615*^9}, 3.927515692545562*^9, 3.9275370430372086`*^9, {
   3.927544356757991*^9, 3.927544436081769*^9}, {3.927803661009346*^9, 
   3.9278036634639997`*^9}, {3.9278037981444306`*^9, 3.927803800088193*^9}, {
   3.9278039036653557`*^9, 3.927803956472925*^9}, 3.927809372243021*^9, 
   3.9278139914125805`*^9, 3.927815218304728*^9, {3.9286403978675847`*^9, 
   3.928640406383452*^9}, {3.9286404637847137`*^9, 3.928640464109007*^9}, {
   3.928640726567339*^9, 3.928640726616274*^9}, {3.9286407687660832`*^9, 
   3.9286407799715843`*^9}, {3.9286408279716434`*^9, 
   3.9286408412392597`*^9}, {3.938684164090485*^9, 3.9386841771242495`*^9}, {
   3.9386842969975457`*^9, 3.938684305315369*^9}, 3.9391936569829783`*^9, {
   3.9391944881020794`*^9, 3.9391944992762547`*^9}, 3.9392054220841336`*^9, 
   3.9392093193670425`*^9, {3.941721819474311*^9, 3.9417218770354757`*^9}, 
   3.941793927622773*^9, 3.9418625325371757`*^9, {3.9512911961786985`*^9, 
   3.9512912092777214`*^9}, {3.9512918326042976`*^9, 3.951291832690319*^9}, 
   3.951727157460037*^9, {3.951727218742643*^9, 3.9517272423752236`*^9}, {
   3.951737438606086*^9, 3.951737443571389*^9}, {3.9517374858281965`*^9, 
   3.951737504748358*^9}, {3.951794858636271*^9, 3.9517948773354144`*^9}, {
   3.951794986195737*^9, 3.9517949918362484`*^9}, {3.9518221879071364`*^9, 
   3.9518222005561604`*^9}, {3.9518222376390104`*^9, 3.951822242957823*^9}, {
   3.9520523087272477`*^9, 3.9520523257569413`*^9}, 3.9525728525540714`*^9, {
   3.9525729500489893`*^9, 3.9525729501837196`*^9}, {3.9525778664047213`*^9, 
   3.9525778745490217`*^9}, {3.9525786899221363`*^9, 3.9525786914836206`*^9}, 
   3.9525787651851997`*^9, {3.9525788061010475`*^9, 3.952578810115765*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"5d27874b-1d64-47be-80b3-3921d9f48e56"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"images", "=", 
      RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"fileFolder", "<>", "$PathnameSeparator", "<>", "#"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", "files"}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"#", "@", 
     RowBox[{"First", "@", "images"}]}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"ImageDimensions", ",", "ImageType"}], "}"}]}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.82237034851377*^9, 3.822370354429882*^9}, 
   3.822370406705285*^9, {3.8223707318084*^9, 3.8223707386015005`*^9}, {
   3.8223708729527082`*^9, 3.822370904441451*^9}, {3.8459085060339146`*^9, 
   3.8459085143374596`*^9}, 3.8609203411662297`*^9, {3.88537816042834*^9, 
   3.8853782515299673`*^9}, {3.889024629776803*^9, 3.8890246300244803`*^9}, {
   3.889898347437231*^9, 3.889898347625966*^9}, {3.8900450734216557`*^9, 
   3.890045084298572*^9}, {3.8932634378919077`*^9, 3.893263488648225*^9}, {
   3.900053142335965*^9, 3.900053143551714*^9}, {3.9010054163155746`*^9, 
   3.9010054189146814`*^9}, {3.901006583204323*^9, 3.901006583482811*^9}, {
   3.901006820803749*^9, 3.9010068212039385`*^9}, {3.9010096915209374`*^9, 
   3.9010096918004875`*^9}, 3.9010340839021416`*^9, {3.9010946655656166`*^9, 
   3.9010946661347466`*^9}, {3.9272998463939257`*^9, 
   3.9272998483307123`*^9}, {3.951727246351604*^9, 3.951727247678995*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"58d0290c-3868-4660-a823-1a43ede7fa0e"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"images", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "images"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9517276177924037`*^9, 3.9517276275277233`*^9}, 
   3.951737875365283*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"6efd5adc-cdfe-4a2a-820b-d6417445bf63"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function Definitions (RUN)", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 3.8468307830344753`*^9}, {3.952578020402116*^9, 
  3.952578023505325*^9}},ExpressionUUID->"052c7a4d-1f88-45d3-b591-\
7e016adebad1"],

Cell[CellGroupData[{

Cell["Image Filtering & Manipulation", "Subsection",
 CellChangeTimes->{{3.8381889592254605`*^9, 3.8381889906103125`*^9}},
 FontSize->24,ExpressionUUID->"bdfa3a54-80d1-425a-b669-e0bc8e973848"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meanCorrection", "[", 
   RowBox[{"image_", ",", "meanImage_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"image", "-", "meanImage"}], "//", 
   "ImageAdjust"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meanFlattening", "[", 
    RowBox[{"image_", ",", "meanImage_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"image", "/", "meanImage"}], "//", "ImageAdjust"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"applySCTMM", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"#", "-", 
         RowBox[{"ColorNegate", "@", 
          RowBox[{"ColorToneMapping", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", "luminanceCompression", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Luminance\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}]}]}], "]"}]}], "&"}], "@", 
    "image"}]}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"preprocessImage", "[", "image_", "]"}], ":=", 
   RowBox[{"BrightnessEqualize", "@", 
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"ColorToneMapping", "@", 
      RowBox[{"ImageAdjust", "@", "image"}]}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"getFilteredImage", "[", "image_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"useMaxFilter", "\[Equal]", "1"}], ",", 
                RowBox[{"MaxFilter", "[", 
                 RowBox[{"#", ",", "maxFilterScale"}], "]"}], ",", "#"}], 
               "\[IndentingNewLine]", "]"}], "&"}], "@", 
             RowBox[{"Nest", "[", 
              RowBox[{"applySCTMM", ",", "#", ",", "SCTMMiterations"}], 
              "]"}]}], "&"}], "@", 
           RowBox[{"TotalVariationFilter", "[", 
            RowBox[{"#", ",", "totalVariationRegularization", ",", 
             RowBox[{"Method", "\[Rule]", "\"\<Poisson\>\""}]}], "]"}]}], 
          "&"}], "@", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"usePreprocessing", "\[Equal]", "1"}], ",", 
           RowBox[{"preprocessImage", "@", "#"}], ",", "#"}], 
          "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
       RowBox[{"preprocessImage", "@", "image"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"getBacteriaMask", "[", "image_", "]"}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"DeleteSmallComponents", "[", 
        RowBox[{"#", ",", "sizeThreshold"}], "]"}], "&"}], "@", 
      RowBox[{"DeleteBorderComponents", "@", 
       RowBox[{"Binarize", "@", "image"}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFilteredImage", "[", 
    RowBox[{"image_", ",", "parameterSet_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputParameters", "=", "parameterSet"}], ",", 
       RowBox[{"inputImage", "=", "image"}], ",", "\[IndentingNewLine]", 
       "useMaxFilter", ",", "maxFilterScale", ",", "SCTMMiterations", ",", 
       "totalVariationRegularization", ",", "usePreprocessing", ",", 
       "luminanceCompression"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "usePreprocessing", ",", "totalVariationRegularization", ",", 
         "luminanceCompression", ",", "SCTMMiterations", ",", "useMaxFilter", 
         ",", "maxFilterScale"}], "}"}], "=", 
       RowBox[{"inputParameters", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "6"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"useMaxFilter", "\[Equal]", "1"}], ",", 
                RowBox[{"MaxFilter", "[", 
                 RowBox[{"#", ",", "maxFilterScale"}], "]"}], ",", "#"}], 
               "\[IndentingNewLine]", "]"}], "&"}], "@", 
             RowBox[{"Nest", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"ImageAdjust", "@", 
                 RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
                  RowBox[{"#", ",", 
                   RowBox[{"#", "-", 
                    RowBox[{"ColorNegate", "@", 
                    RowBox[{"ColorToneMapping", "[", "\[IndentingNewLine]", 
                    RowBox[{"#", ",", "luminanceCompression", ",", 
                    RowBox[{"Method", "\[Rule]", "\"\<Luminance\>\""}]}], 
                    "\[IndentingNewLine]", "]"}]}]}]}], "]"}]}], "&"}], ",", 
               "#", ",", "SCTMMiterations"}], "]"}]}], "&"}], "@", 
           RowBox[{"TotalVariationFilter", "[", 
            RowBox[{"#", ",", "totalVariationRegularization", ",", 
             RowBox[{"Method", "\[Rule]", "\"\<Poisson\>\""}]}], "]"}]}], 
          "&"}], "@", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"usePreprocessing", "\[Equal]", "1"}], ",", 
           RowBox[{"preprocessImage", "@", "#"}], ",", "#"}], 
          "\[IndentingNewLine]", "]"}]}], "&"}], "@", "inputImage"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSegmentedImage", "[", 
    RowBox[{"image_", ",", "parameterSet_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputParameters", "=", "parameterSet"}], ",", 
       RowBox[{"inputImage", "=", "image"}], ",", "\[IndentingNewLine]", 
       "sizeThresholdMin", ",", "sizeThresholdMax"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sizeThresholdMin", ",", "sizeThresholdMax"}], "}"}], "=", 
       RowBox[{"inputParameters", "[", 
        RowBox[{"[", 
         RowBox[{"7", ";;", "8"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"SelectComponents", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
             "sizeThresholdMin", "<", "#FilledCount", "<", 
              "sizeThresholdMax"}], "&"}]}], "]"}], "&"}], "@", 
         RowBox[{"FillingTransform", "@", 
          RowBox[{"DeleteBorderComponents", "@", 
           RowBox[{"Binarize", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Method", "\[Rule]", "segmentationMethod"}]}], 
            "]"}]}]}]}], "&"}], "@", "image"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getLuminanceFilteredSegments", "[", 
    RowBox[{
    "mask_", ",", "filteredImage_", ",", "intensityReference_", ",", 
     "threshold_", ",", "switch_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputMask", "=", "mask"}], ",", 
       RowBox[{"luminanceMap", "=", "filteredImage"}], ",", 
       RowBox[{"enableLFPE", "=", "switch"}], ",", "\[IndentingNewLine]", 
       RowBox[{"useMeanReference", "=", "intensityReference"}], ",", 
       RowBox[{"intensityThreshold", "=", "threshold"}], ",", 
       "\[IndentingNewLine]", "segmentLuminanceMask", ",", "segmentIntensity",
        ",", "segmentMasks", ",", "blackWindow", ",", "falsePositiveIDs"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"enableLFPE", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"segmentLuminanceMask", "=", 
         RowBox[{"ImageMultiply", "[", 
          RowBox[{"inputMask", ",", "luminanceMap"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"segmentIntensity", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Times", "@@", "#"}], "&"}], "/@", 
            RowBox[{"Last", "/@", 
             RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<MeanIntensity\>\"", ",", "\"\<MaxIntensity\>\""}], 
                "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "&"}], "@", 
          "segmentLuminanceMask"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"falsePositiveIDs", "=", 
         RowBox[{"Position", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", ">", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"useMeanReference", "\[Equal]", "1"}], ",", 
                 RowBox[{"Mean", "@", "segmentIntensity"}], ",", "1"}], "]"}],
                "*", "intensityThreshold"}]}], "&"}], "/@", 
            "segmentIntensity"}], ",", "\[IndentingNewLine]", "False"}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"segmentMasks", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}], "&"}], "@", 
          "inputMask"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"blackWindow", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Binarize", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", "inputMask"}]}], ";", 
        "\n", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"Head", "@", "#"}]}], "==", "\"\<SparseArray\>\""}], 
            ",", 
            RowBox[{"Image", "@", "#"}], ",", "blackWindow"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "@", 
         RowBox[{"Total", "[", "\[IndentingNewLine]", 
          RowBox[{"Last", "/@", 
           RowBox[{"Delete", "[", 
            RowBox[{"segmentMasks", ",", "falsePositiveIDs"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "inputMask"}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"findEligibleSegments", "[", 
    RowBox[{"mask_", ",", "criticalFactor_"}], "]"}], ":=", 
   RowBox[{"Last", "/@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ComponentMeasurements", "[", 
       RowBox[{"mask", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Centroid\>\"", ",", "\"\<EquivalentDiskRadius\>\""}], 
         "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#ConvexArea", "/", "#Count"}], ")"}], "^", 
             "powerConvexRatio"}], "*", 
            RowBox[{
             RowBox[{"#ConvexArea", "^", "powerHullSize"}], 
             "\[IndentingNewLine]", "/", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "#Elongation"}], ")"}], "^", 
              "powerAspectRatio"}]}]}], "<", "criticalFactor"}], "&&", 
          "\[IndentingNewLine]", 
          RowBox[{
          "artifactSizeThresholdUpper", ">", "#FilledCount", ">", 
           "artifactSizeThresholdLower"}]}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"CornerNeighbors", "\[Rule]", "False"}]}], "]"}], "/.", 
      RowBox[{"Rule", "\[Rule]", "List"}]}], "\[IndentingNewLine]", ")"}]}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotateImage", "[", "image_", "]"}], ":=", 
   RowBox[{"ImageRotate", "[", 
    RowBox[{"image", ",", 
     RowBox[{"rotationSwitch", "*", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inpaintImageArtifacts", "[", 
    RowBox[{"image_", ",", "artifactMask_"}], "]"}], ":=", 
   RowBox[{"Inpaint", "[", "\[IndentingNewLine]", 
    RowBox[{"image", ",", "artifactMask", ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<TextureSynthesis\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<MaxSamples\>\"", "\[Rule]", "inpaintMaxSamples"}], ",", 
        RowBox[{"\"\<NeighborCount\>\"", "\[Rule]", "inpaintSampleRange"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getRealMask", "[", 
    RowBox[{
    "rawMasks_", ",", "selectedTrack_", ",", "timeStamp_", ",", 
     "erosionScale_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"time", "=", "timeStamp"}], ",", 
       RowBox[{"masks", "=", "rawMasks"}], ",", "testCentroids", ",", 
       "testMasks"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"testCentroids", ",", "testMasks"}], "}"}], "=", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ImageAdd", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Erosion", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"DiskMatrix", "@", "erosionScale"}]}], "]"}], "&"}], 
              "/@", 
              RowBox[{"rawMasks", "[", 
               RowBox[{"[", "timeStamp", "]"}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Centroid\>\"", ",", "\"\<Mask\>\""}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "//", "Transpose"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Image", "@", 
           RowBox[{"First", "@", 
            RowBox[{"testMasks", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}]}], "&"}], "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Position", "[", 
           RowBox[{"testCentroids", ",", "#"}], "]"}]}]}], "&"}], "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Nearest", "[", 
         RowBox[{"testCentroids", ",", 
          RowBox[{"selectedTrack", "[", 
           RowBox[{"[", "timeStamp", "]"}], "]"}], ",", "1"}], "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getImageMSE", "[", 
   RowBox[{"image1_", ",", "image2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Total", "@", 
      RowBox[{"ImageDifference", "[", 
       RowBox[{"image1", ",", "image2"}], "]"}]}], ")"}], "^", "2"}], "/", 
   "croppedImagePixelCount"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8381890059119296`*^9, {3.8381893677521863`*^9, 3.8381893696496534`*^9}, {
   3.838189457199703*^9, 3.838189457584342*^9}, {3.8382126360472965`*^9, 
   3.8382126363285446`*^9}, {3.8382149489599414`*^9, 
   3.8382149492401924`*^9}, {3.838293176831523*^9, 3.8382931784701414`*^9}, {
   3.8391485552078114`*^9, 3.839148556895608*^9}, 3.839148672008988*^9, {
   3.839149255616995*^9, 3.839149259809787*^9}, {3.842955724667177*^9, 
   3.8429558004029775`*^9}, {3.842955841163106*^9, 3.8429558419005594`*^9}, 
   3.84295587762633*^9, {3.843304653089132*^9, 3.8433046561598926`*^9}, {
   3.8433048180942583`*^9, 3.8433048242616744`*^9}, {3.8433055032045217`*^9, 
   3.8433055042237835`*^9}, {3.8434800790645485`*^9, 
   3.8434800798615627`*^9}, {3.8434808011695547`*^9, 3.843480801723075*^9}, {
   3.8458162682218466`*^9, 3.8458162686108065`*^9}, {3.8466704748407636`*^9, 
   3.846670475504183*^9}, {3.8467523367189393`*^9, 3.8467523374546785`*^9}, {
   3.846752387230635*^9, 3.8467523881428027`*^9}, {3.846769318722342*^9, 
   3.8467693208825655`*^9}, {3.8467694299469147`*^9, 3.846769431114791*^9}, {
   3.846829503023484*^9, 3.8468295219189806`*^9}, {3.846829714132536*^9, 
   3.8468297147769403`*^9}, 3.846829770476872*^9, {3.8468367343621416`*^9, 
   3.846836740433859*^9}, {3.8468368184982905`*^9, 3.846836818986068*^9}, {
   3.8468376554587145`*^9, 3.846837660004117*^9}, {3.8468382162411404`*^9, 
   3.8468382198736067`*^9}, {3.8468382731475267`*^9, 
   3.8468383406590633`*^9}, {3.846838396428229*^9, 3.8468384008191967`*^9}, {
   3.8468472200165663`*^9, 3.846847221363595*^9}, {3.8468478649999065`*^9, 
   3.8468478670945644`*^9}, {3.8468491478061705`*^9, 
   3.8468491502317123`*^9}, {3.846849808653754*^9, 3.846849809929842*^9}, {
   3.8468499445745735`*^9, 3.84684994788789*^9}, {3.847444433002282*^9, 
   3.8474444341113186`*^9}, {3.8479565550591283`*^9, 3.8479565561243076`*^9}, 
   3.8479584002362967`*^9, 3.847958889635376*^9, 3.8479589355907516`*^9, 
   3.8479593282027287`*^9, 3.847961680799029*^9, {3.8480390910382395`*^9, 
   3.848039092217394*^9}, {3.8480394826619787`*^9, 3.8480394834092846`*^9}, {
   3.848040227238947*^9, 3.848040233605711*^9}, {3.8480432756919456`*^9, 
   3.8480432763426332`*^9}, {3.8480433387886744`*^9, 
   3.8480433395105877`*^9}, {3.854635135575929*^9, 3.854635143063056*^9}, {
   3.8546353048539505`*^9, 3.854635310385127*^9}, {3.8546361587395926`*^9, 
   3.8546361589820004`*^9}, {3.854723029087531*^9, 3.8547230380861025`*^9}, {
   3.8547230952710233`*^9, 3.8547230963273664`*^9}, {3.854811196436452*^9, 
   3.854811215124194*^9}, {3.8548228668299527`*^9, 3.854822867515088*^9}, 
   3.854823793720137*^9, 3.8606963696633587`*^9, {3.8615985970465927`*^9, 
   3.861598599006845*^9}, {3.861600132373684*^9, 3.8616001370973067`*^9}, {
   3.861724596314806*^9, 3.861724601881921*^9}, 3.8617762678673763`*^9, {
   3.8617791439652243`*^9, 3.8617791454780593`*^9}, 3.86178725989005*^9, 
   3.8617915019514894`*^9, {3.861791540787301*^9, 3.8617915553660483`*^9}, {
   3.8618777597683935`*^9, 3.8618778246299534`*^9}, 3.8623832640750103`*^9, {
   3.8852949994424696`*^9, 3.885295027958845*^9}, {3.8852950768516197`*^9, 
   3.885295099481221*^9}, {3.885295147676483*^9, 3.8852951600188026`*^9}, {
   3.8853805948029346`*^9, 3.885380595700157*^9}, {3.885402555673275*^9, 
   3.885402556708188*^9}, {3.888485789546218*^9, 3.8884857942821302`*^9}, {
   3.8884941328875313`*^9, 3.888494136251226*^9}, {3.8889240760145288`*^9, 
   3.888924084593076*^9}, {3.889011302374075*^9, 3.889011325056558*^9}, 
   3.8890114191910796`*^9, {3.889015894015092*^9, 3.8890159001264696`*^9}, 
   3.8890343698106813`*^9, {3.8890435816504974`*^9, 3.8890435818337193`*^9}, {
   3.889114993091215*^9, 3.8891149941964664`*^9}, {3.889115539161128*^9, 
   3.8891155456820893`*^9}, {3.8893007430483522`*^9, 
   3.8893007551364975`*^9}, {3.889300949062793*^9, 3.8893009627558208`*^9}, {
   3.8896388605138426`*^9, 3.8896388623851347`*^9}, {3.889640329470795*^9, 
   3.889640330376751*^9}, 3.889898362002493*^9, {3.890076882746663*^9, 
   3.8900768832226734`*^9}, {3.890305002612569*^9, 3.8903050182372637`*^9}, {
   3.890388575510442*^9, 3.8903885769517455`*^9}, {3.89055306998922*^9, 
   3.8905530708704767`*^9}, {3.89343961069697*^9, 3.8934396113944054`*^9}, {
   3.894826302411278*^9, 3.89482633220352*^9}, {3.8994934047714405`*^9, 
   3.8994934055482483`*^9}, {3.899493551020452*^9, 3.899493577373485*^9}, {
   3.899494277276867*^9, 3.8994942795891523`*^9}, {3.899494721026575*^9, 
   3.899494721662327*^9}, {3.899494817258607*^9, 3.8994948180623817`*^9}, {
   3.8995653445448956`*^9, 3.8995653464184475`*^9}, {3.8997105546800747`*^9, 
   3.89971055735201*^9}, {3.8998888772412424`*^9, 3.899888892348868*^9}, {
   3.8998950925510635`*^9, 3.899895095169362*^9}, {3.8999019779141912`*^9, 
   3.8999019786777306`*^9}, {3.899916922182691*^9, 3.8999169839086695`*^9}, {
   3.900052481682793*^9, 3.900052484112295*^9}, 3.900052560289222*^9, {
   3.900675917768762*^9, 3.9006759191690187`*^9}, {3.9007442526771407`*^9, 
   3.9007442601730185`*^9}, {3.900744668620677*^9, 3.9007446729415245`*^9}, {
   3.9007481113846145`*^9, 3.9007481140964503`*^9}, 3.900748941468376*^9, 
   3.9007528081692057`*^9, {3.900754233919571*^9, 3.9007542537486787`*^9}, {
   3.900755148549943*^9, 3.9007551507430634`*^9}, {3.9009402615263267`*^9, 
   3.900940303266346*^9}, 3.901013640717493*^9, 3.912532519372884*^9, 
   3.9125402715177927`*^9, {3.912580589891453*^9, 3.912580592355879*^9}, {
   3.912599475505932*^9, 3.912599492579936*^9}, {3.9126105164100676`*^9, 
   3.912610519633495*^9}, {3.9126775848446016`*^9, 3.9126775883544235`*^9}, 
   3.9126776816418524`*^9, {3.912684809112733*^9, 3.912684810828215*^9}, {
   3.915647086463933*^9, 3.9156470913192625`*^9}, {3.915648158128909*^9, 
   3.9156481592200365`*^9}, 3.9157350805076056`*^9, {3.9157351211574717`*^9, 
   3.915735131108135*^9}, {3.939192378483693*^9, 3.9391924024765673`*^9}, {
   3.9418628761485524`*^9, 3.9418628774072685`*^9}, {3.951731252751501*^9, 
   3.9517312741415095`*^9}},
 CellLabel->
  "In[355]:=",ExpressionUUID->"aaea907b-880f-43bf-ad0b-57bee5ae6643"]
}, Closed]],

Cell[CellGroupData[{

Cell["Data Processing ", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.821639993205228*^9}, {3.8381869586707425`*^9, 
   3.8381869649591913`*^9}, 3.838187468055561*^9, 3.8381890306710825`*^9, 
   3.8382140851103477`*^9},
 FontSize->24,ExpressionUUID->"8a3824ca-f692-4518-8496-1471ab3e1e6e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getNearestNeighborTracks", "[", 
    RowBox[{"list_", ",", "threshold_"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"index", ",", "next"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"index", "=", 
       RowBox[{"Range", "@", 
        RowBox[{"Length", "@", 
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"next", "=", 
       RowBox[{
        RowBox[{"Length", "@", "index"}], "+", "1"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Reap", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Sow", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2", ",", 
                    RowBox[{"First", "@", "#2"}]}], "]"}], "]"}]}], "}"}], 
               ",", "#"}], "]"}], "&"}], ",", "index"}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "=", 
              RowBox[{"newIndex", "@", 
               RowBox[{"Nearest", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Index\>\"", ",", "\"\<Distance\>\""}], 
                   "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "threshold"}], "}"}]}], 
                "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Sow", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"First", "@", "#2"}]}], "]"}], "]"}]}], "}"}], 
                  ",", "#"}], "]"}], "&"}], ",", "n"}], "\[IndentingNewLine]",
               "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "@", "list"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "_", ",", 
         RowBox[{"#2", "&"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "]"}], "//", "Last"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"toIndex", "[", 
   RowBox[{"{", "}"}], "]"}], ":=", 
  RowBox[{"next", "++"}]}], "\n", 
 RowBox[{
  RowBox[{"toIndex", "[", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"a_Integer", ",", "_"}], "}"}], "}"}], "]"}], ":=", 
  RowBox[{"toIndex", "@", "a"}]}], "\n", 
 RowBox[{
  RowBox[{"toIndex", "[", "a_Integer", "]"}], ":=", 
  RowBox[{"index", "[", 
   RowBox[{"[", "a", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"newIndex", "[", "list_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"old", "=", 
       RowBox[{"toIndex", "/@", "list"}]}], "}"}], ",", 
     RowBox[{"index", "=", "old"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"resolveDetectionOverlaps", "[", 
    RowBox[{"inputCentroids_", ",", "distanceThreshold_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"minimumDistance", "=", "distanceThreshold"}], ",", 
       RowBox[{"centroids", "=", "inputCentroids"}], ",", 
       "\[IndentingNewLine]", "distanceMatrix", ",", "criticalProximityMap", 
       ",", "overlappingPairs", ",", "overlappingGroups", ",", 
       "\[IndentingNewLine]", "getOverlappingGroups", ",", "resolvedOverlaps",
        ",", "redundantCentroids"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distanceMatrix", "=", 
       RowBox[{"DistanceMatrix", "[", "\[IndentingNewLine]", 
        RowBox[{"centroids", ",", 
         RowBox[{"DistanceFunction", "\[Rule]", "EuclideanDistance"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"criticalProximityMap", "=", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "<", "minimumDistance"}], "&"}], ",", "distanceMatrix",
          ",", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\n",
       "\[IndentingNewLine]", 
      RowBox[{"overlappingPairs", "=", 
       RowBox[{
        RowBox[{"Sort", "/@", 
         RowBox[{"Last", "@", 
          RowBox[{"GatherBy", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"criticalProximityMap", ",", "True"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"Union", "[", "#", "]"}]}], "&"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "//", "DeleteDuplicates"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"overlappingGroups", "=", 
       RowBox[{
        RowBox[{"Sort", "/@", 
         RowBox[{"Union", "/@", 
          RowBox[{"Flatten", "/@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "k"}], "]"}]}], "&"}], "]"}], "[", 
              "overlappingPairs", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"DeleteDuplicates", "@", 
                RowBox[{"Flatten", "@", "overlappingPairs"}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}]}], "//", "DeleteDuplicates"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"getOverlappingGroups", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"centroids", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        "overlappingGroups"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"resolvedOverlaps", "=", 
       RowBox[{"Mean", "/@", "getOverlappingGroups"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"redundantCentroids", "=", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"getOverlappingGroups", ",", "1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"resolvedCentroids", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{"resolvedOverlaps", ",", 
         RowBox[{"Complement", "[", 
          RowBox[{"centroids", ",", "redundantCentroids"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\n", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getResolvedParticles", "[", 
    RowBox[{"centroids_", ",", "minimumDistance_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"unresolvedCentroids", "=", "centroids"}], ",", 
       RowBox[{"distanceThreshold", "=", "minimumDistance"}], ",", 
       "\[IndentingNewLine]", "k", ",", "inputCentroids", ",", 
       "monitorCounter", ",", "outputCentroids"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"outputCentroids", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"For", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"k", "=", "1"}], ",", 
               RowBox[{"k", "\[LessEqual]", 
                RowBox[{"Length", "@", "unresolvedCentroids"}]}], ",", 
               RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
                RowBox[{"inputCentroids", "=", 
                 RowBox[{"unresolvedCentroids", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"inputCentroids", "\[Equal]", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{"Sow", "@", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"resolveDetectionOverlaps", "[", 
                    RowBox[{"inputCentroids", ",", "distanceThreshold"}], 
                    "]"}], ";", "\n", "     ", 
                   RowBox[{"While", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "inputCentroids", "\[NotEqual]", "resolvedCentroids"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"inputCentroids", "=", "resolvedCentroids"}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"resolveDetectionOverlaps", "[", 
                    RowBox[{"inputCentroids", ",", "distanceThreshold"}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Sow", "@", "resolvedCentroids"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
              "]"}], "//", "Reap"}], "//", "Last"}], "//", "First"}]}], ";"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"progress", "[", 
         RowBox[{"monitorCounter", ",", 
          RowBox[{"Length", "@", "unresolvedCentroids"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "outputCentroids"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"runTrackRefinement", "[", 
    RowBox[{"swarmTracks_", ",", "parameterSet_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inputTracks", "=", "swarmTracks"}], ",", 
        RowBox[{"refinementParameters", "=", "parameterSet"}], ",", 
        "\[IndentingNewLine]", "swarmTracksImproved", ",", "runID"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"swarmTracksImproved", "=", "inputTracks"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"runID", "=", "1"}], ",", 
         RowBox[{"runID", "\[LessEqual]", 
          RowBox[{"Length", "@", "refinementParameters"}]}], ",", 
         RowBox[{"runID", "++"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "swarmTracksImproved"}], "//", "Sow"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<Iteration \>\"", "<>", 
              RowBox[{"ToString", "@", "runID"}]}], "//", "Print"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "\"\<{\!\(\*SubscriptBox[\(\[Delta]t\), \
\(min\)]\),\!\(\*SubscriptBox[\(\[Delta]t\), \(max\)]\),\!\(\*SubscriptBox[\(\
\[Delta]r\), \(max\)]\)} = \>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"refinementParameters", "[", 
                RowBox[{"[", "runID", "]"}], "]"}]}]}], "//", "Print"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
            "\"\<======================================\>\"", "//", 
             "PrintTemporary"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"swarmTracksImproved", "=", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"runID", ">", "singletRemovalThreshold"}], ",", 
                   RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "]"}], 
                   ",", "#"}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
                RowBox[{"getRefinedTracks", "[", 
                 RowBox[{
                 "swarmTracksImproved", ",", "#1", ",", "#2", ",", "#3"}], 
                 "]"}]}], "&"}], "@@", 
              RowBox[{"refinementParameters", "[", 
               RowBox[{"[", "runID", "]"}], "]"}]}]}], ";"}], "//", 
           "AbsoluteTiming"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Length", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "@", "#"}], ">", "10"}], "&"}]}], "]"}], 
               "&"}], "@", "swarmTracksImproved"}], ")"}]}], "//", 
           "PrintTemporary"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
          "\"\<======================================\>\"", "//", "Print"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Last", "@", 
            RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "#"}], ">", "10"}], "&"}]}], "]"}], 
             "&"}], "@", "swarmTracksImproved"}], ")"}]}], "//", 
         "ListLinePlot"}], "//", "Print"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "swarmTracksImproved"}]}], 
     "\[IndentingNewLine]", "]"}], "//", "Reap"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getRefinedTracks", "[", 
    RowBox[{
    "nearestNeighborTracks_", ",", "deltaTimeFloor_", ",", 
     "deltaTimeThreshold_", ",", "deltaLocationThreshold_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputTracks", "=", "nearestNeighborTracks"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaMinimum", "=", "deltaTimeFloor"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaMaximum", "=", "deltaTimeThreshold"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaLocationMaximum", "=", "deltaLocationThreshold"}], ",", 
       "\[IndentingNewLine]", "swarmTrackStartpoints", ",", 
       "swarmTrackEndpoints", ",", "swarmTrackStartEndIDs", ",", 
       "\[IndentingNewLine]", "swarmTrackStartEndCombos", ",", 
       "swarmTrackStartEndDistances", ",", "nearbyEndpoints", ",", 
       "nearbyTrackIDs", ",", "newTracks", ",", "redundantTrackIDs", ",", 
       "outputTracks", ",", "monitorCounter"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Initial tracks: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "inputTracks"}]}]}], "//", "Print"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"swarmTrackStartpoints", ",", "swarmTrackEndpoints"}], "}"}], 
       "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], "/@", "inputTracks"}],
         "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"swarmTrackStartEndIDs", "=", 
       RowBox[{
        RowBox[{"ConstantArray", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", "inputTracks"}]}], ",", "2"}], 
         "\[IndentingNewLine]", "]"}], "//", "Tuples"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"swarmTrackStartEndCombos", "=", 
       RowBox[{"Tuples", "@", 
        RowBox[{"{", 
         RowBox[{"swarmTrackEndpoints", ",", "swarmTrackStartpoints"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<All start-/endpoint pairs: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "swarmTrackStartEndCombos"}]}]}], "//", 
       "PrintTemporary"}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"swarmTrackStartEndDistances", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"monitorCounter", "++"}], ";", 
              RowBox[{
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Abs", "@", "#1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}], "/@", "#2"}], "//", 
                    "Total"}], "//", "Sqrt"}]}], "\[IndentingNewLine]", "}"}],
                 "&"}], "@@", 
               RowBox[{"Subtract", "@@", "#"}]}]}], "\[IndentingNewLine]", 
             ")"}], "&"}], "/@", "swarmTrackStartEndCombos"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"progress", "[", 
         RowBox[{"monitorCounter", ",", 
          RowBox[{"Length", "@", "swarmTrackStartEndCombos"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"nearbyEndpoints", "=", 
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{"swarmTrackStartEndDistances", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"deltaMinimum", "<", 
            RowBox[{"First", "@", "#"}], "<", "deltaMaximum"}], "&&", 
           RowBox[{
            RowBox[{"Last", "@", "#"}], "<", "deltaLocationMaximum"}]}], 
          "&"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Eligible start-/endpoint pairs: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "nearbyEndpoints"}]}]}], "//", 
       "PrintTemporary"}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"nearbyTrackIDs", "=", 
       RowBox[{"getConnectedTracksIDs", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "nearbyEndpoints", ",", "swarmTrackStartEndDistances", ",", 
          "swarmTrackStartEndIDs"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"newTracks", "=", 
       RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"SortBy", "[", 
                RowBox[{"#", ",", "First"}], "]"}], "&"}], "@", 
              RowBox[{"Catenate", "@", 
               RowBox[{"inputTracks", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}]}], "&"}], "@", "#"}], "&"}], 
          "/@", "nearbyTrackIDs"}], ",", "\[IndentingNewLine]", "Length"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"redundantTrackIDs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", "#", "}"}], "&"}], "/@", 
         RowBox[{"Sort", "@", 
          RowBox[{"Flatten", "@", "nearbyTrackIDs"}]}]}], "//", 
        "DeleteDuplicates"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"outputTracks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ReverseSortBy", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"Length", "@", "#"}], "&"}]}], "]"}], "&"}], "@", 
        RowBox[{"Catenate", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{"inputTracks", ",", "redundantTrackIDs"}], "]"}], ",", 
           "newTracks"}], "}"}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Finalized tracks: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "outputTracks"}]}]}], "//", "Print"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "outputTracks"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getConnectedTracksIDs", "[", 
    RowBox[{
    "trackEndpoints_", ",", "trackEndpointDistances_", ",", 
     "trackEndpointIDs_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"endpoints", "=", "trackEndpoints"}], ",", 
       RowBox[{"distances", "=", "trackEndpointDistances"}], ",", 
       RowBox[{"endIDs", "=", "trackEndpointIDs"}], ",", 
       "\[IndentingNewLine]", "trackMatchesInitial", ",", "deltaLength", ",", 
       "checkLength", ",", "extraConnections", ",", "checkID", ",", 
       "trackOverlapIDs", ",", "trackMatchesFinal"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trackMatchesInitial", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"endIDs", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"distances", ",", "#"}], "]"}], "&"}], "/@", 
              "endpoints"}], "\[IndentingNewLine]", "]"}]}], ")"}]}], "//", 
         "DeleteDuplicates"}], "//", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "@", "#"}], "\[NotEqual]", 
             RowBox[{"Last", "@", "#"}]}], "&"}]}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Initially matched track pairs: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "trackMatchesInitial"}]}]}], "//", 
       "PrintTemporary"}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"deltaLength", "=", "1"}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deltaLength", ">", "0"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"checkLength", "=", 
          RowBox[{"Length", "@", "trackMatchesInitial"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"extraConnections", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"For", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"checkID", "=", "1"}], ",", 
               RowBox[{"checkID", "\[LessEqual]", 
                RowBox[{"Length", "@", "trackMatchesInitial"}]}], ",", 
               RowBox[{"checkID", "++"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"trackOverlapIDs", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"#", ",", "checkID"}], "]"}], "&"}], "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"getTrackOverlapIDs", "[", 
                    RowBox[{"trackMatchesInitial", ",", "#"}], "]"}]}]}], 
                   "&"}], "/@", 
                  RowBox[{"trackMatchesInitial", "[", 
                   RowBox[{"[", "checkID", "]"}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", "\n", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"trackMatchesInitial", "[", 
                    RowBox[{"[", "checkID", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"trackMatchesInitial", "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "@", "trackOverlapIDs"}], "]"}], 
                    "]"}]}], "\[IndentingNewLine]", "}"}], "//", "Flatten"}], 
                   "//", "DeleteDuplicates"}], "//", "Sort"}], "//", "Sow"}], 
                ";", "\[IndentingNewLine]", "\n", 
                RowBox[{"trackMatchesInitial", "=", 
                 RowBox[{"Delete", "[", 
                  RowBox[{"trackMatchesInitial", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", "#", "}"}], "&"}], "/@", 
                    RowBox[{"Flatten", "@", "trackOverlapIDs"}]}]}], 
                  "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "]"}], "//", "Reap"}], "//", "Last"}], "//", "Last"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"trackMatchesInitial", "=", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Catenate", "[", 
            RowBox[{"{", 
             RowBox[{"extraConnections", ",", "trackMatchesInitial"}], "}"}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"deltaLength", "=", 
          RowBox[{"checkLength", "-", 
           RowBox[{"Length", "@", "trackMatchesInitial"}]}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trackMatchesFinal", "=", "trackMatchesInitial"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Finalized matched track groups: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "trackMatchesFinal"}]}]}], "//", 
       "PrintTemporary"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "trackMatchesFinal"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTrackOverlapIDs", "[", 
    RowBox[{"matches_", ",", "trackID_"}], "]"}], ":=", 
   RowBox[{"Position", "[", 
    RowBox[{"matches", ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"#", ",", "trackID"}], "]"}], "&"}], ")"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequence", "[", 
    RowBox[{"images_", ",", "folder_", ",", "format_", ",", "compression_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"imageSequence", "=", "images"}], ",", 
       RowBox[{"exportFormat", "=", "format"}], ",", "\[IndentingNewLine]", 
       RowBox[{"exportFolder", "=", "folder"}], ",", 
       RowBox[{"compressionLevel", "=", "compression"}], ",", "k", ",", 
       "monitorCounter"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"monitorCounter", "=", "0"}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "@", "imageSequence"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Export", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"exportFolder", "<>", "\"\<Frame_\>\"", "<>", 
               RowBox[{"ToString", "@", "k"}], "<>", "exportFormat"}], ",", 
              RowBox[{"imageSequence", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"CompressionLevel", "\[Rule]", "compressionLevel"}]}], 
             "\[IndentingNewLine]", "]"}], ";", 
            RowBox[{"monitorCounter", "++"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"progress", "[", 
          RowBox[{"monitorCounter", ",", 
           RowBox[{"Length", "@", "imageSequence"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "//", "AbsoluteTiming"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getDataBinsNoRescaling", "[", "dataset_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"N", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"MovingAverage", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
          RowBox[{"First", "@", "#"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", "}"}]}]}], 
     "&"}], "@", "dataset"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getDataBins", "[", "dataset_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"N", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"MovingAverage", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
          RowBox[{"First", "@", "#"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Rescale", "@", 
          RowBox[{"Last", "@", "#"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
     "&"}], "@", "dataset"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getResolvedRadii", "[", 
    RowBox[{
    "radiiRaw_", ",", "centroidsRaw_", ",", "centroidsResolved_", ",", 
     "criticalDistance_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Mean", "@", 
        RowBox[{"radiiRaw", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "@", 
      RowBox[{"Nearest", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"centroidsRaw", "\[Rule]", "\"\<Index\>\""}], ",", "#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"10", "^", "4"}], ",", "criticalDistance"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "&"}], "/@", "centroidsResolved"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"operateOnMatchingElements", "[", 
    RowBox[{"dataset_", ",", "matchIndices_", ",", "operation_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operation", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dataset", "[", 
           RowBox[{"[", 
            RowBox[{"frameID", ",", 
             RowBox[{"First", "@", 
              RowBox[{"matchIndices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"frameID", "-", "1"}], ",", "k"}], "]"}], "]"}]}]}], 
            "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"dataset", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"frameID", "-", "1"}], ",", 
             RowBox[{"Last", "@", 
              RowBox[{"matchIndices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"frameID", "-", "1"}], ",", "k"}], "]"}], "]"}]}]}], 
            "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{"matchIndices", "[", 
           RowBox[{"[", 
            RowBox[{"frameID", "-", "1"}], "]"}], "]"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"frameID", ",", "2", ",", 
       RowBox[{"Length", "@", "dataset"}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getMatchingIndex", "[", 
    RowBox[{"list_", ",", "checkedElement_"}], "]"}], ":=", 
   RowBox[{"Position", "[", "\[IndentingNewLine]", 
    RowBox[{"list", ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "==", "checkedElement"}], "&"}], ")"}]}], ",", 
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"Heads", "\[Rule]", "False"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaussian2D", "[", 
    RowBox[{
    "x_", ",", "y_", ",", "\[Mu]1_", ",", "\[Mu]2_", ",", "\[Sigma]1_", ",", 
     "\[Sigma]2_", ",", "\[Rho]_", ",", "a_"}], "]"}], ":=", 
   RowBox[{"a", "*", 
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Mu]1", ",", "\[Mu]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]1", "^", "2"}], ",", 
            RowBox[{"\[Rho]", "*", "\[Sigma]1", "*", "\[Sigma]2"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Rho]", "*", "\[Sigma]1", "*", "\[Sigma]2"}], ",", 
            RowBox[{"\[Sigma]2", "^", "2"}]}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"variables2D", "[", "k_Integer", "]"}], ":=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Map", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ToString", "@", "k"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Mu]1\>\"", ",", "\"\<\[Mu]2\>\"", ",", "\"\<\[Sigma]1\>\"", 
        ",", "\"\<\[Sigma]2\>\"", ",", "\"\<\[Rho]\>\"", ",", "\"\<a\>\""}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"model2D", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"gaussian2D", "[", 
     RowBox[{"x", ",", "y", ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"variables2D", "[", "i", "]"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parameters2D", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Array", "[", 
     RowBox[{"variables2D", ",", "n"}], "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constraints2D", "[", 
    RowBox[{"n_Integer", ",", "data_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"variables", ",", "dataCoordinatesMax"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"variables", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"variables2D", "/@", 
         RowBox[{"Range", "@", "n"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dataCoordinatesMax", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "/@", 
           RowBox[{"Abs", "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "2"}], "]"}], "]"}]}]}], "&"}], "@", 
         RowBox[{"Transpose", "@", "data"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"N", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"constraintLowerBound", "<", "#", "<", 
              RowBox[{"constraintFactorMagnitude", "*", 
               RowBox[{"Max", "@", 
                RowBox[{"Last", "@", 
                 RowBox[{"Transpose", "@", "data"}]}]}]}]}], "&"}], "/@", 
            RowBox[{"Last", "@", "variables"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "<", "#", "<", "1"}], "&"}], "/@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "&"}], "@", "variables"}], 
           ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"constraintLowerBound", "<", "#", "<", 
                RowBox[{
                "constraintFactorDeviation", "*", "dataCoordinatesMax"}]}], 
               "&"}], "/@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "&"}], "@", "variables"}], 
           ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"constraintLowerBound", "<", "#", "<", 
                RowBox[{
                "constraintFactorDeviation", "*", "dataCoordinatesMax"}]}], 
               "&"}], "/@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "&"}], "@", "variables"}], 
           ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "dataCoordinatesMax"}], "<", "#", "<", 
                "dataCoordinatesMax"}], "&"}], "/@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "@", "variables"}], 
           ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "dataCoordinatesMax"}], "<", "#", "<", 
                "dataCoordinatesMax"}], "&"}], "/@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "@", "variables"}], 
           ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "@", 
              RowBox[{"Denominator", "@", 
               RowBox[{
                RowBox[{"model2D", "[", "n", "]"}], "[", 
                RowBox[{"[", "k", "]"}], "]"}]}]}], ">", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitMultiGauss2D", "[", 
    RowBox[{"data_", ",", "maxn_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"SortBy", "[", 
      RowBox[{"#", ",", "Last"}], "]"}], "&"}], "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"#", "[", "fitGoodnessMeasure", "]"}]}], "}"}], "&"}], "@", 
       RowBox[{"NonlinearModelFit", "[", "\[IndentingNewLine]", 
        RowBox[{"data", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"model2D", "[", "n", "]"}], ",", 
           RowBox[{"constraints2D", "[", 
            RowBox[{"n", ",", "data"}], "]"}]}], "}"}], ",", 
         RowBox[{"parameters2D", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "maxn"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getGaussianEllipseParameters", "[", "fitModel_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "modelParameters", ",", "gaussianMeans", ",", 
       "gaussianCovarianceMatrices"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"modelParameters", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "/.", 
            RowBox[{"Rule", "\[Rule]", "List"}]}], "&"}], "@", 
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"variables2D", "@", "1"}]}]}], "]"}]}], "&"}], "@", 
        RowBox[{"fitModel", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"gaussianMeans", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "2"}], "]"}], "]"}], "&"}], "@", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", "#"}]}]}], "&"}], "/@", 
        "modelParameters"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"gaussianCovarianceMatrices", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#1", "^", "2"}], ",", 
                   RowBox[{"#3", "*", "#1", "*", "#2"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#3", "*", "#1", "*", "#2"}], ",", 
                   RowBox[{"#2", "^", "2"}]}], "}"}]}], "\[IndentingNewLine]",
                 "}"}], "&"}], "@@", "#"}], "&"}], "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;", "5"}], "]"}], "]"}]}], "&"}], "@", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", "#"}]}]}], "&"}], "/@", 
        "modelParameters"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"gaussianMeans", ",", "gaussianCovarianceMatrices"}], 
        "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getGaussianParametersErrors", "[", 
   RowBox[{"fitModel_", ",", "drawIDs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"parameterValues", ",", "parameterErrors"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"parameterValues", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Last", "/@", "#"}], "&"}], "/@", "#"}], "/.", 
            RowBox[{"Rule", "\[Rule]", "List"}]}], "&"}], "@", 
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"variables2D", "@", "1"}]}]}], "]"}]}], "&"}], "@", 
        RowBox[{"fitModel", "[", "\"\<BestFitParameters\>\"", "]"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}], "&"}], "/@", "#"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"parameterErrors", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"variables2D", "@", "1"}]}]}], "]"}], "&"}], "@", 
         RowBox[{"fitModel", "[", "\"\<ParameterErrors\>\"", "]"}]}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}], "&"}], "/@", "#"}], "&"}]}],
        "//", "Quiet"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "drawIDs", "]"}], "]"}], "&"}], "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Around", "@@", "#"}], "&"}], "/@", 
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2"}], "}"}]}]}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"parameterValues", ",", "parameterErrors"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9007574461052127`*^9, 3.900757449416144*^9}, {
   3.912242301698638*^9, 3.912242302433559*^9}, 3.9126102181735744`*^9, {
   3.91268689731627*^9, 3.9126868978167057`*^9}, {3.9126873641626883`*^9, 
   3.912687440012014*^9}, {3.9152262946548567`*^9, 3.915226295450635*^9}, {
   3.9156471117686214`*^9, 3.9156471124262347`*^9}, {3.9157351742677236`*^9, 
   3.9157351763964634`*^9}, {3.917496457745287*^9, 3.9174964594315295`*^9}, {
   3.917496508200136*^9, 3.9174965183760257`*^9}, 3.9174972436755853`*^9, 
   3.917498836484579*^9, {3.91763456247132*^9, 3.917634563122964*^9}, 
   3.9273841339656277`*^9, 3.9273841830640616`*^9, {3.9273865834925003`*^9, 
   3.9273865964826536`*^9}, 3.9274444137168846`*^9, {3.9275303920332756`*^9, 
   3.927530424624234*^9}, {3.952534806185721*^9, 3.952534850677636*^9}, {
   3.9525349093400283`*^9, 3.952534919644238*^9}, 3.95253502797174*^9, {
   3.952537884256905*^9, 3.9525378930345526`*^9}, {3.9525746393546686`*^9, 
   3.9525746405838585`*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"f2cecb38-9f8d-4929-b2a9-a242eaa543b5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.821639993205228*^9}, {3.8381869586707425`*^9, 
   3.8381869649591913`*^9}, 3.838187468055561*^9, 3.8381890306710825`*^9, {
   3.8382140851103477`*^9, 3.838214092870597*^9}},
 FontSize->24,ExpressionUUID->"447b3b0e-75f4-47b3-a64a-78bf3de169ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getMaskOverlays", "[", 
    RowBox[{"image_", ",", "mask_", ",", "color_", ",", "thickness_"}], "]"}],
    ":=", 
   RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ImageAdjust", "@", "image"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ColorReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"White", "\[Rule]", "color"}]}], "]"}], "&"}], "@", 
        RowBox[{"Binarize", "@", 
         RowBox[{"GaussianFilter", "[", 
          RowBox[{"#", ",", "thickness"}], "]"}]}]}], "&"}], "@", 
      RowBox[{"EdgeDetect", "@", "mask"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTrackPlots", "[", "cleanTracks_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "plotRangesTracks", ",", "plotRangeOffsets", ",", 
       "plotRangeTracksWithOffsets", ",", "\[IndentingNewLine]", 
       "swarmTrackAspectRatios", ",", "endpointSizes", ",", 
       "\[IndentingNewLine]", "colorPalette", ",", "colorGrading", ",", 
       "dotColors", ",", "dotsGotStyle", ",", "\[IndentingNewLine]", 
       RowBox[{"inputTracks", "=", "cleanTracks"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"colorPalette", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<RedBlueTones\>\"", ",", "\"\<Reverse\>\""}], "}"}], 
        "}"}]}], ";", "\n", 
      RowBox[{"colorGrading", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Rescale", "@", 
          RowBox[{"N", "@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"#", "&"}], ",", 
             RowBox[{"Range", "@", 
              RowBox[{"Length", "@", "#"}]}]}], "]"}]}]}], "&"}], "/@", 
        "inputTracks"}]}], ";", "\n", 
      RowBox[{"dotColors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ColorData", "@", 
              RowBox[{"colorPalette", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", "#", "]"}], 
           "&"}], "/@", "#"}], "&"}], "/@", "colorGrading"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dotsGotStyle", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Point", "@", "#1"}], ",", "#2", ",", 
              RowBox[{"PointSize", "@", 
               RowBox[{"centroidPointSize", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"inputTracks", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"dotColors", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "inputTracks"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plotRangesTracks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "@", "#"}], ",", 
               RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], "@", 
            RowBox[{"Sort", "@", "#"}]}], "&"}], "/@", 
          RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", "inputTracks"}]}], 
      ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"plotRangeOffsets", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"plotRangeOffsetScale", "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
          RowBox[{"Min", "@", "#"}]}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Subtract", "@@", 
              RowBox[{"Reverse", "@", "#"}]}], "&"}], "/@", "#"}], "&"}], "/@",
           "plotRangesTracks"}], ")"}]}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"plotRangeTracksWithOffsets", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "@", "#1"}], "+", "#2"}], ",", 
            RowBox[{
             RowBox[{"Last", "@", "#1"}], "+", "#2"}]}], "}"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"plotRangesTracks", ",", "plotRangeOffsets"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\n", "\n", 
      RowBox[{"swarmTrackAspectRatios", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Divide", "@@", 
            RowBox[{"Reverse", "@", 
             RowBox[{"ImageDimensions", "@", 
              RowBox[{"Image", "@", 
               RowBox[{"Graphics", "@", 
                RowBox[{"Line", "@", "#"}]}]}]}]}]}], "&"}], "/@", 
          "inputTracks"}], "//", "N"}], "//", 
        RowBox[{
         RowBox[{"#", "*", "scalesAspectRatio"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"endpointSizes", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"endpointSizeScale", "*", 
           RowBox[{"Times", "@@", "#"}]}], "&"}], "/@", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Subtract", "@@", 
               RowBox[{"Reverse", "@", "#"}]}], "&"}], "/@", "#"}], "&"}], "/@",
            "plotRangesTracks"}], "\[IndentingNewLine]", ")"}]}], "//", 
        RowBox[{
         RowBox[{"#", "*", "scalesEndpointSizes"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
          RowBox[{"#1", ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", "None"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "#2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Lighter", "@", "Gray"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "#4"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Point", "@", 
                 RowBox[{"First", "@", "#1"}]}], ",", 
                RowBox[{"Darker", "@", "Green"}], ",", 
                RowBox[{"PointSize", "@", "#3"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Point", "@", 
                 RowBox[{"Last", "@", "#1"}]}], ",", "Red", ",", 
                RowBox[{"PointSize", "@", "#3"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "#5"}], "\[IndentingNewLine]", "}"}]}]}],
           "]"}], "&"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "inputTracks", ",", "swarmTrackAspectRatios", ",", "endpointSizes", 
          ",", "\[IndentingNewLine]", "plotRangeTracksWithOffsets", ",", 
          "dotsGotStyle"}], "\[IndentingNewLine]", "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"viewImage", "[", "image_", "]"}], ":=", 
   RowBox[{"Image", "[", 
    RowBox[{"image", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImagesTwoFormat", "[", 
    RowBox[{"image_", ",", "imageName_", ",", "imageResolution_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"#1", "<>", "imageName", "<>", "#2"}], ",", "image", ",", 
         RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
       "&"}], "@@", "#"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"outputTrackFolder", ",", "\"\<.pdf\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"outputTrackFolder", ",", "\"\<.svg\>\""}], "}"}]}], "}"}]}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getLatexStyling", "[", "latexInput_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MaTeX", "[", 
        RowBox[{"#", ",", 
         RowBox[{"FontSize", "\[Rule]", 
          RowBox[{"fontSize", "+", "2"}]}]}], "]"}], "&"}], "@", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"\"\<\\\\boldsymbol{\>\"", "<>", 
        RowBox[{"ToString", "@", "#"}], "<>", "\"\<}\>\""}], 
       "\[IndentingNewLine]", ")"}]}], "&"}], "@", "latexInput"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getLogLog10Plot", "[", 
    RowBox[{
    "dataset_", ",", "plotRange_", ",", "plotLabels_", ",", "plotLegends_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"ScalingFunctions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Log10\>\"", ",", "\"\<Log10\>\""}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "aspectLogLog"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "\[Rule]", "plotLegends"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", "plotLabels"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "None"}], "}"}]}], "\[IndentingNewLine]", 
           "}"}]}], "&"}], "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", "i"}], ",", 
            RowBox[{"Superscript", "[", 
             RowBox[{"10", ",", "i"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", "dataset"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImagesTwoFormat", "[", 
    RowBox[{"image_", ",", "imageName_", ",", "imageResolution_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"#1", "<>", "imageName", "<>", "#2"}], ",", "image", ",", 
         RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
       "&"}], "@@", "#"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"output", ",", "\"\<.pdf\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"output", ",", "\"\<.svg\>\""}], "}"}]}], "}"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getBinPlot", "[", 
    RowBox[{
    "bins_", ",", "labels_", ",", "xAxisRange_", ",", "plotLegends_", ",", 
     "scalingFunctions_"}], "]"}], ":=", 
   RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
    RowBox[{"bins", ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"xAxisRange", ",", "All"}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "plotLegends"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", "labels"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "histogramInterpolationOrder"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
     RowBox[{"ScalingFunctions", "\[Rule]", "scalingFunctions"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "\[Rule]", "binPlotFrameTicks"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSmoothPropertyHistogram", "[", 
    RowBox[{
    "dataset_", ",", "labels_", ",", "xAxisRange_", ",", "plotLegends_", ",", 
     "scalingFunctions_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"getBinPlot", "[", "\[IndentingNewLine]", 
      RowBox[{
      "#", ",", "labels", ",", "xAxisRange", ",", "plotLegends", ",", 
       "scalingFunctions"}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"getDataBins", "@", 
        RowBox[{"HistogramList", "[", 
         RowBox[{"#", ",", "histogramBinningMethod"}], "]"}]}], "&"}], "/@", 
      "dataset"}], ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "@", "Hexagon"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "@", "Vertices"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hexBinPlot", "[", 
    RowBox[{"data_", ",", "cs_", ",", "ptype_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "hexagonPositions", ",", "hexagonVertices", ",", "nearbin", ",", 
       "counts", ",", "translateRotate", ",", "maxCount"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"<<", "Polytopes`"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hexagonPositions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], ",", 
          RowBox[{"(*", 
           RowBox[{"hexagon", " ", "positions"}], "*)"}], 
          RowBox[{"{", 
           RowBox[{"p", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{
             RowBox[{"3", "*", 
              RowBox[{"p", "/", "2"}], "*", "cs"}], "+", 
             RowBox[{"Min", "[", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"3", "*", "cs"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"p", "*", 
              RowBox[{
               RowBox[{"Sqrt", "@", "3"}], "/", "2"}], "*", "cs"}], "+", 
             RowBox[{"Min", "[", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Sqrt", "@", "3"}], "*", "cs"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hexagonVertices", "=", 
       RowBox[{"cs", "*", " ", 
        RowBox[{"Vertices", "[", "Hexagon", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nearbin", "=", 
       RowBox[{"Nearest", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"hexagonPositions", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "i"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "hexagonPositions"}]}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"counts", "=", 
       RowBox[{"BinCounts", "[", 
        RowBox[{
         RowBox[{"nearbin", "/@", "data"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"Length", "@", "hexagonPositions"}], "+", "1"}], ",", 
           "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxCount", "=", 
       RowBox[{"Max", "@", "counts"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"translateRotate", "[", 
        RowBox[{"vertices_", ",", "translation_"}], "]"}], ":=", 
       RowBox[{"Translate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Rotate", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Pi", "/", "2"}]}], "]"}], "&"}], "@", 
          RowBox[{"Polygon", "@", "vertices"}]}], ",", "translation"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Legended", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{"BarLegend", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"colorScheme", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "9", ",", 
             RowBox[{"LegendMarkerSize", "\[Rule]", "legendSize"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"fontSize", ",", "Black", ",", "Bold"}], "}"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
         "&"}], "@", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Switch", "[", "\[IndentingNewLine]", 
               RowBox[{"ptype", ",", "1", ",", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ColorData", "[", "colorScheme", "]"}], "[", 
                   RowBox[{
                    RowBox[{"counts", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", "maxCount"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"opacityModel", "[", 
                   RowBox[{
                    RowBox[{"counts", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", "maxCount"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"translateRotate", "[", 
                   RowBox[{"hexagonVertices", ",", 
                    RowBox[{"hexagonPositions", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}], ",", "2", ",", 
                RowBox[{"translateRotate", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"counts", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", "maxCount"}], "*", 
                   "hexagonVertices"}], ",", 
                  RowBox[{"hexagonPositions", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", 
                 "]"}], ",", "3", ",", 
                RowBox[{"translateRotate", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"counts", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", "maxCount"}], "]"}], 
                   "*", "hexagonVertices"}], ",", 
                  RowBox[{"hexagonPositions", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", 
                 "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"Length", "@", "hexagonPositions"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"fontSize", ",", "Black", ",", "Bold"}], "}"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"getLatexStyling", "/@", "frameLabels"}]}], ",", 
            RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"GridLinesStyle", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "aspectRatio"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameTicks", "\[Rule]", "hexPlotFrameTicks"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "plotRange"}]}], 
         "\[IndentingNewLine]", "]"}]}], "//", "Quiet"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hexBinPlotPopulations", "[", 
    RowBox[{"data_", ",", "cs_", ",", "ptype_", ",", "populationIDs_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "hexagonPositions", ",", "hexagonVertices", ",", "nearbin", ",", 
       "counts", ",", "translateRotate", ",", "maxCount"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"<<", "Polytopes`"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hexagonPositions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], ",", 
          RowBox[{"(*", 
           RowBox[{"hexagon", " ", "positions"}], "*)"}], 
          RowBox[{"{", 
           RowBox[{"p", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{
             RowBox[{"3", "*", 
              RowBox[{"p", "/", "2"}], "*", "cs"}], "+", 
             RowBox[{"Min", "[", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"3", "*", "cs"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"p", "*", 
              RowBox[{
               RowBox[{"Sqrt", "@", "3"}], "/", "2"}], "*", "cs"}], "+", 
             RowBox[{"Min", "[", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Sqrt", "@", "3"}], "*", "cs"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hexagonVertices", "=", 
       RowBox[{"cs", "*", " ", 
        RowBox[{"Vertices", "[", "Hexagon", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nearbin", "=", 
       RowBox[{"Nearest", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"hexagonPositions", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "i"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "hexagonPositions"}]}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"counts", "=", 
       RowBox[{"BinCounts", "[", 
        RowBox[{
         RowBox[{"nearbin", "/@", "data"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"Length", "@", "hexagonPositions"}], "+", "1"}], ",", 
           "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxCount", "=", 
       RowBox[{"Max", "@", "counts"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"translateRotate", "[", 
        RowBox[{"vertices_", ",", "translation_"}], "]"}], ":=", 
       RowBox[{"Translate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Rotate", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Pi", "/", "2"}]}], "]"}], "&"}], "@", 
          RowBox[{"Polygon", "@", "vertices"}]}], ",", "translation"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Legended", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"BarLegend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"colorScheme", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "9", ",", 
                RowBox[{"LegendMarkerSize", "\[Rule]", "legendSize"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"fontSize", ",", "Black", ",", "Bold"}], "}"}]}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
            "&"}], "@", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Switch", "[", "\[IndentingNewLine]", 
                  RowBox[{"ptype", ",", "1", ",", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorData", "[", "colorScheme", "]"}], "[", 
                    RowBox[{
                    RowBox[{"counts", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", "maxCount"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"opacityModel", "[", 
                    RowBox[{
                    RowBox[{"counts", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", "maxCount"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"translateRotate", "[", 
                    RowBox[{"hexagonVertices", ",", 
                    RowBox[{"hexagonPositions", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "2", ",", 
                   RowBox[{"translateRotate", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"counts", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", "maxCount"}], "*", 
                    "hexagonVertices"}], ",", 
                    RowBox[{"hexagonPositions", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", 
                    "]"}], ",", "3", ",", 
                   RowBox[{"translateRotate", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"counts", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", "maxCount"}], "]"}], 
                    "*", "hexagonVertices"}], ",", 
                    RowBox[{"hexagonPositions", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", 
                    "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", 
                   RowBox[{"Length", "@", "hexagonPositions"}]}], "}"}]}], 
                "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"fontSize", ",", "Black", ",", "Bold"}], "}"}]}], 
               ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"getLatexStyling", "/@", "frameLabels"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"GridLinesStyle", "\[Rule]", "Automatic"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", "aspectRatio"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FrameTicks", "\[Rule]", "hexPlotFrameTicks"}]}], 
              "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "plotRange"}]}], 
            "\[IndentingNewLine]", "]"}]}], "//", "Quiet"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "/@", 
          RowBox[{"getGaussianEllipseGraphics", "/@", 
           RowBox[{"fitModelParameters", "[", 
            RowBox[{"[", "populationIDs", "]"}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hexToRGB", "=", 
    RowBox[{
     RowBox[{"RGBColor", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"ToExpression", "@", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"#", ",", 
             RowBox[{"\"\<#\>\"", "\[Rule]", "\"\<16^^\>\""}]}], "]"}]}], ",",
           "256", ",", "3"}], "]"}], "/", "255."}], ")"}]}], "&"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getGaussianEllipseGraphics", "[", "parameters_", "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Opacity", "[", "0", "]"}], ",", 
    RowBox[{"EdgeForm", "[", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "populationEllipseColor", ",", "Dashed"}], "}"}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Ellipsoid", "[", 
       RowBox[{
        RowBox[{"First", "@", "parameters"}], ",", 
        RowBox[{"#", "*", 
         RowBox[{"Last", "@", "parameters"}]}]}], "]"}], "&"}], "@", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"ChiSquareDistribution", "@", "2"}], ",", 
       "populationQuantile"}], "]"}]}]}], "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.90068966408706*^9, 3.9006896686240034`*^9}, {
   3.9006904142237864`*^9, 3.9006904199737215`*^9}, {3.9006909164550686`*^9, 
   3.900690934171604*^9}, {3.901175535879501*^9, 3.901175536327242*^9}, 
   3.901175758536609*^9, {3.9126102046196547`*^9, 3.9126102270021324`*^9}, {
   3.9126868870879173`*^9, 3.9126868875886993`*^9}, {3.9156471317848053`*^9, 
   3.915647132293433*^9}, {3.9170052973129253`*^9, 3.9170052982679567`*^9}, 
   3.9170186687019424`*^9, {3.917034281573038*^9, 3.917034281740424*^9}, {
   3.9170397335761786`*^9, 3.9170397340816565`*^9}, {3.917346699896623*^9, 
   3.9173467523527327`*^9}, {3.9173471099306784`*^9, 3.917347138872114*^9}, {
   3.917348374360454*^9, 3.9173483833370733`*^9}, {3.9173484904896765`*^9, 
   3.9173485038722143`*^9}, {3.942226509448118*^9, 3.9422265099837456`*^9}, 
   3.942319304822722*^9, {3.9525360849145937`*^9, 3.9525360857327023`*^9}, {
   3.952537903298277*^9, 3.9525379121491528`*^9}},
 CellLabel->
  "In[392]:=",ExpressionUUID->"ddc481c0-94e3-4c45-956f-8153bed520bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"previewImages", "=", "images"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Image", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"Scaled", "@", "0.75"}]}]}], "]"}], "&"}], "@", 
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"previewImages", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "previewImages"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.847348164976734*^9, 3.8473482034795685`*^9}, {
  3.8473587967119102`*^9, 3.84735880759993*^9}, {3.8473590742000065`*^9, 
  3.847359106208709*^9}, {3.847359452569849*^9, 3.8473595079603925`*^9}, {
  3.8473595389841976`*^9, 3.847359539120832*^9}, {3.8474397485342627`*^9, 
  3.8474397553889327`*^9}, {3.8852951986578484`*^9, 3.88529520428992*^9}, {
  3.8852958562998705`*^9, 3.8852958631861887`*^9}, {3.9010178584859877`*^9, 
  3.9010178598843517`*^9}, {3.9011079190122294`*^9, 3.9011079202495365`*^9}, {
  3.901109137722915*^9, 3.9011091386112013`*^9}, {3.912604228616004*^9, 
  3.9126042430427485`*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"36090b63-ae54-4f1b-94e5-fa11e9a62475"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Crop Images", "Section",
 CellChangeTimes->{{3.888313862470392*^9, 3.888313878259631*^9}, {
  3.88832166456643*^9, 
  3.888321665910595*^9}},ExpressionUUID->"705fb16b-8cc2-45c0-ad21-\
d6e11d6bf620"],

Cell[CellGroupData[{

Cell["Crop Images", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 3.915222540309099*^9}, {
   3.9156234121902*^9, 3.9156234139811716`*^9}, {3.915647180927271*^9, 
   3.915647182375304*^9}},ExpressionUUID->"1f27300e-a2ff-473e-bbec-\
27457f1ab2b6"],

Cell["\<\
Defaults :
   
selectedImages=1;;All;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, 3.9010341626470175`*^9, 3.901050201650057*^9, 
   3.9011063688737135`*^9},
 FontSize->16,ExpressionUUID->"d80f12ec-e7c7-40e5-8bad-f099f3729550"],

Cell[BoxData[
 RowBox[{
  RowBox[{"selectedImages", "=", 
   RowBox[{"1", ";;", "All"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.89876929180124*^9, 3.8987693095602007`*^9}, 
   3.898769618408449*^9, {3.9010501473852425`*^9, 3.9010501477292156`*^9}, 
   3.9010925475579243`*^9, 3.901106354561016*^9, {3.901106400031975*^9, 
   3.901106401264494*^9}, 3.901107802769897*^9, {3.901108134513094*^9, 
   3.9011081364976063`*^9}, {3.903862636401534*^9, 3.903862650905411*^9}, {
   3.9054453382875657`*^9, 3.9054453542881613`*^9}, 3.926859890298006*^9, {
   3.9272893308098392`*^9, 3.92728933134527*^9}, {3.951727424488776*^9, 
   3.9517274247985935`*^9}, {3.951727507663493*^9, 3.951727509384767*^9}, {
   3.9517378872599487`*^9, 3.951737888795113*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"ea809154-2c1c-41a8-a2b3-a45f80bbdfad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sequenceImages", "=", 
    RowBox[{"images", "[", 
     RowBox[{"[", "selectedImages", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"testImage", "=", 
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"sequenceImages", "[", 
       RowBox[{"[", "imageID", "]"}], "]"}]}]}], ";", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"width", ",", "height"}], "}"}], "=", 
     RowBox[{"ImageDimensions", "@", "testImage"}]}], ";", "\n", 
    "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Grid", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{"testImage", ",", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"EdgeForm", "[", 
                RowBox[{"{", 
                 RowBox[{"Yellow", ",", 
                  RowBox[{"Thickness", "@", "0.0035"}]}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Opacity", "@", "0.10"}], ",", "Yellow", ",", 
               RowBox[{"Rectangle", "@@", "points"}]}], "}"}], 
             "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "525"}]}], "\[IndentingNewLine]", 
           "]"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"croppedImage", "=", 
             RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
              RowBox[{"testImage", ",", "\[IndentingNewLine]", 
               RowBox[{"rowRange", "=", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"height", "-", 
                  RowBox[{"points", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"columnRange", "=", 
                RowBox[{"points", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"UpTo", "@", "450"}]}]}], "\[IndentingNewLine]", "]"}], 
          "}"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"points", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"width", ",", "height"}], "}"}], "/", "2"}]}], "}"}]}], 
         "}"}], ",", "Locator"}], "\[IndentingNewLine]", "}"}]}], "]"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"imageID", ",", "1", ",", 
     RowBox[{"Length", "@", "sequenceImages"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.877374989415597*^9, 3.8773750036916785`*^9}, {
   3.8773750355847387`*^9, 3.8773750405770674`*^9}, {3.8773750796454935`*^9, 
   3.8773752099007215`*^9}, {3.877375249289606*^9, 3.877375306156417*^9}, {
   3.877375350183156*^9, 3.8773753596606655`*^9}, {3.8773754875524025`*^9, 
   3.8773754985733185`*^9}, {3.877375582441363*^9, 3.877375617151244*^9}, {
   3.8773763307806625`*^9, 3.877376332602451*^9}, {3.8773767213676643`*^9, 
   3.8773767737001653`*^9}, {3.877376961514588*^9, 3.8773769624325247`*^9}, {
   3.877377025017548*^9, 3.8773770354890585`*^9}, 3.8773770897698135`*^9, {
   3.8773772182335863`*^9, 3.8773772210328712`*^9}, {3.8773775994976454`*^9, 
   3.877377628833558*^9}, {3.8773776701768255`*^9, 3.8773776978996763`*^9}, {
   3.8773799030145936`*^9, 3.8773799168366785`*^9}, {3.87737995980272*^9, 
   3.8773799600600195`*^9}, {3.8773815112975636`*^9, 
   3.8773815175225506`*^9}, {3.8773815740668592`*^9, 
   3.8773815798208094`*^9}, {3.8773817006335773`*^9, 
   3.8773817574597917`*^9}, {3.877382027314622*^9, 3.8773820290337963`*^9}, {
   3.877382866204748*^9, 3.8773829105266013`*^9}, {3.8773830170897183`*^9, 
   3.8773831043927875`*^9}, {3.87738315012831*^9, 3.877383167672226*^9}, {
   3.877453763906587*^9, 3.877453849664575*^9}, {3.877515428424682*^9, 
   3.877515477863963*^9}, {3.8777171265330076`*^9, 3.87771713790848*^9}, {
   3.8777172386365623`*^9, 3.877717251874132*^9}, 3.877779044561672*^9, {
   3.878130848265929*^9, 3.87813084939392*^9}, 3.878322141765069*^9, {
   3.888313884476748*^9, 3.888313889580989*^9}, {3.888335011698847*^9, 
   3.8883350118979816`*^9}, 3.888395625409953*^9, {3.89876863302799*^9, 
   3.898768633384777*^9}, 3.8987693047700453`*^9, {3.9010925598298883`*^9, 
   3.901092570304926*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"2b5cef35-4c1a-4a20-83fa-c586037cf742"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"rowRange", ",", "columnRange"}], "}"}], "//", "TableForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"Image", "[", 
       RowBox[{"#", ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "&"}], "@", 
    RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sequenceImages", "[", 
       RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", "rowRange",
       ",", "columnRange"}], "\[IndentingNewLine]", "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "sequenceImages"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.877377507276599*^9, 3.8773775535996113`*^9}, {
   3.877377789922418*^9, 3.877377806279915*^9}, 3.8773799921662216`*^9, {
   3.8773818265707884`*^9, 3.877381843020713*^9}, {3.8773820738765965`*^9, 
   3.8773820756908646`*^9}, {3.877434221064697*^9, 3.8774342249785385`*^9}, {
   3.901016752157523*^9, 3.901016759782638*^9}, {3.9011067865842185`*^9, 
   3.9011067876811714`*^9}, {3.9011741932935205`*^9, 
   3.9011741944827547`*^9}, {3.9011884938375587`*^9, 3.9011884943818655`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"c896e02f-9b14-4d34-b522-6c913708f87a"],

Cell["\<\
Defaults :
   
imageIndices=1;;All;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, 3.9010341626470175`*^9, 3.901050201650057*^9},
 FontSize->16,ExpressionUUID->"e64fe3f4-2fa6-40aa-9559-4213b991c635"],

Cell[BoxData[
 RowBox[{
  RowBox[{"imageIndices", "=", 
   RowBox[{"1", ";;", "All"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9010341179795713`*^9, 3.9010341412383795`*^9}, {
   3.9010501986190166`*^9, 3.9010501988492575`*^9}, {3.9011758860437098`*^9, 
   3.901175888239133*^9}, {3.9011763221740255`*^9, 3.9011763236382313`*^9}, {
   3.9011842440688753`*^9, 3.9011842645264044`*^9}, 3.901184596434497*^9, {
   3.9011869396056814`*^9, 3.901186939925429*^9}, 3.901187028032392*^9, {
   3.9011881310856867`*^9, 3.9011881411437864`*^9}, {3.9011885951976113`*^9, 
   3.9011885954655223`*^9}, {3.9038526654482193`*^9, 3.9038526668634353`*^9}, 
   3.903852721063405*^9, {3.9038528713754816`*^9, 3.903852871827273*^9}, 
   3.9038626551772213`*^9, 3.903871296619178*^9, {3.905445420222046*^9, 
   3.905445421712035*^9}, {3.9054458030810037`*^9, 3.905445803390708*^9}, {
   3.9054459270965233`*^9, 3.9054459288464217`*^9}, {3.905446225689576*^9, 
   3.9054462259433875`*^9}, {3.9054552827663283`*^9, 
   3.9054552829579134`*^9}, {3.905455829471774*^9, 3.905455830469693*^9}, {
   3.9054559815420876`*^9, 3.9054559819425783`*^9}, {3.9054561093749046`*^9, 
   3.905456110885648*^9}, 3.905456368510189*^9, {3.927515860760809*^9, 
   3.9275158611682963`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"d8d5bcef-e524-4621-8af8-ec25bbbe5cef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"croppedImages", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ImageTake", "[", 
         RowBox[{"#", ",", "rowRange", ",", "columnRange"}], "]"}], "&"}], "/@",
        "\[IndentingNewLine]", 
       RowBox[{"sequenceImages", "[", 
        RowBox[{"[", "imageIndices", "]"}], "]"}]}], "//", "Parallelize"}]}], 
    ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"images", "=", "croppedImages"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"First", "@", "images"}], "//", "ImageDimensions"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8883199125691833`*^9, 3.8883199277064157`*^9}, {
   3.901008465957751*^9, 3.9010084666706953`*^9}, {3.9010114234787903`*^9, 
   3.901011427231417*^9}, {3.9010161219957676`*^9, 3.901016122999207*^9}, {
   3.901017566811705*^9, 3.9010175671637816`*^9}, {3.9010179419963865`*^9, 
   3.901017942286087*^9}, {3.9010340740540032`*^9, 3.9010340743891463`*^9}, 
   3.9010341485698442`*^9},
 CellLabel->
  "In[143]:=",ExpressionUUID->"ac438bf6-8991-4af6-a004-941a9b35b5af"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Cropped Images >>", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 3.915222540309099*^9}, {
   3.9156234121902*^9, 
   3.9156234139811716`*^9}},ExpressionUUID->"f057e038-c20b-4c37-be24-\
dc8b7caebf76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"croppedImagesFolder", "=", 
   RowBox[{"output", "<>", "\"\<1 Cropped Images\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"croppedImagesFolder", "//", "CreateDirectory"}], ";"}], "//", 
   "Quiet"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
    RowBox[{
    "croppedImages", ",", "croppedImagesFolder", ",", "\"\<.tiff\>\"", ",", 
     "0"}], "\[IndentingNewLine]", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8892817493431044`*^9, 3.8892817805519447`*^9}, {
   3.889281837143244*^9, 3.88928191320846*^9}, {3.8892819594009056`*^9, 
   3.889281979209507*^9}, {3.8892821229194517`*^9, 3.8892821513839016`*^9}, {
   3.889621126101282*^9, 3.8896211918063293`*^9}, 3.8896214994948688`*^9, {
   3.8896215537218475`*^9, 3.889621561789811*^9}, {3.8896216430248423`*^9, 
   3.8896216457023907`*^9}, 3.8896216789445276`*^9, {3.8896220419612627`*^9, 
   3.8896220975531425`*^9}, {3.889623340867552*^9, 3.8896233411228905`*^9}, {
   3.8899819697164917`*^9, 3.889981979009638*^9}, 3.889982019469488*^9, {
   3.8899820760598574`*^9, 3.8899820783107395`*^9}, {3.890046229067525*^9, 
   3.890046277931983*^9}, {3.890527335932677*^9, 3.8905273362291927`*^9}, {
   3.899494914195033*^9, 3.8994949154990673`*^9}, {3.9152225301919775`*^9, 
   3.915222534823679*^9}, {3.9152225847640715`*^9, 3.9152226171491485`*^9}, {
   3.915223424822422*^9, 3.915223436343696*^9}, {3.9152234753578963`*^9, 
   3.915223478397222*^9}, {3.9152235935791206`*^9, 3.915223594570014*^9}, {
   3.915226334078206*^9, 3.9152263746314983`*^9}, {3.9156276078247695`*^9, 
   3.9156276080076075`*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"481aef5d-0460-4b8a-90c1-981f84e664e5"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Cropped Images <<", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, {3.88962249911553*^9, 3.8896225193161316`*^9}, 
   3.8896234870902314`*^9, {3.915222523970116*^9, 3.9152225455522757`*^9}, {
   3.9156234200790715`*^9, 
   3.915623424078086*^9}},ExpressionUUID->"0b83ef93-446d-460d-a2eb-\
064a64462b5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"croppedImagesFolder", "=", 
   RowBox[{"output", "<>", "\"\<1 Cropped Images\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", "croppedImagesFolder"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"croppedImages", "=", 
      RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"croppedImagesFolder", "<>", "#"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", "files"}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"images", "=", "croppedImages"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896225359098797`*^9, 3.8896226218372874`*^9}, {3.88962271829244*^9, 
   3.8896227275498905`*^9}, {3.889623134636578*^9, 3.889623137861703*^9}, {
   3.889623351635437*^9, 3.889623352090786*^9}, {3.8896235050986195`*^9, 
   3.889623534803034*^9}, 3.8899815513595295`*^9, {3.8901546653652105`*^9, 
   3.890154666131366*^9}, {3.8903837878670807`*^9, 3.8903837896332626`*^9}, {
   3.8903838511865406`*^9, 3.890383858398181*^9}, 3.8903839043715124`*^9, {
   3.890384135310108*^9, 3.890384146650017*^9}, {3.890386917039728*^9, 
   3.8903869187284775`*^9}, {3.8904093272504597`*^9, 3.890409333525776*^9}, 
   3.890409366183757*^9, {3.890527338154413*^9, 3.8905273383735204`*^9}, {
   3.8988782099719763`*^9, 3.8988782104193707`*^9}, {3.900093179450349*^9, 
   3.9000932064248447`*^9}, {3.9152226218831253`*^9, 3.915222649675064*^9}, {
   3.9152234558563757`*^9, 3.915223457637218*^9}, {3.9152264040897427`*^9, 
   3.9152264238564825`*^9}, {3.915226696268087*^9, 3.9152266970928*^9}, {
   3.915623639142209*^9, 3.9156236478696947`*^9}, {3.915627606721238*^9, 
   3.9156276069032154`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"cc3d71a1-0da4-48cd-a813-bc6f4261201e"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Image Processing", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 3.8468307830344753`*^9}, {3.8852951251696224`*^9, 
  3.885295127082173*^9}, {3.889042301650259*^9, 3.8890423160585136`*^9}, {
  3.9000526688877544`*^9, 
  3.900052673095501*^9}},ExpressionUUID->"a8f455e4-79ce-4a1f-aa6e-\
c1acf7a0f4f8"],

Cell[CellGroupData[{

Cell["Image Correction", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000535978873005`*^9}},
 FontSize->24,ExpressionUUID->"57c12432-79fe-429b-90ae-cc5390c78762"],

Cell[CellGroupData[{

Cell["OPTION 1: Set Up Manual Correction Intervals", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, {3.88962249911553*^9, 3.8896225193161316`*^9}, 
   3.8896234870902314`*^9, {3.915222523970116*^9, 3.9152225455522757`*^9}, {
   3.9156234200790715`*^9, 3.915623424078086*^9}, {3.9417963491908474`*^9, 
   3.941796369852121*^9}},ExpressionUUID->"785ccf5c-0364-401f-bc40-\
87074b8ab9c8"],

Cell["\<\
Defaults :
   
useCTM=0;   <<   0 or 1
meanCorrectionInvervals={1;;All};\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, {3.905446106002844*^9, 3.9054461063221574`*^9}, 
   3.912238906748783*^9, 3.912247697133684*^9, {3.9122477658867474`*^9, 
   3.9122477785803137`*^9}, 3.9152128103077116`*^9, {3.9273077945637145`*^9, 
   3.927307797830636*^9}, {3.9273104799980865`*^9, 3.927310482909319*^9}},
 FontSize->16,ExpressionUUID->"2520eaf4-71de-477a-b1fd-56d1fbdf91f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"useCTM", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"meanCorrectionInvervals", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"1", ";;", "All"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "meanCorrectionInvervals"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.901009787504681*^9, 3.9010097917100735`*^9}, 
   3.901017960267641*^9, {3.901034176749588*^9, 3.9010341768454943`*^9}, 
   3.9011050676796865`*^9, {3.9011068285285273`*^9, 3.901106843624278*^9}, 
   3.9011082033089123`*^9, 3.901108372307288*^9, 3.901109217600709*^9, {
   3.9011763293879924`*^9, 3.9011763297396183`*^9}, 3.9011766405011177`*^9, 
   3.9011774997351437`*^9, 3.90117854367038*^9, 3.901183912748456*^9, 
   3.9011841207396836`*^9, 3.903852673816848*^9, {3.9038745768439617`*^9, 
   3.9038745770329046`*^9}, 3.90387471324263*^9, {3.905445481871092*^9, 
   3.905445492025133*^9}, {3.9054456303064594`*^9, 3.9054456480482044`*^9}, {
   3.9054461127594285`*^9, 3.905446113009146*^9}, {3.9054461870229206`*^9, 
   3.9054461973750253`*^9}, {3.9054462299201355`*^9, 3.905446246857829*^9}, {
   3.905446365838926*^9, 3.9054463675750422`*^9}, 3.905446433024422*^9, {
   3.905449949081295*^9, 3.9054499593640423`*^9}, 3.905450643585202*^9, 
   3.9054520770789537`*^9, {3.90545264245087*^9, 3.9054526473983707`*^9}, {
   3.9054533073607955`*^9, 3.9054533269020557`*^9}, {3.9054533700507135`*^9, 
   3.9054533719655743`*^9}, 3.9054534907671537`*^9, 3.905454250495185*^9, {
   3.9054544769139967`*^9, 3.905454478516764*^9}, {3.9054545727920027`*^9, 
   3.9054545746383953`*^9}, {3.9054548299353004`*^9, 3.905454840717119*^9}, {
   3.9054550290800695`*^9, 3.9054550305729957`*^9}, 3.905455104470749*^9, 
   3.9054551585516367`*^9, {3.9054551951292863`*^9, 3.9054551971089716`*^9}, {
   3.905455256249323*^9, 3.905455256687652*^9}, 3.9122389005751343`*^9, {
   3.9122477052292285`*^9, 3.9122477481488*^9}, {3.91521249605107*^9, 
   3.915212500442044*^9}, {3.91521270093182*^9, 3.9152127040776834`*^9}, 
   3.915212816215397*^9, {3.9273077786815367`*^9, 3.927307791304179*^9}, 
   3.927391896344944*^9, {3.927391940609065*^9, 3.9273919431032314`*^9}, {
   3.92739252623242*^9, 3.9273925587910137`*^9}, {3.9273925932074995`*^9, 
   3.927392609503331*^9}, {3.927392639863887*^9, 3.9273926634871087`*^9}, {
   3.9274372442329435`*^9, 3.9274372492707396`*^9}, 3.927437470455326*^9, {
   3.9275158337924075`*^9, 3.9275158351920075`*^9}, {3.9275160191938877`*^9, 
   3.927516044038872*^9}, 3.9275161219787426`*^9, {3.9275372799409065`*^9, 
   3.927537284763134*^9}, {3.9275377280198774`*^9, 3.927537735578683*^9}, 
   3.927544336012204*^9, 3.938684875820511*^9, {3.9417219742580175`*^9, 
   3.941722037562044*^9}, {3.9417220680016036`*^9, 3.9417220773535986`*^9}, {
   3.941722142905958*^9, 3.9417221601547174`*^9}, {3.941783250541774*^9, 
   3.941783271211969*^9}, {3.9417833400840487`*^9, 3.941783507604704*^9}, {
   3.941783597340151*^9, 3.9417836314288154`*^9}, 3.94186282825605*^9, 
   3.951727716639488*^9, 3.9517279051280355`*^9},
 CellLabel->
  "In[125]:=",ExpressionUUID->"23f96611-e7e7-42db-ba7b-cb26bb6f9d25"]
}, Closed]],

Cell[CellGroupData[{

Cell["OPTION 2: Automatic Correction Intervals", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, {3.88962249911553*^9, 3.8896225193161316`*^9}, 
   3.8896234870902314`*^9, {3.915222523970116*^9, 3.9152225455522757`*^9}, {
   3.9156234200790715`*^9, 3.915623424078086*^9}, {3.9417963491908474`*^9, 
   3.9417963844448833`*^9}},ExpressionUUID->"f5ba4b31-0e18-4925-98f0-\
95e8a6891566"],

Cell["\<\
Defaults :
   
useCTM=0;   <<   0 or 1
regularizationMSE=0.025;
sigmaLaplacianMSE=15;
thresholdLaplacianMSE=0.025;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, {3.905446106002844*^9, 3.9054461063221574`*^9}, 
   3.912238906748783*^9, 3.912247697133684*^9, {3.9122477658867474`*^9, 
   3.9122477785803137`*^9}, 3.9152128103077116`*^9, {3.9273077945637145`*^9, 
   3.927307797830636*^9}, {3.9273104799980865`*^9, 3.927310482909319*^9}, 
   3.9418630090285406`*^9},
 FontSize->16,ExpressionUUID->"27962eb2-7eab-428b-9cd2-b471c9a65d4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"useCTM", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regularizationMSE", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigmaLaplacianMSE", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thresholdLaplacianMSE", "=", "0.025"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9418628420940495`*^9, 3.9418628611835203`*^9}, {
  3.94186291001168*^9, 3.9418629514656553`*^9}, {3.9418629827648754`*^9, 
  3.941862983408926*^9}},ExpressionUUID->"09a3ae84-7d2b-4ab5-910d-\
136bc7180d02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"croppedImagePixelCount", "=", 
   RowBox[{"Times", "@@", 
    RowBox[{"ImageDimensions", "@", 
     RowBox[{"First", "@", "images"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"imageSequenceMSE", "=", 
    RowBox[{"MovingMap", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"getImageMSE", "@@", "#"}], "&"}], ",", "images", ",", "1"}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.941784005527834*^9, 3.9417840285886097`*^9}, {
  3.9417845227980947`*^9, 3.941784535551156*^9}, {3.9417964517974033`*^9, 
  3.941796481066365*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"46ff3fe9-3157-42b4-902f-da481bdcf34b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"imageSequenceMSEfiltered", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"TotalVariationFilter", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", "regularizationMSE", ",", 
        RowBox[{"Method", "\[Rule]", "\"\<Gaussian\>\""}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], "@", 
     RowBox[{"Rescale", "@", "imageSequenceMSE"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"imageSequenceMSElaplacian", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Rescale", "@", 
       RowBox[{"Abs", "@", 
        RowBox[{"DerivativeFilter", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "2", "}"}], ",", "sigmaLaplacianMSE"}], "]"}]}]}], 
      "&"}], "@", "imageSequenceMSEfiltered"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"imageSequenceMSEfiltered", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"imageSequenceMSElaplacian", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], "\[IndentingNewLine]", 
   "}"}], "//", 
  RowBox[{
   RowBox[{"ImageCollage", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Background", "\[Rule]", "None"}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", "10"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9417845592794547`*^9, 3.941784629338411*^9}, {
   3.9417861150478706`*^9, 3.941786116830711*^9}, {3.941789085873032*^9, 
   3.9417890953971167`*^9}, {3.941796425192733*^9, 3.9417964453171177`*^9}, {
   3.9417965266224365`*^9, 3.9417966314307823`*^9}, {3.941862890814104*^9, 
   3.9418628965718803`*^9}, 
   3.941862934022066*^9},ExpressionUUID->"bfc0f7fa-7303-4b4c-b24b-\
838e448a3f7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"peaksMSElaplacian", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"FindPeaks", "[", 
       RowBox[{"#", ",", "0", ",", "0", ",", "thresholdLaplacianMSE"}], "]"}],
       "&"}], "@", "imageSequenceMSElaplacian"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Show", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imageSequenceMSElaplacian", "//", 
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"#", ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], "&"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"peaksMSElaplacian", "//", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{"#", ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], "&"}]}]}], 
   "\[IndentingNewLine]", "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9417892411259947`*^9, 3.9417893126193647`*^9}, {
   3.941789397185235*^9, 3.941789424792769*^9}, {3.9417894930101805`*^9, 
   3.941789501338168*^9}, {3.941789534885558*^9, 3.9417895686740465`*^9}, {
   3.941789605026112*^9, 3.9417896496922283`*^9}, 3.941796654271777*^9, 
   3.9418630442305064`*^9},ExpressionUUID->"76038322-d853-430c-af3b-\
7f26e50dc209"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"peakPositionsMSElaplacian", "=", 
    RowBox[{"First", "@", 
     RowBox[{"Transpose", "@", "peaksMSElaplacian"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"meanCorrectionInvervalsAutomatic", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Catenate", "[", 
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Last", "@", "peakPositionsMSElaplacian"}], ";;", "All"}], 
          "}"}]}], "}"}], "]"}], "&"}], "@", 
     RowBox[{"MovingMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#1", ";;", 
           RowBox[{"#2", "-", "1"}]}], "&"}], "@@", "#"}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Catenate", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "peakPositionsMSElaplacian", ",", 
          RowBox[{"{", "All", "}"}]}], "}"}]}], ",", "2"}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"meanCorrectionInvervalsAutomatic", "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", 
  "meanCorrectionInvervalsAutomatic"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "meanCorrectionInvervals", "=", "meanCorrectionInvervalsAutomatic"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.941789854080764*^9, 3.9417898683719225`*^9}, {
  3.9417899331224737`*^9, 3.941789943354399*^9}, {3.9417966596857758`*^9, 
  3.9417966873173127`*^9}, {3.9418629898131714`*^9, 
  3.9418629964286766`*^9}},ExpressionUUID->"23cdcb8b-2164-4805-9f34-\
dfe88e5182eb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Processing Cell", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, {3.88962249911553*^9, 3.8896225193161316`*^9}, 
   3.8896234870902314`*^9, {3.915222523970116*^9, 3.9152225455522757`*^9}, {
   3.9156234200790715`*^9, 3.915623424078086*^9}, {3.9417963491908474`*^9, 
   3.9417963968285503`*^9}},ExpressionUUID->"e16f5a56-9ee3-4470-8084-\
1c59a81d0b83"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"meanImages", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Mean", "@", 
       RowBox[{"images", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
     "meanCorrectionInvervals"}]}], ";"}], "//", "AbsoluteTiming"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"imagesCorrected", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"monitorCounter", "++"}], ";", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"useCTM", "\[Equal]", "1"}], ",", 
                   RowBox[{"ColorToneMapping", "@", "#"}], ",", "#"}], 
                  "\[IndentingNewLine]", "]"}], "&"}], "@", 
                RowBox[{"meanFlattening", "[", "\[IndentingNewLine]", 
                 RowBox[{"#", ",", 
                  RowBox[{"meanImages", "[", 
                   RowBox[{"[", "interval", "]"}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"images", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
             RowBox[{"meanCorrectionInvervals", "[", 
              RowBox[{"[", "interval", "]"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"interval", ",", "1", ",", 
            RowBox[{"Length", "@", "meanCorrectionInvervals"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", " ", "@", 
        RowBox[{"Flatten", "@", "images"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"imagesCorrectedInverted", "=", 
    RowBox[{"ColorNegate", "/@", "imagesCorrected"}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.901006633221992*^9, 3.901006667139427*^9}, {
   3.901006864591977*^9, 3.901006870859763*^9}, {3.901008471516359*^9, 
   3.9010084730918007`*^9}, 3.901009766814474*^9, {3.9010111873060517`*^9, 
   3.901011224222026*^9}, {3.901014409537009*^9, 3.901014412680328*^9}, {
   3.9011086035778236`*^9, 3.901108604234493*^9}, {3.9054461559104557`*^9, 
   3.9054461771848984`*^9}, {3.9054499547822285`*^9, 3.905449957984293*^9}, {
   3.9054546046945686`*^9, 3.905454605965007*^9}, {3.9054549303040867`*^9, 
   3.905454930734278*^9}, {3.9054564160961485`*^9, 3.9054564637111464`*^9}, {
   3.9072197883281517`*^9, 3.9072198549221554`*^9}, 3.9122475620653467`*^9, {
   3.9122478036057906`*^9, 3.912247816980792*^9}, {3.9122478601644373`*^9, 
   3.912247923046756*^9}, {3.9122484416896076`*^9, 3.9122484443174477`*^9}, {
   3.9123512515235133`*^9, 3.9123512521095085`*^9}, {3.91251906693609*^9, 
   3.9125190707055173`*^9}, {3.912519822664545*^9, 3.9125199049494123`*^9}, {
   3.9125199410200586`*^9, 3.9125199416566133`*^9}, {3.9126115412749686`*^9, 
   3.9126115422871323`*^9}, {3.912678879162035*^9, 3.91267888012951*^9}, {
   3.9152121691083593`*^9, 3.9152121744804106`*^9}, {3.9152123568371325`*^9, 
   3.915212371574143*^9}, {3.9152125057911596`*^9, 3.915212514924588*^9}, {
   3.9152125620130444`*^9, 3.9152126306145363`*^9}, {3.915212855269752*^9, 
   3.91521285633385*^9}, {3.9152129870797415`*^9, 3.915212991917593*^9}, {
   3.9152190041469245`*^9, 3.9152190051644325`*^9}, {3.9156236747984447`*^9, 
   3.915623701430708*^9}, 3.915623733855213*^9, {3.9273078157765822`*^9, 
   3.927307845062628*^9}, {3.938744878655035*^9, 3.9387449032932014`*^9}, 
   3.9417843460489025`*^9, 3.9417843794539804`*^9},
 CellLabel->
  "In[128]:=",ExpressionUUID->"9efec952-6389-4b3d-a5a7-ce72a9be9bc7"],

Cell["\<\
Defaults :
   
rotationSwitch=0;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, {3.905446106002844*^9, 3.9054461063221574`*^9}, 
   3.912238906748783*^9, 3.912247697133684*^9, {3.9122477658867474`*^9, 
   3.9122477785803137`*^9}, 3.9152128103077116`*^9, {3.915735426973412*^9, 
   3.915735428618227*^9}},
 FontSize->16,ExpressionUUID->"3e4272f9-40b7-4687-82c6-e9b7d57619ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rotationSwitch", "=", "0"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.915219968329245*^9, 3.915219971124776*^9}, 
   3.9170389843330607`*^9, {3.917039091865298*^9, 3.9170391215233784`*^9}, {
   3.917042368741626*^9, 3.917042371997611*^9}, {3.917467302995442*^9, 
   3.9174673030990734`*^9}, {3.917697537806245*^9, 3.9176975390543237`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"cb24941b-fc44-4423-adf4-0c0481e177d6"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rotateImage", "@", 
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"imagesCorrected", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "imagesCorrected"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.915213341325284*^9, 3.9152133687807274`*^9}, {
   3.9152199805850906`*^9, 3.915219981061466*^9}, 3.915647315959836*^9, {
   3.917042369955835*^9, 3.917042372182444*^9}, {3.9273076935119314`*^9, 
   3.927307695646968*^9}, {3.927307736482185*^9, 3.9273077366154385`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"6989c541-20e6-44bc-9a0e-0a82cb16a3b3"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Image Stack Projections", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.9000526874012403`*^9, 
   3.90005270283136*^9}},
 FontSize->24,ExpressionUUID->"8c67e410-e8ef-4028-91ec-9a1fe745b787"],

Cell["\<\
Defaults :
   
checkupIDs=1;;All;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9},
 FontSize->16,ExpressionUUID->"a882c9bf-f789-44c4-a104-23816baa6891"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkupIDs", "=", 
   RowBox[{"1", ";;", "All"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQzfLsPP+VT28cD325LgiiYxYHy4FouVkZYNpuo6kW
iH6neUYbRDcbPZkLopkn8iwF0TN+TD/0//cbxwVb1h8D0V1NamdBtJx5FZjm
C7Yuk/3zxlGz9DCYLtMNY9L9+8axz2Y7mBZYJcG5h/2tI7fYYTD9I6xnxx0g
rTv16X4QrcG/hOkukP7SvgZMHysv8ALRJnPngmk/5j0SB/neOt61yJMB0R83
HtYF0RafzoJp39OdM7jF3jpeMNsCpn/dEXnBA6TP7ngFpqWmbW/gB9KHzJ6D
ad4tge93OwHNzRX8BKI3OZd+A9HlT+rB9Ly0d/x7gPQxni9g+omukBiITtgt
A6YBJwewhA==
  "],
 CellLabel->
  "In[133]:=",ExpressionUUID->"d9ccee59-67aa-4520-8ce3-7f6d1611964b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"imageStack", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Image", "[", 
        RowBox[{
         RowBox[{"ColorCombine", "@", "#"}], ",", "\"\<Byte\>\""}], "]"}], 
       "&"}], "@", 
      RowBox[{"imagesCorrected", "[", 
       RowBox[{"[", "checkupIDs", "]"}], "]"}]}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToString", "@", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"ByteCount", "@", "imageStack"}], "/", 
      RowBox[{"1024", "^", "3"}]}], "]"}]}], "<>", "\"\< Gb\>\""}], "//", 
  "Print"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"memoryCheck", "[", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"imageForms", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Image", "[", 
        RowBox[{"#", ",", "Byte"}], "]"}], "&"}], "/@", 
      RowBox[{"ImageAdjust", "/@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ImageApply", "[", 
           RowBox[{"#", ",", "imageStack"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"Max", ",", "Min", ",", "Mean", ",", "StandardDeviation"}], 
          "}"}]}], "\[IndentingNewLine]", ")"}]}]}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"plotImageForms", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ImageAdjust", "@", 
       RowBox[{"rotateImage", "@", "#"}]}], "&"}], "/@", "imageForms"}], "//", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"GraphicsGrid", "[", 
     RowBox[{"#", ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"Scaled", "@", "1"}]}], ",", 
      RowBox[{"Spacings", "\[Rule]", "10"}], ",", 
      RowBox[{"Dividers", "\[Rule]", "All"}]}], "]"}], "&"}]}]}]}], "Input",
 CellChangeTimes->{{3.885408382496828*^9, 3.8854083987486277`*^9}, {
   3.8854084986136913`*^9, 3.885408499268813*^9}, {3.885408593677886*^9, 
   3.8854086063801184`*^9}, {3.885409519131166*^9, 3.8854095763927016`*^9}, {
   3.890216468749096*^9, 3.890216501490799*^9}, {3.890216553203435*^9, 
   3.890216555819228*^9}, {3.8902772978538885`*^9, 3.890277302108052*^9}, {
   3.8908334266930494`*^9, 3.890833429726142*^9}, {3.8963692247707596`*^9, 
   3.896369230096441*^9}, {3.8964361643856163`*^9, 3.8964363299489517`*^9}, {
   3.8964363877439537`*^9, 3.8964365422773743`*^9}, {3.896436599043357*^9, 
   3.8964366370728083`*^9}, {3.8964366671448145`*^9, 3.89643673724588*^9}, {
   3.8964367773351607`*^9, 3.896436778740844*^9}, {3.8964368224816637`*^9, 
   3.896436875022439*^9}, {3.8964369825451965`*^9, 3.8964370098803487`*^9}, {
   3.896437198809002*^9, 3.8964371998180475`*^9}, {3.8997967835223236`*^9, 
   3.8997968038311157`*^9}, 3.900049556846547*^9, 3.9000495878225255`*^9, {
   3.900049927550164*^9, 3.9000499301872807`*^9}, {3.9000524030988083`*^9, 
   3.900052459220603*^9}, {3.900052946488269*^9, 3.900053000567629*^9}, {
   3.9000530588317966`*^9, 3.900053076416273*^9}, {3.9000535057131596`*^9, 
   3.900053553985704*^9}, 3.9006905730041084`*^9, {3.903870523971698*^9, 
   3.9038705264684143`*^9}, {3.9038722028511324`*^9, 
   3.9038722056011515`*^9}, {3.915213134623252*^9, 3.9152131350529423`*^9}, {
   3.9152132745888057`*^9, 3.915213278833434*^9}, {3.9152169193436565`*^9, 
   3.91521692086901*^9}, {3.9152169602013693`*^9, 3.915216960637602*^9}, 
   3.915220032727638*^9, {3.9152204957620707`*^9, 3.9152204975454235`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"bfd2b433-fc8c-43ed-99fd-144dcc38119a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"subFolder", ",", 
       RowBox[{"$PathnameSeparator", "\[Rule]", " ", "\"\<_\>\""}]}], "]"}], 
     "<>", "\"\<max_min_projections_ALL.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "plotImageForms", ",", 
    RowBox[{"CompressionLevel", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.917039114410836*^9, 3.91703911518637*^9}, {
  3.927537993243611*^9, 3.927537993971609*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"4ceeeabf-ea97-4992-909f-58aa55e1d6eb"],

Cell[BoxData[{
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{"{", 
     RowBox[{"imageStack", ",", "checkupIDs"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{3.9275377823231134`*^9},
 CellLabel->
  "In[139]:=",ExpressionUUID->"205f8358-d959-445b-8cbb-ad8732d67c81"]
}, Closed]],

Cell[CellGroupData[{

Cell["Detect & Remove Artifacts", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.9000526874012403`*^9, 
   3.90005270283136*^9}, {3.915217858610118*^9, 3.915217868724546*^9}},
 FontSize->24,ExpressionUUID->"11e09dc4-7b2d-42be-82f1-0ad5ee354cf1"],

Cell[CellGroupData[{

Cell["Get Artifact Mask", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.900684062023316*^9, 3.900684070806832*^9}, {3.9157354864495544`*^9, 
  3.9157354903315687`*^9}},ExpressionUUID->"241bb69c-deed-41e9-a9fc-\
946c007e235d"],

Cell["\<\
Defaults :
   
meanImageExponent=2;
artifactThreshold=0.7;
artifactDilationScale=5;

referenceImage=meanImages[[1]];
*OR*
referenceImage=imageForms//Last//ColorNegate;

Binarize: artifactThreshold    *OR*   \
Method\[Rule]\[CloseCurlyDoubleQuote]Entropy\[CloseCurlyDoubleQuote] 
Binarize *OR* MorphologicalBinarize\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, {
   3.91564898917279*^9, 3.915648991480487*^9}, {3.91564929290452*^9, 
   3.915649305161154*^9}, {3.9170379860836067`*^9, 3.9170379874926543`*^9}, {
   3.9170380311307683`*^9, 3.917038051532672*^9}, 3.9170390320506215`*^9, {
   3.9170422407462006`*^9, 3.917042242242494*^9}, {3.951823447741883*^9, 
   3.951823474870111*^9}},
 FontSize->16,ExpressionUUID->"8fef5d3f-6780-4f1c-aee6-ba385dd5683f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meanImageExponent", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"artifactThreshold", "=", "0.3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"artifactDilationScale", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"artifactClosingScale", "=", "25"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9152178935540094`*^9, 3.915217938829035*^9}, 
   3.9152195098686657`*^9, {3.915638525250185*^9, 3.9156385331030674`*^9}, {
   3.915647434986148*^9, 3.9156474366494584`*^9}, {3.9156487959288635`*^9, 
   3.9156488014321766`*^9}, {3.915648859992628*^9, 3.9156488713215284`*^9}, {
   3.915648949440136*^9, 3.9156489598881426`*^9}, {3.915649043808476*^9, 
   3.9156491338091764`*^9}, {3.9156492024245167`*^9, 3.915649232583452*^9}, {
   3.915649280859949*^9, 3.915649281038975*^9}, {3.9170062982327776`*^9, 
   3.9170063195531816`*^9}, {3.9170063633370643`*^9, 
   3.9170063635639772`*^9}, {3.91700645103277*^9, 3.9170064518580885`*^9}, {
   3.9170228867955074`*^9, 3.917022891466732*^9}, 3.917034536074762*^9, 
   3.9170379197396283`*^9, {3.917038062156543*^9, 3.917038081548726*^9}, {
   3.9170390428594413`*^9, 3.9170390582762003`*^9}, 3.91704222338303*^9, {
   3.9170424648677464`*^9, 3.9170424649555054`*^9}, {3.917097798143059*^9, 
   3.917097800238846*^9}, 3.917467597735715*^9, {3.9174677078370934`*^9, 
   3.9174677140274425`*^9}, 3.9174679072832317`*^9, {3.9174684705085316`*^9, 
   3.917468507048034*^9}, {3.9273019962321224`*^9, 3.927302002792281*^9}, {
   3.927308865395535*^9, 3.9273088734229374`*^9}, {3.927519286223515*^9, 
   3.9275192961817656`*^9}, {3.9275383056354775`*^9, 3.9275384024263334`*^9}, 
   3.92754434165086*^9, {3.95172981277029*^9, 3.9517298317046785`*^9}, {
   3.9518233891344705`*^9, 3.951823430870078*^9}, {3.951823482073331*^9, 
   3.9518235288057504`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"b12395dd-321d-45a0-af32-783f05c262a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"referenceImage", "=", 
    RowBox[{
     RowBox[{"imageForms", "//", "Last"}], "//", "ColorNegate"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"artifactMask", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Closing", "[", 
              RowBox[{"#", ",", "artifactClosingScale"}], "]"}], "&"}], "@", 
            RowBox[{"Dilation", "[", 
             RowBox[{"#", ",", 
              RowBox[{"DiskMatrix", "@", "artifactDilationScale"}]}], "]"}]}],
            "&"}], "@", "\[IndentingNewLine]", 
          RowBox[{"MorphologicalBinarize", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Entropy\>\""}]}], "]"}]}], 
         "&"}], "@", 
        RowBox[{"ImageAdjust", "@", "#"}]}], "^", "meanImageExponent"}], 
      "&"}], "@", 
     RowBox[{"ColorNegate", "@", "referenceImage"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Image", "[", 
     RowBox[{"#", ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"Scaled", "@", "0.75"}]}]}], "]"}], "&"}], "@", 
   RowBox[{"rotateImage", "@", 
    RowBox[{"getMaskOverlays", "[", 
     RowBox[{
      RowBox[{"ColorNegate", "@", "referenceImage"}], ",", "artifactMask", 
      ",", "Red", ",", "2"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Image", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"Scaled", "@", "0.75"}]}]}], "]"}], "&"}], "@", 
  RowBox[{"rotateImage", "@", 
   RowBox[{"getMaskOverlays", "[", 
    RowBox[{
     RowBox[{"First", "@", "imagesCorrected"}], ",", "artifactMask", ",", 
     "Red", ",", "2"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.91521729459333*^9, 3.9152173191281977`*^9}, {
   3.9152173593589716`*^9, 3.9152173638525763`*^9}, {3.91521741047466*^9, 
   3.9152174257250566`*^9}, {3.915217672967381*^9, 3.915217748434947*^9}, {
   3.915217877196898*^9, 3.915217887585326*^9}, {3.9152179427027807`*^9, 
   3.9152179615467706`*^9}, {3.915219865967743*^9, 3.915219890812423*^9}, {
   3.9152200447121253`*^9, 3.9152200563200483`*^9}, {3.9152201496413774`*^9, 
   3.9152201736047697`*^9}, {3.915638540792364*^9, 3.9156385882390246`*^9}, {
   3.915647405664565*^9, 3.915647467522088*^9}, 3.9156487918098497`*^9, {
   3.9156488515780993`*^9, 3.9156489159278774`*^9}, {3.9156490347864695`*^9, 
   3.9156491023199987`*^9}, {3.9156491415514517`*^9, 3.915649151879829*^9}, {
   3.9156491821402445`*^9, 3.9156491980233946`*^9}, {3.917037981053522*^9, 
   3.9170379912150555`*^9}, {3.917038022069355*^9, 3.91703802372418*^9}, {
   3.9170390270523806`*^9, 3.9170390350301876`*^9}, 3.917042228246339*^9, {
   3.9170423981895933`*^9, 3.9170424027322617`*^9}, 3.91704246002818*^9, 
   3.917097784665715*^9, {3.917467582510832*^9, 3.917467589771335*^9}, {
   3.9174676232701406`*^9, 3.917467628540633*^9}, {3.91746766472563*^9, 
   3.9174676856649184`*^9}, {3.927301985480592*^9, 3.927301993577761*^9}, {
   3.927308851247285*^9, 3.9273088626008615`*^9}, {3.9275192676640606`*^9, 
   3.9275192841718473`*^9}, 3.941783156054347*^9, {3.9418641540003495`*^9, 
   3.9418641612451606`*^9}, {3.9517298521242714`*^9, 3.951729882552438*^9}, {
   3.9517433452766504`*^9, 3.95174335466387*^9}, {3.95182339979167*^9, 
   3.951823427754304*^9}, {3.951823579913227*^9, 3.951823631868047*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"1cd5a62c-1f4d-4297-9814-f40a8aa0f182"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Artifact Removal ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.900684062023316*^9, 3.900684070806832*^9}, {3.9157354864495544`*^9, 
  3.9157355039696646`*^9}},ExpressionUUID->"bf33ffca-ff4d-4605-98fe-\
dc908820c9da"],

Cell["\<\
Defaults :
   
inpaintMaxSamples=50;
inpaintSampleRange=150;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, {
   3.91564898917279*^9, 3.915648991480487*^9}, {3.91564929290452*^9, 
   3.915649305161154*^9}, 3.915735461282357*^9},
 FontSize->16,ExpressionUUID->"65eec531-3915-4be4-b1e0-7dcc18524bed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inpaintMaxSamples", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inpaintSampleRange", "=", "150"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.915219366370877*^9, 3.9152193819648542`*^9}, 
   3.915219660150524*^9, {3.9152197643551846`*^9, 3.915219803893874*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"1c8edb82-0058-4b9c-8ead-445ff4660900"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "/@", 
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{"inpaintImageArtifacts", "[", 
         RowBox[{"#", ",", "artifactMask"}], "]"}]}], "}"}]}], "&"}], "@", 
    RowBox[{"imagesCorrected", "[", 
     RowBox[{"[", "testID", "]"}], "]"}]}], "//", 
   RowBox[{
    RowBox[{"GraphicsColumn", "[", 
     RowBox[{"#", ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"Scaled", "@", "0.75"}]}]}], "]"}], "&"}]}], "//", 
  "rotateImage"}]}], "Input",
 CellChangeTimes->{{3.915219398999742*^9, 3.91521943340621*^9}, {
   3.9152194647546053`*^9, 3.9152194723766937`*^9}, {3.9152195221758547`*^9, 
   3.915219646901524*^9}, {3.915219688446493*^9, 3.9152197423366528`*^9}, {
   3.915219816991393*^9, 3.915219841556361*^9}, {3.915220071360787*^9, 
   3.915220091287958*^9}, {3.9152201814700766`*^9, 3.915220182835864*^9}, {
   3.9156488237847023`*^9, 3.915648835326248*^9}, 3.9156492464099445`*^9, 
   3.9170064251284604`*^9, {3.917006477354382*^9, 3.917006477834961*^9}, 
   3.917006563435007*^9, 3.917024478166154*^9, 3.9170345495258813`*^9, 
   3.9170379328828764`*^9, {3.9170381005960636`*^9, 3.917038101594898*^9}, {
   3.9170391473791637`*^9, 3.917039148312668*^9}, {3.917042479660393*^9, 
   3.917042479874668*^9}, {3.917467445308707*^9, 3.917467446720052*^9}, {
   3.9273089376714306`*^9, 3.9273089557841077`*^9}, {3.9518238031680346`*^9, 
   3.951823832742337*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"b20790f2-27b9-4ce8-9d0d-ead93ff5cf67"]
}, Closed]],

Cell[CellGroupData[{

Cell["Processing Cell", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.900684062023316*^9, 3.900684070806832*^9}, {3.9157354864495544`*^9, 
  3.9157355118102837`*^9}, {3.917043137836152*^9, 
  3.9170431566783648`*^9}},ExpressionUUID->"f87cb3e8-c62c-4217-b3e2-\
faa8ab2130c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"imagesClean", "=", 
       RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"inpaintImageArtifacts", "[", 
             RowBox[{"#", ",", "artifactMask"}], "]"}]}], ")"}], "&"}], ",", 
         "imagesCorrected"}], "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "imagesCorrected"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"imagesCleanInverted", "=", 
       RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"inpaintImageArtifacts", "[", 
             RowBox[{"#", ",", "artifactMask"}], "]"}]}], ")"}], "&"}], ",", 
         "imagesCorrectedInverted"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
     ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "imagesCorrectedInverted"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imagePairs", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"imagesClean", ",", "imagesCleanInverted"}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.900684062023316*^9, 3.900684070806832*^9}, {3.9157354864495544`*^9, 
  3.9157355118102837`*^9}, {3.917043137836152*^9, 3.91704315201867*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"5af96644-784d-4732-b0ca-008f19fadd5a"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bacteria Detection", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9157398682196226`*^9, 3.915739874772149*^9}},
 FontSize->24,ExpressionUUID->"b50be401-c600-4e4b-acc1-e4229cbd348a"],

Cell[CellGroupData[{

Cell["Bacteria Detection", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.900684062023316*^9, 3.900684070806832*^9}, {3.912519021184183*^9, 
   3.912519026311293*^9}, 
   3.912604787539379*^9},ExpressionUUID->"ea3c928b-d6a6-465a-b2de-\
69af703d8ee8"],

Cell[CellGroupData[{

Cell["[[ Preview Bacteria Detection ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.900684062023316*^9, 
  3.900684070806832*^9}},ExpressionUUID->"528ac027-0049-4b08-ae8f-\
818cdc7130ac"],

Cell["\<\
Parameters:

usePreprocessing (0 or 1)
totalVariationRegularization
luminanceCompression
SCTMMiterations
useMaxFilter (0 or 1)
maxFilterScale
sizeThresholdMin
sizeThresholdMax

parameterSetsDefault={
{1,0.70,0.75,3,1,1,1,10^4},
{1,0.70,0.75,3,1,1,1,10^4}
}

selectedLevelSets={1,2};  <<  {1} , {2} or {1,2}
segmentationMethod=\[CloseCurlyDoubleQuote]Cluster\[CloseCurlyDoubleQuote];  \
<<  \[CloseCurlyDoubleQuote]Cluster\[CloseCurlyDoubleQuote], \
\[CloseCurlyDoubleQuote]Entropy\[CloseCurlyDoubleQuote], \
\[CloseCurlyDoubleQuote]MinimumError\[CloseCurlyDoubleQuote]\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, {3.9007447255947275`*^9, 
   3.9007447329125357`*^9}, {3.9007510079302044`*^9, 3.900751019869511*^9}, 
   3.900754841161171*^9, {3.901007424695047*^9, 3.9010074247349405`*^9}, {
   3.9010133853288727`*^9, 3.9010133881235223`*^9}, {3.90101357433154*^9, 
   3.901013584833224*^9}, 3.9010147680984592`*^9, {3.901175219187384*^9, 
   3.9011752289336367`*^9}, {3.9123603874487004`*^9, 
   3.9123603916504335`*^9}, {3.9125178058652887`*^9, 
   3.9125178068086944`*^9}, {3.912524580856205*^9, 3.9125246357474775`*^9}, {
   3.9125335197856674`*^9, 3.9125335543941708`*^9}, {3.912533608513541*^9, 
   3.9125336349043856`*^9}, {3.9126148805695157`*^9, 
   3.9126148958583384`*^9}, {3.951731310059925*^9, 3.9517313378987684`*^9}},
 FontSize->16,ExpressionUUID->"9e4dc657-80bd-4756-8c14-f50b743eef7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"parameterSets", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "1", ",", "0.35", ",", "0.75", ",", "2", ",", "1", ",", "1", ",", "5", 
        ",", 
        RowBox[{"10", "^", "4"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "0.325", ",", "0.75", ",", "0", ",", "1", ",", "1", ",", "5",
         ",", 
        RowBox[{"10", "^", "4"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedLevelSets", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"segmentationMethod", "=", "\"\<Entropy\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedParameterSets", "=", 
   RowBox[{"parameterSets", "[", 
    RowBox[{"[", "selectedLevelSets", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9123413269457207`*^9, 3.91234139310739*^9}, {
   3.912347736836733*^9, 3.912347740058017*^9}, {3.9125246732884336`*^9, 
   3.9125246765311394`*^9}, {3.912524707089677*^9, 3.912524723943384*^9}, {
   3.9125248805888677`*^9, 3.9125248835403504`*^9}, {3.9125251176879077`*^9, 
   3.91252512337776*^9}, {3.9125251672239203`*^9, 3.9125251815752*^9}, {
   3.9125252538502765`*^9, 3.912525280192871*^9}, {3.91252534969893*^9, 
   3.912525349791688*^9}, {3.9125324385607615`*^9, 3.9125324626023197`*^9}, {
   3.9125333392082553`*^9, 3.9125333630640664`*^9}, {3.9125335153865795`*^9, 
   3.912533515497484*^9}, 3.9125335766977334`*^9, {3.912533637248309*^9, 
   3.912533644136549*^9}, {3.9125337918564157`*^9, 3.9125338038098645`*^9}, {
   3.9125353371374474`*^9, 3.912535337223445*^9}, {3.9125799178054857`*^9, 
   3.912579924021828*^9}, {3.9125981090353146`*^9, 3.912598127668589*^9}, {
   3.91259836964283*^9, 3.9125983697136393`*^9}, 3.912598995474905*^9, {
   3.9125993809567537`*^9, 3.9125993810259933`*^9}, 3.912599434957644*^9, {
   3.9126008602507396`*^9, 3.912600892973993*^9}, 3.9126009624507437`*^9, 
   3.912610552036352*^9, {3.9126116514111805`*^9, 3.912611658329726*^9}, {
   3.912676667801752*^9, 3.912676738641365*^9}, {3.912676964144347*^9, 
   3.912676987184247*^9}, 3.9126892740215874`*^9, {3.9152210177263174`*^9, 
   3.9152210178779445`*^9}, {3.915221103521932*^9, 3.9152211041815753`*^9}, {
   3.9152211454223456`*^9, 3.9152212416977725`*^9}, {3.9156244470629063`*^9, 
   3.9156244705495157`*^9}, {3.917006842547847*^9, 3.91700687644096*^9}, {
   3.917007014284266*^9, 3.9170070153905797`*^9}, {3.9170101748587613`*^9, 
   3.917010193192026*^9}, {3.917010226754285*^9, 3.9170102293763027`*^9}, {
   3.917010290506646*^9, 3.917010291873005*^9}, {3.9170103954754047`*^9, 
   3.9170104093764305`*^9}, {3.9170245294921274`*^9, 3.917024598722475*^9}, {
   3.9170263900921183`*^9, 3.917026436034015*^9}, {3.9170264901574354`*^9, 
   3.9170264927579365`*^9}, {3.9170265392822127`*^9, 3.917026694345416*^9}, {
   3.9170279640914803`*^9, 3.9170280280740943`*^9}, {3.9170281109234376`*^9, 
   3.9170281422914586`*^9}, {3.917028172929891*^9, 3.9170281908343225`*^9}, {
   3.9170282510278797`*^9, 3.917028264789674*^9}, {3.917028391196042*^9, 
   3.917028393209445*^9}, {3.9170285074903517`*^9, 3.917028585761413*^9}, {
   3.9170286473966303`*^9, 3.9170291414505653`*^9}, {3.917029175387112*^9, 
   3.9170294145862007`*^9}, {3.917029995326202*^9, 3.917030001861329*^9}, {
   3.917030595003338*^9, 3.9170306292456264`*^9}, {3.9170306637789717`*^9, 
   3.9170309999417253`*^9}, {3.91703103616259*^9, 3.917031935930911*^9}, {
   3.9170319911830397`*^9, 3.9170325321193333`*^9}, 3.9170325726847343`*^9, {
   3.917032665955182*^9, 3.917032727939824*^9}, {3.917038379830864*^9, 
   3.9170384205630245`*^9}, {3.917038472796158*^9, 3.917038518188674*^9}, {
   3.91704227616313*^9, 3.917042276482277*^9}, {3.917467819625489*^9, 
   3.917467825543665*^9}, {3.9273046728990393`*^9, 3.927304674671116*^9}, {
   3.927304762478476*^9, 3.927304771840065*^9}, {3.9517310260156813`*^9, 
   3.9517310310350876`*^9}, {3.951731297859682*^9, 3.95173130334634*^9}, {
   3.95173136863001*^9, 3.951731430373073*^9}, {3.9517315439805717`*^9, 
   3.951731548810788*^9}, 3.951743395922646*^9, 3.951743470899531*^9, 
   3.9517435187718453`*^9},
 CellLabel->
  "In[258]:=",ExpressionUUID->"b6452a88-a051-43e0-8781-18fda747bfcc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "100"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testFilteredImage", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getFilteredImage", "[", 
        RowBox[{
         RowBox[{"imagePairs", "[", 
          RowBox[{"[", 
           RowBox[{"testID", ",", "#1"}], "]"}], "]"}], ",", "#2"}], "]"}], 
       "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"selectedLevelSets", ",", "selectedParameterSets"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testSegmentedImage", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getSegmentedImage", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"testFilteredImage", ",", "selectedParameterSets"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"getMaskOverlays", "[", 
        RowBox[{"#1", ",", "#2", ",", 
         RowBox[{"Darker", "@", "Red"}], ",", "2"}], "]"}], "&"}], "@@", 
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}]}], "&"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"imagePairs", "[", 
       RowBox[{"[", 
        RowBox[{"testID", ",", "selectedLevelSets"}], "]"}], "]"}], ",", 
      "testSegmentedImage"}], "}"}]}], "\[IndentingNewLine]", "]"}], "//", 
  RowBox[{
   RowBox[{"GraphicsColumn", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "#"}], "\[Equal]", "1"}], ",", 
        RowBox[{"Scaled", "@", "0.5"}], ",", "Full"}], "]"}]}], ",", 
     RowBox[{"Spacings", "\[Rule]", "5"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9125250199067307`*^9, 3.912525035641487*^9}, {
   3.9125251106343327`*^9, 3.9125251327534637`*^9}, {3.912525194505927*^9, 
   3.912525237455516*^9}, {3.9125253000491524`*^9, 3.9125253046086345`*^9}, {
   3.9125253791633906`*^9, 3.9125254168656*^9}, {3.9125323197715783`*^9, 
   3.9125324310643477`*^9}, 3.912533082656074*^9, {3.9125331424040966`*^9, 
   3.9125331431610594`*^9}, {3.9125332014247046`*^9, 3.9125333244321446`*^9}, 
   3.9125333779458184`*^9, 3.912533527548021*^9, {3.9125799317267113`*^9, 
   3.912579965157013*^9}, {3.9125803163003883`*^9, 3.912580320223098*^9}, {
   3.9125994222110395`*^9, 3.9125994279143515`*^9}, {3.912600852084716*^9, 
   3.9126009202147903`*^9}, 3.912611653982051*^9, {3.9126117761799088`*^9, 
   3.9126118114417305`*^9}, {3.912612200037089*^9, 3.9126122574661803`*^9}, {
   3.912613570635603*^9, 3.9126135716899276`*^9}, {3.9126137288270035`*^9, 
   3.912613775210902*^9}, {3.912614099282467*^9, 3.9126141147474422`*^9}, {
   3.9126143557878075`*^9, 3.912614407898345*^9}, {3.9126145370271726`*^9, 
   3.9126145625548944`*^9}, {3.9126146633320656`*^9, 3.912614663426039*^9}, {
   3.912614976628431*^9, 3.912614993042457*^9}, {3.9126151111005774`*^9, 
   3.9126151113065596`*^9}, {3.9126151509239073`*^9, 
   3.9126151512902756`*^9}, {3.9126766775039644`*^9, 
   3.9126766779358673`*^9}, {3.912680259288624*^9, 3.912680259657342*^9}, {
   3.912689277536586*^9, 3.9126894483876247`*^9}, {3.915221038505649*^9, 
   3.9152210547413287`*^9}, {3.915221538422186*^9, 3.9152215385896535`*^9}, 
   3.9156273273678713`*^9, {3.9170068169555435`*^9, 3.917006817112342*^9}, {
   3.9170101609695735`*^9, 3.917010161777273*^9}, 3.917022921597513*^9, 
   3.917024515179907*^9, {3.9170264601991773`*^9, 3.917026476482839*^9}, 
   3.9170267051016655`*^9, 3.917027937091769*^9, 3.9170280103145833`*^9, {
   3.917028096404405*^9, 3.917028097985483*^9}, 3.9170281589157076`*^9, {
   3.917028204812052*^9, 3.917028227159032*^9}, 3.9170283419722395`*^9, {
   3.917029149907407*^9, 3.917029165306731*^9}, 3.917030581315092*^9, {
   3.917030615189141*^9, 3.917030615939497*^9}, {3.917030684804697*^9, 
   3.9170306899326134`*^9}, 3.9170310204771614`*^9, {3.917031299531152*^9, 
   3.9170313049636445`*^9}, {3.917031768545342*^9, 3.9170317725633583`*^9}, {
   3.9170319603801765`*^9, 3.9170319670751286`*^9}, {3.9170320189390187`*^9, 
   3.9170320196297874`*^9}, 3.9170324160432363`*^9, {3.917032651435383*^9, 
   3.9170326521303797`*^9}, {3.9170326933649535`*^9, 
   3.9170326938221254`*^9}, {3.9170327368120456`*^9, 3.917032746138461*^9}, 
   3.9170346061271424`*^9, {3.9170348198702126`*^9, 3.917034829619095*^9}, {
   3.917034880340078*^9, 3.9170348807728505`*^9}, 3.9170381083072243`*^9, {
   3.91703835052466*^9, 3.9170383675234346`*^9}, {3.9170384409983053`*^9, 
   3.917038466848111*^9}, 3.9170385317763004`*^9, {3.917038577166135*^9, 
   3.917038577378107*^9}, 3.9170391977745247`*^9, {3.917039233413846*^9, 
   3.917039234383579*^9}, {3.9170431806851797`*^9, 3.9170431812905574`*^9}, {
   3.9170991638155365`*^9, 3.9170991801286945`*^9}, {3.9174692006411705`*^9, 
   3.9174692012105975`*^9}, {3.9268638735693564`*^9, 3.9268638737198143`*^9}, 
   3.926864119584834*^9, {3.9273049037936363`*^9, 3.9273049043910055`*^9}, 
   3.927304949075265*^9, {3.9273103274966383`*^9, 3.9273103289900417`*^9}, 
   3.927310370074129*^9, {3.9273957264657307`*^9, 3.9273957265827*^9}, 
   3.927437193919753*^9, {3.941786906583845*^9, 3.9417869286871185`*^9}, {
   3.941787122680352*^9, 3.941787123046423*^9}, 3.9417871615841885`*^9, {
   3.951730826799535*^9, 3.951730827074963*^9}, {3.9517315225651875`*^9, 
   3.9517315243395*^9}, {3.95173160870253*^9, 3.95173160893906*^9}, 
   3.9517416953619404`*^9, {3.95174349347856*^9, 3.9517434939273605`*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"4cac5f0b-7824-430b-959f-03a21be2c4e1"],

Cell["*failed IDs*  ---> list here", "Abstract",
 CellChangeTimes->{
  3.901018142361174*^9, 3.90101825612871*^9, 3.901018467511054*^9, 
   3.901018577506609*^9, {3.901034223607523*^9, 3.9010342265034504`*^9}, 
   3.9010935185865116`*^9, {3.901102501775128*^9, 3.901102504918615*^9}, {
   3.9011026623275995`*^9, 3.9011026703337927`*^9}, {3.9011051326721616`*^9, 
   3.901105136320545*^9}, {3.9170392183536215`*^9, 
   3.9170392287630043`*^9}},ExpressionUUID->"eac501b9-3b2f-4983-bf61-\
92d465e040bc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Processing Cell", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 
  3.8887785266060743`*^9}},ExpressionUUID->"5287eeea-12b4-41aa-bb24-\
b299f23bae50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"imagesFiltered", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ParallelMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"monitorCounter", "++"}], ";", 
             RowBox[{"getFilteredImage", "[", 
              RowBox[{"#", ",", 
               RowBox[{"parameterSets", "[", 
                RowBox[{"[", "levelsetID", "]"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", ")"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "levelsetID", "]"}], "]"}], "&"}], "@", 
           RowBox[{"Transpose", "@", "imagePairs"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"levelsetID", ",", "selectedLevelSets"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{
       RowBox[{"Length", "@", "selectedLevelSets"}], "*", 
       RowBox[{"Length", "@", "imagePairs"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.912535383273624*^9, 3.912535397919273*^9}, {
  3.9125355015124283`*^9, 3.91253559869726*^9}, {3.912535660049216*^9, 
  3.912535663930852*^9}, {3.9125356941594257`*^9, 3.912535849401617*^9}, {
  3.912535922617731*^9, 3.9125359478478727`*^9}, {3.912540163248028*^9, 
  3.9125401699394608`*^9}, {3.9125803266762705`*^9, 3.9125803281534357`*^9}, {
  3.9125830293721676`*^9, 3.912583038293212*^9}, {3.912595447069509*^9, 
  3.912595451399393*^9}, {3.915221624127363*^9, 3.9152216266714735`*^9}, {
  3.917032754755056*^9, 3.9170327558662663`*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"ec68b82b-4fe4-41d5-ba27-4c9eddded434"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bacteriaMasks", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ParallelMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"monitorCounter", "++"}], ";", 
             RowBox[{"getSegmentedImage", "[", 
              RowBox[{"#", ",", 
               RowBox[{"parameterSets", "[", 
                RowBox[{"[", "levelsetID", "]"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", ")"}], "&"}], ",", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"selectedLevelSets", "\[Equal]", 
             RowBox[{"{", "2", "}"}]}], ",", 
            RowBox[{"First", "@", "imagesFiltered"}], ",", 
            RowBox[{"imagesFiltered", "[", 
             RowBox[{"[", "levelsetID", "]"}], "]"}]}], "\[IndentingNewLine]",
            "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"levelsetID", ",", "selectedLevelSets"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{
       RowBox[{"Length", "@", "selectedLevelSets"}], "*", 
       RowBox[{"Length", "@", "imagePairs"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.9125397146009707`*^9, 3.912539780873946*^9}, {
   3.912580330212392*^9, 3.9125803314251757`*^9}, {3.9125954323323402`*^9, 
   3.912595440424409*^9}, {3.9125997483165636`*^9, 3.9125997777865295`*^9}, 
   3.915221631392901*^9},
 CellLabel->
  "In[268]:=",ExpressionUUID->"89339474-5422-48fc-b2ff-d29334c02911"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Raw Bacteria Masks >>", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 
   3.915222540309099*^9}},ExpressionUUID->"6f01c45d-8e9d-4522-bda8-\
81d886133a7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"compressedRawBacteriaMasks", "=", 
     RowBox[{
      RowBox[{"Compress", "/@", 
       RowBox[{"Transpose", "@", "bacteriaMasks"}]}], "//", "Parallelize"}]}],
     ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rawBacteriaMaskFolder", "=", 
   RowBox[{"output", "<>", "\"\<2 Raw Bacteria Masks\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rawBacteriaMaskFolder", "//", "CreateDirectory"}], ";"}], "//", 
   "Quiet"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
    RowBox[{
    "compressedRawBacteriaMasks", ",", "rawBacteriaMaskFolder", ",", 
     "\"\<.txt\>\"", ",", "0"}], "\[IndentingNewLine]", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8892817493431044`*^9, 3.8892817805519447`*^9}, {
   3.889281837143244*^9, 3.88928191320846*^9}, {3.8892819594009056`*^9, 
   3.889281979209507*^9}, {3.8892821229194517`*^9, 3.8892821513839016`*^9}, {
   3.889621126101282*^9, 3.8896211918063293`*^9}, 3.8896214994948688`*^9, {
   3.8896215537218475`*^9, 3.889621561789811*^9}, {3.8896216430248423`*^9, 
   3.8896216457023907`*^9}, 3.8896216789445276`*^9, {3.8896220419612627`*^9, 
   3.8896220975531425`*^9}, {3.889623340867552*^9, 3.8896233411228905`*^9}, {
   3.8899819697164917`*^9, 3.889981979009638*^9}, 3.889982019469488*^9, {
   3.8899820760598574`*^9, 3.8899820783107395`*^9}, {3.890046229067525*^9, 
   3.890046277931983*^9}, {3.890527335932677*^9, 3.8905273362291927`*^9}, {
   3.899494914195033*^9, 3.8994949154990673`*^9}, {3.9152225301919775`*^9, 
   3.915222534823679*^9}, {3.9152225847640715`*^9, 3.9152226171491485`*^9}, {
   3.915223424822422*^9, 3.915223436343696*^9}, {3.9152234753578963`*^9, 
   3.915223478397222*^9}, {3.9152235935791206`*^9, 3.915223594570014*^9}, {
   3.9156276157991495`*^9, 3.9156276215439095`*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"cd332113-7721-4274-a73e-ef005b83d69a"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Raw Bacteria Masks <<", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, {3.88962249911553*^9, 3.8896225193161316`*^9}, 
   3.8896234870902314`*^9, {3.915222523970116*^9, 
   3.9152225455522757`*^9}},ExpressionUUID->"043b40e5-a83a-4eee-87f2-\
5039190f743b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rawBacteriaMaskFolder", "=", 
   RowBox[{"output", "<>", "\"\<2 Raw Bacteria Masks\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", "rawBacteriaMaskFolder"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bacteriaMasks", "=", 
     RowBox[{"Transpose", "@", 
      RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"Uncompress", "@", 
            RowBox[{"Import", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rawBacteriaMaskFolder", "<>", "#"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", "files"}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896225359098797`*^9, 3.8896226218372874`*^9}, {3.88962271829244*^9, 
   3.8896227275498905`*^9}, {3.889623134636578*^9, 3.889623137861703*^9}, {
   3.889623351635437*^9, 3.889623352090786*^9}, {3.8896235050986195`*^9, 
   3.889623534803034*^9}, 3.8899815513595295`*^9, {3.8901546653652105`*^9, 
   3.890154666131366*^9}, {3.8903837878670807`*^9, 3.8903837896332626`*^9}, {
   3.8903838511865406`*^9, 3.890383858398181*^9}, 3.8903839043715124`*^9, {
   3.890384135310108*^9, 3.890384146650017*^9}, {3.890386917039728*^9, 
   3.8903869187284775`*^9}, {3.8904093272504597`*^9, 3.890409333525776*^9}, 
   3.890409366183757*^9, {3.890527338154413*^9, 3.8905273383735204`*^9}, {
   3.8988782099719763`*^9, 3.8988782104193707`*^9}, {3.900093179450349*^9, 
   3.9000932064248447`*^9}, {3.9152226218831253`*^9, 3.915222649675064*^9}, {
   3.9152234558563757`*^9, 3.915223457637218*^9}, {3.9156276169886813`*^9, 
   3.9156276197021227`*^9}},ExpressionUUID->"431189e7-285e-43bb-b569-\
b4c5912f2a72"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["False Positive Filtering", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.900684062023316*^9, 3.900684070806832*^9}, {3.912519021184183*^9, 
  3.912519026311293*^9}, {3.912604787539379*^9, 
  3.912604801193694*^9}},ExpressionUUID->"4c4ea592-dfda-4ecc-b100-\
310a7c3f164e"],

Cell[CellGroupData[{

Cell["[[ Preview False Positive Filtering ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.9007545744843097`*^9, 
  3.9007545806693506`*^9}},ExpressionUUID->"0286ee20-162e-4651-84b3-\
f368042ca6b9"],

Cell["\<\
Defaults :
   
enableLFPE={1,1};   <<   0 or 1
intensityThreshold={0.1,0.1};
useMeanReference={0,0};   <<   0 or 1\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, {3.9007447255947275`*^9, 
   3.9007447329125357`*^9}, {3.9007510079302044`*^9, 3.900751019869511*^9}, 
   3.900754841161171*^9, {3.9007590024101*^9, 3.9007590059837704`*^9}, {
   3.9011035136297507`*^9, 3.901103514078061*^9}, {3.9038692073645115`*^9, 
   3.9038692078374224`*^9}, {3.903879343361342*^9, 3.9038793436983223`*^9}, {
   3.9125827321380424`*^9, 3.9125827432065363`*^9}, {3.9125829541727*^9, 
   3.9125829863250165`*^9}, {3.912680169696821*^9, 3.912680173831112*^9}},
 FontSize->16,ExpressionUUID->"1baa7b90-5526-4815-93e1-646baa64c3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"enableLFPE", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensityThreshold", "=", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"useMeanReference", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.900753637677281*^9, 3.900753656508579*^9}, {
   3.900753748519198*^9, 3.9007537581414833`*^9}, {3.9007552380708*^9, 
   3.9007552618864174`*^9}, {3.900756351241811*^9, 3.9007563810464*^9}, {
   3.900756716447869*^9, 3.900756716518777*^9}, {3.9007567768156157`*^9, 
   3.9007568093049927`*^9}, {3.900756864238547*^9, 3.9007568689136825`*^9}, {
   3.9007585853843007`*^9, 3.9007586618795404`*^9}, {3.900758931680765*^9, 
   3.900758969984025*^9}, {3.900764856484907*^9, 3.9007648775679927`*^9}, {
   3.9007649138944483`*^9, 3.9007649140559034`*^9}, {3.9010062840904527`*^9, 
   3.901006300826284*^9}, {3.901006334252265*^9, 3.9010063343469725`*^9}, {
   3.9010071091485605`*^9, 3.9010071648063393`*^9}, {3.901007523289318*^9, 
   3.9010075233222294`*^9}, {3.901008777989541*^9, 3.9010087781221905`*^9}, {
   3.9010088852858377`*^9, 3.901008919812431*^9}, {3.9010094287586327`*^9, 
   3.901009469637066*^9}, {3.9010114662808323`*^9, 3.9010114673624697`*^9}, {
   3.901018327417766*^9, 3.9010183280685587`*^9}, {3.9011026924638205`*^9, 
   3.9011027238749533`*^9}, {3.9011029252559843`*^9, 3.901103004839357*^9}, {
   3.9011031261116424`*^9, 3.901103134606668*^9}, {3.9011032163457165`*^9, 
   3.901103268854453*^9}, {3.90110330735133*^9, 3.901103312566389*^9}, {
   3.90110337984741*^9, 3.9011034042790103`*^9}, {3.9011035737674713`*^9, 
   3.9011035738875113`*^9}, {3.9011105992610464`*^9, 
   3.9011106243476295`*^9}, {3.9011106608255153`*^9, 3.901110671878204*^9}, {
   3.9011107287235594`*^9, 3.901110757487241*^9}, {3.9011749059877777`*^9, 
   3.901174922700117*^9}, {3.9011772503333435`*^9, 3.901177301048176*^9}, {
   3.901177610510206*^9, 3.901177610702692*^9}, {3.901184315148285*^9, 
   3.9011843152492776`*^9}, {3.901184796129753*^9, 3.901184796247102*^9}, {
   3.901186292989459*^9, 3.9011863181932106`*^9}, {3.901186417484149*^9, 
   3.90118643021414*^9}, {3.901188232886791*^9, 3.901188248700762*^9}, {
   3.901188361557884*^9, 3.901188378782524*^9}, {3.9011886295584993`*^9, 
   3.901188678990288*^9}, {3.901191570017103*^9, 3.901191584487977*^9}, {
   3.90119169045098*^9, 3.901191690613978*^9}, {3.9011917390421762`*^9, 
   3.901191763292096*^9}, {3.9011920423055153`*^9, 3.9011920426326666`*^9}, {
   3.9011922799937773`*^9, 3.9011923651295433`*^9}, {3.901192703849305*^9, 
   3.901192703913136*^9}, {3.9038667091448684`*^9, 3.9038667332968364`*^9}, {
   3.9038675329548516`*^9, 3.9038675330249467`*^9}, {3.903867563601892*^9, 
   3.903867590343892*^9}, {3.9038676608676467`*^9, 3.9038676613925395`*^9}, {
   3.903867691489855*^9, 3.9038677034631357`*^9}, {3.9038692105135484`*^9, 
   3.9038692331842957`*^9}, {3.905451976430122*^9, 3.9054519859425907`*^9}, 
   3.9054521213371882`*^9, {3.905452167575264*^9, 3.90545221914391*^9}, {
   3.905456529461671*^9, 3.9054565412004814`*^9}, {3.905456686429618*^9, 
   3.9054566945731745`*^9}, {3.9125820565475903`*^9, 
   3.9125820598597417`*^9}, {3.912582706988289*^9, 3.912582728426816*^9}, {
   3.912582779035225*^9, 3.912582780949999*^9}, {3.912582921466285*^9, 
   3.912582950258278*^9}, {3.9125949271625605`*^9, 3.9125949460505185`*^9}, 
   3.9125950356113887`*^9, {3.9125953029178247`*^9, 3.9125953097568893`*^9}, {
   3.9126007777625356`*^9, 3.912600789058209*^9}, {3.9126152925883083`*^9, 
   3.9126152935775223`*^9}, {3.912677022036718*^9, 3.9126770532151566`*^9}, {
   3.9126773129611053`*^9, 3.912677387471777*^9}, {3.912677456626154*^9, 
   3.912677461576967*^9}, {3.9126774926405106`*^9, 3.9126774979858875`*^9}, {
   3.9126776121312184`*^9, 3.912677622843213*^9}, {3.9126776942634945`*^9, 
   3.912677707138107*^9}, {3.912677761073644*^9, 3.912677783112733*^9}, {
   3.912677862567854*^9, 3.9126778631437826`*^9}, {3.9126779405604525`*^9, 
   3.9126779722821336`*^9}, {3.912680083880618*^9, 3.9126801352885847`*^9}, {
   3.912689467376897*^9, 3.9126894682405863`*^9}, {3.9156261401751413`*^9, 
   3.915626155391242*^9}, {3.9156272762197924`*^9, 3.9156272837581944`*^9}, {
   3.9170095320590754`*^9, 3.917009538945093*^9}, {3.91700961494726*^9, 
   3.9170097987252345`*^9}, {3.917017277852729*^9, 3.91701730134576*^9}, {
   3.917017332115697*^9, 3.9170173766588173`*^9}, {3.9170278735634365`*^9, 
   3.9170279204435043`*^9}, {3.9170280485883408`*^9, 3.917028053604347*^9}, {
   3.9170284121237516`*^9, 3.9170284429854164`*^9}, {3.9170284764193687`*^9, 
   3.9170284808657894`*^9}, {3.917028549019202*^9, 3.9170285496352243`*^9}, {
   3.9170295861704483`*^9, 3.917029586802229*^9}, {3.9170364610597467`*^9, 
   3.9170365156759405`*^9}, {3.917036729514984*^9, 3.9170367702362704`*^9}, {
   3.9170368008591833`*^9, 3.9170368197796736`*^9}, {3.9273070173709326`*^9, 
   3.9273070667606754`*^9}, {3.927338352844453*^9, 3.9273383621929255`*^9}, {
   3.9517333826466513`*^9, 3.9517334680617905`*^9}, {3.951749963707677*^9, 
   3.9517500015539613`*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"02e3e63a-3b47-4435-b4c4-8cdab2c0bd0e"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"imagePairs", "[", 
         RowBox[{"[", 
          RowBox[{"testID", ",", "#"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"getLuminanceFilteredSegments", "@@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"bacteriaMasks", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "testID"}], "]"}], "]"}], ",", 
           RowBox[{"imagesFiltered", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "testID"}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"useMeanReference", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", 
           RowBox[{"intensityThreshold", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", 
           RowBox[{"enableLFPE", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
        ",", "Red", ",", "2"}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"selectedLevelSets", "\[Equal]", 
        RowBox[{"{", "2", "}"}]}], ",", 
       RowBox[{"{", "1", "}"}], ",", "selectedLevelSets"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"ImageCollage", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "#"}], "\[Equal]", "1"}], ",", 
          RowBox[{"Scaled", "@", "0.5"}], ",", "Full"}], "]"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", "5"}]}], "]"}], "&"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"testID", ",", "1", ",", 
     RowBox[{"Length", "@", "imagePairs"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQbaChFbhO7a2je5B3CIieULwqAkTfqqyIB9FlbJ6L
QfQci4urQPRp7oPrQPSx13J7wOq+Kx0C08nsZ0F0nbzTRRC94sTemyD63pWT
r8Diy5Veg+jGQxeF1gNp/rv8wiA6IGlfCIiWjl4TCqKncNlabACZ17XXEkQ3
LVqgtBFIb723XQVEz3vcpAeiM05tNAfRq3YF2IHoZQ8Og2nNTSreIFrte4AP
iF4ctSoWLM/ekQmiPXnyC0F0oHxjCYjmSpneCKKn9G8B03FdlVbXQe5XrbIG
0dt2lH8E0SrJZl9A9AGd5KQbQHrPigmpIHrZrtQJt4D02QcGk0F02q6CoI3a
bx3XTDgLpp92GrzW0Aeqmzb/DYi2q2dx13Z+6+i23swDROs8nuIPotu4ZAJA
NADeZcZ5
  "],
 CellLabel->
  "In[277]:=",ExpressionUUID->"5166c002-7a44-4136-9e53-e9f9b09df4a9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Processing Cell", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 
  3.8887785266060743`*^9}},ExpressionUUID->"2b42903a-c151-45eb-8851-\
9dd237eaa497"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"bacteriaMasksClean", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Parallelize", "@", 
          RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"monitorCounter", "++"}], ";", 
               RowBox[{
               "getLuminanceFilteredSegments", "[", "\[IndentingNewLine]", 
                RowBox[{"#1", ",", "#2", ",", 
                 RowBox[{"useMeanReference", "[", 
                  RowBox[{"[", "levelsetID", "]"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"intensityThreshold", "[", 
                  RowBox[{"[", "levelsetID", "]"}], "]"}], ",", 
                 RowBox[{"enableLFPE", "[", 
                  RowBox[{"[", "levelsetID", "]"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"selectedLevelSets", "\[Equal]", 
                   RowBox[{"{", "2", "}"}]}], ",", "1", ",", "levelsetID"}], 
                 "]"}], "\[IndentingNewLine]", "]"}], "]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{"bacteriaMasks", ",", "imagesFiltered"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"levelsetID", ",", "selectedLevelSets"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", 
        RowBox[{"Flatten", "@", "bacteriaMasks"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bacteriaMasksClean", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "#"}], "==", "2"}], ",", 
       RowBox[{"Transpose", "@", "#"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "#", "}"}], "&"}], "/@", 
        RowBox[{"Flatten", "@", "#"}]}]}], "\[IndentingNewLine]", "]"}], 
     "&"}], "@", "bacteriaMasksClean"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9125953550544195`*^9, 3.9125953941301413`*^9}, {
   3.9125978871295137`*^9, 3.9125979417940025`*^9}, {3.912597974794595*^9, 
   3.91259797856736*^9}, {3.9125980378177395`*^9, 3.912598042408046*^9}, {
   3.912598087380076*^9, 3.9125980915866175`*^9}, {3.912598872057721*^9, 
   3.9125989403837357`*^9}, {3.9126005480512714`*^9, 3.912600564602985*^9}, {
   3.912600596626584*^9, 3.91260061258632*^9}, {3.9126041564829893`*^9, 
   3.9126041729369087`*^9}, {3.912604437582712*^9, 3.9126044510828943`*^9}, 
   3.9126106864948254`*^9, {3.912678352287015*^9, 3.912678356514022*^9}, {
   3.912681889263628*^9, 3.912681909705641*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"a81767cd-fb1e-4d81-9d19-3022e3a6a5cb"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Clean Bacteria Masks >>", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 3.915222540309099*^9}, 
   3.9156274163924828`*^9},ExpressionUUID->"21fd8fa1-60db-415b-b1ad-\
271f1efdb2ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"compressedCleanBacteriaMasks", "=", 
     RowBox[{
      RowBox[{"Compress", "/@", "bacteriaMasksClean"}], "//", 
      "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cleanBacteriaMaskFolder", "=", 
   RowBox[{"output", "<>", "\"\<3 Clean Bacteria Masks\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cleanBacteriaMaskFolder", "//", "CreateDirectory"}], ";"}], "//",
    "Quiet"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
    RowBox[{
    "compressedCleanBacteriaMasks", ",", "cleanBacteriaMaskFolder", ",", 
     "\"\<.txt\>\"", ",", "0"}], "\[IndentingNewLine]", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8892817493431044`*^9, 3.8892817805519447`*^9}, {
   3.889281837143244*^9, 3.88928191320846*^9}, {3.8892819594009056`*^9, 
   3.889281979209507*^9}, {3.8892821229194517`*^9, 3.8892821513839016`*^9}, {
   3.889621126101282*^9, 3.8896211918063293`*^9}, 3.8896214994948688`*^9, {
   3.8896215537218475`*^9, 3.889621561789811*^9}, {3.8896216430248423`*^9, 
   3.8896216457023907`*^9}, 3.8896216789445276`*^9, {3.8896220419612627`*^9, 
   3.8896220975531425`*^9}, {3.889623340867552*^9, 3.8896233411228905`*^9}, {
   3.8899819697164917`*^9, 3.889981979009638*^9}, 3.889982019469488*^9, {
   3.8899820760598574`*^9, 3.8899820783107395`*^9}, {3.890046229067525*^9, 
   3.890046277931983*^9}, {3.890527335932677*^9, 3.8905273362291927`*^9}, {
   3.899494914195033*^9, 3.8994949154990673`*^9}, {3.9152225301919775`*^9, 
   3.915222534823679*^9}, {3.9152225847640715`*^9, 3.9152226171491485`*^9}, {
   3.915223424822422*^9, 3.915223436343696*^9}, {3.9152234753578963`*^9, 
   3.915223478397222*^9}, {3.9152235935791206`*^9, 3.915223594570014*^9}, {
   3.915627418998305*^9, 3.9156274598009987`*^9}, {3.915627514288991*^9, 
   3.9156275151584177`*^9}, {3.9156275989867334`*^9, 3.9156276263016367`*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"0c923432-fdae-45ad-b7cf-1c417e1bdda5"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Clean Bacteria Masks <<", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, {3.88962249911553*^9, 3.8896225193161316`*^9}, 
   3.8896234870902314`*^9, {3.915222523970116*^9, 3.9152225455522757`*^9}, {
   3.915627409410327*^9, 
   3.9156274110175133`*^9}},ExpressionUUID->"741176c0-583c-4f52-8946-\
6871527c901d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cleanBacteriaMaskFolder", "=", 
   RowBox[{"output", "<>", "\"\<3 Clean Bacteria Masks\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", "cleanBacteriaMaskFolder"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bacteriaMasksClean", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"Uncompress", "@", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cleanBacteriaMaskFolder", "<>", "#"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", "files"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896225359098797`*^9, 3.8896226218372874`*^9}, {3.88962271829244*^9, 
   3.8896227275498905`*^9}, {3.889623134636578*^9, 3.889623137861703*^9}, {
   3.889623351635437*^9, 3.889623352090786*^9}, {3.8896235050986195`*^9, 
   3.889623534803034*^9}, 3.8899815513595295`*^9, {3.8901546653652105`*^9, 
   3.890154666131366*^9}, {3.8903837878670807`*^9, 3.8903837896332626`*^9}, {
   3.8903838511865406`*^9, 3.890383858398181*^9}, 3.8903839043715124`*^9, {
   3.890384135310108*^9, 3.890384146650017*^9}, {3.890386917039728*^9, 
   3.8903869187284775`*^9}, {3.8904093272504597`*^9, 3.890409333525776*^9}, 
   3.890409366183757*^9, {3.890527338154413*^9, 3.8905273383735204`*^9}, {
   3.8988782099719763`*^9, 3.8988782104193707`*^9}, {3.900093179450349*^9, 
   3.9000932064248447`*^9}, {3.9152226218831253`*^9, 3.915222649675064*^9}, {
   3.9152234558563757`*^9, 3.915223457637218*^9}, {3.915627421287032*^9, 
   3.9156274663753643`*^9}, {3.915627517399713*^9, 3.9156275181985207`*^9}, {
   3.9156276276549125`*^9, 3.915627627831148*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"b8042fc3-f3a5-4da0-b0d9-f68bd80e4746"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get Eligible Centroids", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.900684062023316*^9, 3.900684070806832*^9}, {3.912519021184183*^9, 
  3.912519026311293*^9}, {3.912604787539379*^9, 3.912604801193694*^9}, {
  3.9126841532305903`*^9, 
  3.91268416934389*^9}},ExpressionUUID->"13d5d097-fe83-4093-82eb-\
c5d3b30df571"],

Cell[CellGroupData[{

Cell["Eligible Segment Centroids", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.9006882264677343`*^9, 3.900688231979928*^9}, {3.900757011542185*^9, 
   3.9007570143977356`*^9}, 3.9007580507310266`*^9, {3.9126048334259024`*^9, 
   3.912604834899805*^9}, {3.912684181281111*^9, 
   3.9126841862960196`*^9}},ExpressionUUID->"fcde20d7-6d37-4802-9a84-\
63d6eb7077b1"],

Cell["\<\
Defaults :
   
{powerConvexRatio,powerHullSize,powerAspectRatio}={2,0.5,0.5};
criticalFactor=20;
artifactSizeThresholdLower=5;
artifactSizeThresholdUpper=10^4;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, {3.9007447255947275`*^9, 
   3.9007447424495296`*^9}, 3.9007459331605687`*^9, {3.905455893764465*^9, 
   3.9054558941863165`*^9}, 3.9054570778288426`*^9, 3.912600669921897*^9, 
   3.912679664191203*^9, 3.9126816419690027`*^9},
 FontSize->16,ExpressionUUID->"1a67ff3a-8601-43f8-9b8e-b60789f8f57f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "powerConvexRatio", ",", "powerHullSize", ",", "powerAspectRatio"}], 
    "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.5", ",", "0.5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"criticalFactor", "=", "200000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"artifactSizeThresholdLower", "=", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"artifactSizeThresholdUpper", "=", "500"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9126188377823353`*^9, 3.912618854866274*^9}, {
   3.9126189078591413`*^9, 3.9126189263611937`*^9}, {3.912618999138913*^9, 
   3.912619005153208*^9}, {3.912619097859288*^9, 3.9126190983300323`*^9}, 
   3.912623812530986*^9, {3.9126763501035533`*^9, 3.9126763560337315`*^9}, {
   3.912676390514577*^9, 3.912676593704419*^9}, {3.9126813530246315`*^9, 
   3.9126813534529676`*^9}, 3.912681385624529*^9, {3.912681657754534*^9, 
   3.9126816581520014`*^9}, {3.912683321232479*^9, 3.9126833213112855`*^9}, {
   3.9126895323472323`*^9, 3.912689534591694*^9}, 3.915223770403826*^9, 
   3.91522381320641*^9, {3.915223861695471*^9, 3.9152238715219574`*^9}, {
   3.9517500997232814`*^9, 3.951750101018448*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"2f44eaa2-e584-4a7d-8efe-89189236dbf7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"bacteriaData", "=", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{
             RowBox[{
              RowBox[{"findEligibleSegments", "[", 
               RowBox[{"#", ",", "criticalFactor"}], "]"}], "&"}], "/@", 
             "#"}]}], ")"}], "&"}], "/@", "bacteriaMasksClean"}], "//", 
        "Parallelize"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "bacteriaMasksClean"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bacteriaDataJoined", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", "bacteriaData"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9126189396923065`*^9, 3.9126189733547463`*^9}, {
   3.912619019642467*^9, 3.91261905864264*^9}, {3.9126191026345205`*^9, 
   3.9126191082747917`*^9}, {3.91267579627448*^9, 3.912675818767464*^9}, {
   3.912675850432351*^9, 3.9126759224301567`*^9}, {3.9126760331765156`*^9, 
   3.9126760820003195`*^9}, {3.912676133624958*^9, 3.912676149640275*^9}, {
   3.9126817452541976`*^9, 3.912681751311225*^9}, {3.912681842913864*^9, 
   3.9126818610328536`*^9}, 3.9126819299980764`*^9, {3.9126827243043575`*^9, 
   3.9126827410579143`*^9}, {3.9126828266911325`*^9, 3.912682831575869*^9}, 
   3.9126828958652*^9, {3.9157349286844597`*^9, 3.9157349826042027`*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"41c0578e-f87d-40cf-8db6-c8fbad50f919"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ View Results ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.9006882264677343`*^9, 3.900688231979928*^9}, {3.900757011542185*^9, 
   3.9007570143977356`*^9}, 3.9007580507310266`*^9, {3.9126048334259024`*^9, 
   3.912604834899805*^9}, {3.912684181281111*^9, 3.9126841862960196`*^9}, {
   3.915735563323265*^9, 
   3.915735573636607*^9}},ExpressionUUID->"c6954c0f-993f-4baf-b16c-\
d2dac6a90db4"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"imagePairs", "[", 
           RowBox[{"[", 
            RowBox[{"testID", ",", "#"}], "]"}], "]"}], ",", 
          RowBox[{"bacteriaMasksClean", "[", 
           RowBox[{"[", 
            RowBox[{"testID", ",", "#"}], "]"}], "]"}], ",", "White", ",", 
          "1.75"}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"bacteriaData", "[", 
             RowBox[{"[", 
              RowBox[{"testID", ",", "#"}], "]"}], "]"}]}]}], ",", "Red"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"selectedLevelSets", "\[Equal]", 
        RowBox[{"{", "2", "}"}]}], ",", 
       RowBox[{"{", "1", "}"}], ",", "selectedLevelSets"}], "]"}]}], "//", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ImageCollage", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "#"}], "\[Equal]", "1"}], ",", 
          RowBox[{"Scaled", "@", "0.5"}], ",", "Full"}], "]"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", "5"}]}], "]"}], "&"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"testID", ",", "1", ",", 
     RowBox[{"Length", "@", "imagePairs"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9126154092946377`*^9, 3.912615435650309*^9}, {
   3.912615571226653*^9, 3.912615582467697*^9}, {3.9126173093329782`*^9, 
   3.912617311641531*^9}, {3.91261901294691*^9, 3.912619015081581*^9}, {
   3.9126762657860737`*^9, 3.9126763183853536`*^9}, {3.912676409688827*^9, 
   3.9126764291931453`*^9}, {3.912676470825858*^9, 3.9126764790884633`*^9}, 
   3.9126765256481915`*^9, {3.9126766061919084`*^9, 3.912676622041261*^9}, {
   3.9126780267846956`*^9, 3.9126782802802143`*^9}, {3.912678511877289*^9, 
   3.9126785181047115`*^9}, {3.9126785778668737`*^9, 3.912678651296009*^9}, {
   3.9126791710155954`*^9, 3.912679173767915*^9}, {3.9126793634901237`*^9, 
   3.912679377508171*^9}, {3.9126795165364923`*^9, 3.912679586641013*^9}, {
   3.9126800667339635`*^9, 3.9126800671684203`*^9}, {3.9126812553049464`*^9, 
   3.9126812561115932`*^9}, {3.9126817040662346`*^9, 3.912681706515055*^9}, {
   3.912681736856789*^9, 3.9126817385048127`*^9}, {3.9126818167006316`*^9, 
   3.912681829825363*^9}, 3.912681952635724*^9, {3.912681989763278*^9, 
   3.9126819902004642`*^9}, {3.9126823343214755`*^9, 3.912682341626751*^9}, {
   3.9126826614368267`*^9, 3.9126826942109456`*^9}, 3.9126827303294363`*^9, {
   3.9126845395957546`*^9, 3.912684549792734*^9}, {3.9152216634963427`*^9, 
   3.9152216689127035`*^9}, 3.915708355535293*^9, {3.926865608936578*^9, 
   3.9268656104322834`*^9}, 3.927530063250697*^9},
 CellLabel->
  "In[292]:=",ExpressionUUID->"0ab6cd17-61c5-43dd-a5c5-5ee8a6766803"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clean Centroids", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.9006882264677343`*^9, 3.900688231979928*^9}, {3.900757011542185*^9, 
   3.9007570143977356`*^9}, 3.9007580507310266`*^9, {3.9126048334259024`*^9, 
   3.912604834899805*^9}, {3.912684181281111*^9, 3.9126841862960196`*^9}, 
   3.912684227160231*^9},ExpressionUUID->"b6e7aad2-df50-43f2-9a9b-\
2a18a857b7f9"],

Cell["\<\
Defaults :
   
criticalDistance=15;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}, {3.900758063036702*^9, 
   3.9007580654171567`*^9}},
 FontSize->16,ExpressionUUID->"29b1709d-2e6c-4865-99a1-6492fc613cc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"criticalDistance", "=", "10"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.900757500298973*^9, 3.900757512102312*^9}, {
   3.900764092195593*^9, 3.9007640929033823`*^9}, 3.9010166322029285`*^9, {
   3.90101706670811*^9, 3.9010170696263227`*^9}, {3.901018504012986*^9, 
   3.901018521437645*^9}, 3.901094111454341*^9, {3.9010992518999643`*^9, 
   3.9010992677392178`*^9}, 3.901105321135909*^9, {3.901107522852986*^9, 
   3.90110754264904*^9}, {3.901107587369802*^9, 3.901107621401582*^9}, 
   3.901110044813935*^9, {3.9011128418927*^9, 3.901112862507971*^9}, {
   3.901112918462487*^9, 3.9011129311910753`*^9}, {3.901112968096407*^9, 
   3.9011129684129496`*^9}, 3.9011749915168056`*^9, {3.901186454529271*^9, 
   3.901186455517477*^9}, {3.901186593323943*^9, 3.901186594683964*^9}, {
   3.9038690710891085`*^9, 3.9038690721851873`*^9}, {3.905447513426671*^9, 
   3.9054475142618785`*^9}, {3.905452982390608*^9, 3.9054530227779226`*^9}, {
   3.9054536199292593`*^9, 3.905453620150663*^9}, {3.9054540808150663`*^9, 
   3.90545408105553*^9}, {3.905454310798735*^9, 3.9054543111335135`*^9}, {
   3.905454386606884*^9, 3.905454402184791*^9}, {3.9054556819826236`*^9, 
   3.9054556830844173`*^9}, {3.905455957022373*^9, 3.9054559591813555`*^9}, {
   3.9126880484813747`*^9, 3.9126880491426044`*^9}, {3.912689637824209*^9, 
   3.912689638079934*^9}, {3.9126897161687236`*^9, 3.912689717127661*^9}, {
   3.915223908328044*^9, 3.9152239089325695`*^9}, {3.9170361992041607`*^9, 
   3.9170361992851973`*^9}, {3.917036377732986*^9, 3.9170363780031266`*^9}, {
   3.917036424347583*^9, 3.917036425228589*^9}, 3.9170394954618864`*^9, {
   3.9170596383811655`*^9, 3.9170596396361885`*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"80888c19-c5cd-4c99-ba36-c5677f46c917"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bacteriaCentroidsRaw", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "@", 
      RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", 
    "bacteriaDataJoined"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaRadiiRaw", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Last", "@", 
       RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", 
     "bacteriaDataJoined"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaCentroidsResolved", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getResolvedParticles", "[", 
       RowBox[{"#", ",", "criticalDistance"}], "]"}], "&"}], "@", 
     "bacteriaCentroidsRaw"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Length", "/@", "bacteriaCentroidsResolved"}], "//", "Mean"}], "//",
   "N"}]}], "Input",
 CellChangeTimes->{{3.900757022052658*^9, 3.9007573125024076`*^9}, {
   3.90075736210476*^9, 3.9007573700647016`*^9}, {3.900757632977768*^9, 
   3.9007578719203434`*^9}, {3.900757969567752*^9, 3.9007579710736833`*^9}, {
   3.9007581167617807`*^9, 3.9007581407223153`*^9}, {3.900758467521048*^9, 
   3.9007584708332434`*^9}, {3.9007614808453226`*^9, 3.90076149253413*^9}, {
   3.9007627987150784`*^9, 3.900762800724661*^9}, {3.9010185310375257`*^9, 
   3.9010185361630983`*^9}, {3.9010941222605534`*^9, 
   3.9010941388288755`*^9}, {3.9011026401470413`*^9, 3.9011026424515324`*^9}, 
   3.90118592583998*^9, {3.9011917075532618`*^9, 3.9011917082315264`*^9}, {
   3.9054556843621926`*^9, 3.9054556849994354`*^9}, 3.9126842459609528`*^9, {
   3.9126843406370296`*^9, 3.9126843426973667`*^9}, 3.9157085789097366`*^9, {
   3.9157097476203856`*^9, 3.9157097859275227`*^9}, {3.9157104810126476`*^9, 
   3.915710481379654*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"9082d2f6-3120-4154-a31b-40ca956bd731"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaRadiiResolved", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getResolvedRadii", "[", 
        RowBox[{"#1", ",", "#2", ",", "#3", ",", "criticalDistance"}], "]"}], 
       "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "bacteriaRadiiRaw", ",", "bacteriaCentroidsRaw", ",", 
        "bacteriaCentroidsResolved"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.9157102450619373`*^9, 3.9157103585085278`*^9}, {
  3.9157105069802475`*^9, 3.9157105081279106`*^9}, {3.915734123474327*^9, 
  3.915734133806455*^9}, {3.917101182122052*^9, 3.9171011833263617`*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"11d34b7f-8c3c-4dc1-bfe3-1e111d752e62"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ View Results ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.9006882264677343`*^9, 3.900688231979928*^9}, {3.900757011542185*^9, 
   3.9007570143977356`*^9}, 3.9007580507310266`*^9, {3.9126048334259024`*^9, 
   3.912604834899805*^9}, {3.912684181281111*^9, 3.9126841862960196`*^9}, {
   3.915735563323265*^9, 
   3.915735573636607*^9}},ExpressionUUID->"3bfd97ac-fca0-43eb-9c8b-\
2743a1e395c4"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imagePairs", "[", 
      RowBox[{"[", 
       RowBox[{"testID", ",", "2"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"bacteriaCentroidsResolved", "[", 
      RowBox[{"[", "testID", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"testID", ",", "1", ",", 
     RowBox[{"Length", "@", "bacteriaCentroidsResolved"}], ",", "1"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.915224146116665*^9, 3.9152242389974117`*^9}, {
   3.915627143712352*^9, 3.9156271446461477`*^9}, {3.915627216678924*^9, 
   3.915627251935505*^9}, {3.915627308199606*^9, 3.9156273095311522`*^9}, {
   3.915627357320154*^9, 3.9156273635178175`*^9}, {3.9156276500646915`*^9, 
   3.9156276763042145`*^9}, 3.915638475109413*^9, {3.9170176833699923`*^9, 
   3.9170176915329113`*^9}, {3.917036412884229*^9, 3.917036414187915*^9}},
 CellLabel->
  "In[347]:=",ExpressionUUID->"fe169004-6908-4770-91c6-1fc6caca6adb"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Bacteria Centroids & Radii >>", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 3.915222540309099*^9}, 
   3.9156274163924828`*^9, {3.91562792161534*^9, 3.915627925454192*^9}, {
   3.915710406724619*^9, 
   3.915710411066506*^9}},ExpressionUUID->"ee00c5e3-13ec-4adc-a652-\
1507966c0e2e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dataCompressedfolder", "<>", "\"\<Bacteria Centroids.txt\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Compress", "@", "bacteriaCentroidsResolved"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataCompressedfolder", "<>", "\"\<Bacteria Radii.txt\>\""}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", "bacteriaRadiiResolved"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8892817493431044`*^9, 3.8892817805519447`*^9}, {
   3.889281837143244*^9, 3.88928191320846*^9}, {3.8892819594009056`*^9, 
   3.889281979209507*^9}, {3.8892821229194517`*^9, 3.8892821513839016`*^9}, {
   3.889621126101282*^9, 3.8896211918063293`*^9}, 3.8896214994948688`*^9, {
   3.8896215537218475`*^9, 3.889621561789811*^9}, {3.8896216430248423`*^9, 
   3.8896216457023907`*^9}, 3.8896216789445276`*^9, {3.8896220419612627`*^9, 
   3.8896220975531425`*^9}, {3.889623340867552*^9, 3.8896233411228905`*^9}, {
   3.8899819697164917`*^9, 3.889981979009638*^9}, 3.889982019469488*^9, {
   3.8899820760598574`*^9, 3.8899820783107395`*^9}, {3.890046229067525*^9, 
   3.890046277931983*^9}, {3.890527335932677*^9, 3.8905273362291927`*^9}, {
   3.899494914195033*^9, 3.8994949154990673`*^9}, {3.9152225301919775`*^9, 
   3.915222534823679*^9}, {3.9152225847640715`*^9, 3.9152226171491485`*^9}, {
   3.915223424822422*^9, 3.915223436343696*^9}, {3.9152234753578963`*^9, 
   3.915223478397222*^9}, {3.9152235935791206`*^9, 3.915223594570014*^9}, {
   3.915627418998305*^9, 3.9156274598009987`*^9}, {3.915627514288991*^9, 
   3.9156275151584177`*^9}, {3.9156275989867334`*^9, 
   3.9156276263016367`*^9}, {3.915627943039804*^9, 3.9156279902950764`*^9}, {
   3.9156280748404016`*^9, 3.915628091218577*^9}, {3.9156281246315737`*^9, 
   3.915628125174774*^9}, {3.9157104254762263`*^9, 3.915710432251785*^9}, {
   3.915738873299178*^9, 3.9157388989781647`*^9}, {3.9268657164012184`*^9, 
   3.9268657176074204`*^9}, {3.9273419484489355`*^9, 3.927341949409146*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"ffc1ed16-7771-4abb-aa9c-f35f346937d7"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Bacteria Centroids & Radii <<", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, {3.88962249911553*^9, 3.8896225193161316`*^9}, 
   3.8896234870902314`*^9, {3.915222523970116*^9, 3.9152225455522757`*^9}, {
   3.915627409410327*^9, 3.9156274110175133`*^9}, {3.9156279304544163`*^9, 
   3.9156279317014713`*^9}, {3.9157104185491734`*^9, 
   3.9157104197390137`*^9}},ExpressionUUID->"16fa1ebb-2f61-4dbb-9517-\
6fd3250f5c82"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaCentroidsResolved", "=", 
    RowBox[{"Uncompress", "@", 
     RowBox[{"Import", "[", "\[IndentingNewLine]", 
      RowBox[{
      "dataCompressedfolder", "<>", "\"\<Bacteria Centroids.txt\>\""}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bacteriaRadiiResolved", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{"dataCompressedfolder", "<>", "\"\<Bacteria Radii.txt\>\""}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896225359098797`*^9, 3.8896226218372874`*^9}, {3.88962271829244*^9, 
   3.8896227275498905`*^9}, {3.889623134636578*^9, 3.889623137861703*^9}, {
   3.889623351635437*^9, 3.889623352090786*^9}, {3.8896235050986195`*^9, 
   3.889623534803034*^9}, 3.8899815513595295`*^9, {3.8901546653652105`*^9, 
   3.890154666131366*^9}, {3.8903837878670807`*^9, 3.8903837896332626`*^9}, {
   3.8903838511865406`*^9, 3.890383858398181*^9}, 3.8903839043715124`*^9, {
   3.890384135310108*^9, 3.890384146650017*^9}, {3.890386917039728*^9, 
   3.8903869187284775`*^9}, {3.8904093272504597`*^9, 3.890409333525776*^9}, 
   3.890409366183757*^9, {3.890527338154413*^9, 3.8905273383735204`*^9}, {
   3.8988782099719763`*^9, 3.8988782104193707`*^9}, {3.900093179450349*^9, 
   3.9000932064248447`*^9}, {3.9152226218831253`*^9, 3.915222649675064*^9}, {
   3.9152234558563757`*^9, 3.915223457637218*^9}, {3.915627421287032*^9, 
   3.9156274663753643`*^9}, {3.915627517399713*^9, 3.9156275181985207`*^9}, {
   3.9156276276549125`*^9, 3.915627627831148*^9}, {3.91562799744701*^9, 
   3.9156280485341587`*^9}, {3.9157104384041367`*^9, 3.915710448470223*^9}, {
   3.915738888052978*^9, 3.91573889540647*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"938c1213-8b9f-4918-a6a3-7d88eab3ea91"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Prepare & Export Data for MHT-X >>", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, {3.88962249911553*^9, 3.8896225193161316`*^9}, 
   3.8896234870902314`*^9, {3.915222523970116*^9, 3.9152225455522757`*^9}, {
   3.915627409410327*^9, 3.9156274110175133`*^9}, {3.9156279304544163`*^9, 
   3.9156279317014713`*^9}, {3.9157104185491734`*^9, 
   3.9157104197390137`*^9}, {3.9265207446611967`*^9, 
   3.9265207598612404`*^9}, {3.926577032559476*^9, 
   3.9265770378712606`*^9}},ExpressionUUID->"8cbbf77b-7209-4708-8432-\
8a88bec5e046"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"imagesCorrected", "[", 
    RowBox[{"[", "k", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "imagesCorrected"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.951831580835822*^9, 3.9518316030639334`*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"41741181-8ccb-451b-993a-b48291736a7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "MHTXfolder", "=", 
   "\"\<D:\\\\Science\\\\MMML\\\\Image Processing\\\\MHT-X\\\\Data for \
Tracking\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.926561160417808*^9, 3.9265611713994856`*^9}, {
  3.926561244815858*^9, 3.926561246408427*^9}, {3.927530679197742*^9, 
  3.927530681740177*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"c20695a2-252a-4628-ad15-7dfd134ab684"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dataMHTXformat", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
         RowBox[{"Catenate", "[", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Frame\>\"", ",", "\"\<ID\>\"", ",", "\"\<X\>\"", ",", 
                "\"\<Y\>\"", ",", "\"\<Vx\>\"", ",", "\"\<Vy\>\"", ",", 
                "\"\<r\>\"", ",", "\"\<c\>\""}], "}"}], "}"}], "}"}], ",", 
            "#"}], "}"}], "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"k", ",", "m", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "m"}], "]"}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", "4"}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "#"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
     "bacteriaCentroidsResolved"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dataCSVfolder", "<>", "\"\<Input_for_MHT-X_tracking.csv\>\""}], 
     ",", "dataMHTXformat"}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataMHTXfolder", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
         "MHTXfolder", "<>", "$PathnameSeparator", "<>", "#1", "<>", 
          "\"\<_\>\"", "<>", "#2"}], "&"}], "@@", 
        RowBox[{"StringSplit", "[", 
         RowBox[{"#", ",", "$PathnameSeparator"}], "]"}]}], "&"}], "@", 
      "subFolder"}], "<>", "$PathnameSeparator", "<>", 
     "\"\<Front view\>\""}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataMHTXcompressedFolder", "=", 
   RowBox[{
   "dataMHTXfolder", "<>", "$PathnameSeparator", "<>", 
    "\"\<Compressed Data\\\\\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "dataMHTXcompressedFolder"}], ";"}], "//",
    "Quiet"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"CopyFile", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataCSVfolder", "<>", "\"\<Input_for_MHT-X_tracking.csv\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
    "dataMHTXfolder", "<>", "$PathnameSeparator", "<>", 
     "\"\<dataset.csv\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"OverwriteTarget", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9265581979838753`*^9, 3.926558199872574*^9}, {
   3.9265582392892847`*^9, 3.9265582927368383`*^9}, {3.9265583862386236`*^9, 
   3.9265584437040215`*^9}, {3.926558590242437*^9, 3.9265586062722297`*^9}, {
   3.9265586462262983`*^9, 3.926558647159938*^9}, 3.9265588106486087`*^9, {
   3.9265588478082314`*^9, 3.926558879847418*^9}, {3.926558965816244*^9, 
   3.92655899144821*^9}, {3.9265590567037363`*^9, 3.9265591045839434`*^9}, {
   3.9265591995007687`*^9, 3.926559317128125*^9}, {3.9265593539138513`*^9, 
   3.9265593920334773`*^9}, {3.9265594458904314`*^9, 3.9265594525840163`*^9}, 
   3.9265603594426537`*^9, {3.9265609230170712`*^9, 3.926560929297767*^9}, {
   3.9265613902264433`*^9, 3.9265614342817273`*^9}, 3.9265614960106544`*^9, {
   3.926561964842947*^9, 3.926561971639552*^9}, {3.926562115841423*^9, 
   3.926562143217572*^9}, {3.926575716479705*^9, 3.926575789503421*^9}, {
   3.9265758647446766`*^9, 3.92657586486343*^9}, {3.926576555194078*^9, 
   3.926576587185217*^9}, {3.9265766483859754`*^9, 3.926576665858013*^9}, {
   3.9265818705436068`*^9, 3.926581882310726*^9}, 3.9267359566660757`*^9, {
   3.92753070930377*^9, 3.9275307179018536`*^9}, 3.951733872524354*^9, 
   3.9517504615910387`*^9, 3.951831718947994*^9, 3.9518319548145013`*^9},
 CellLabel->
  "In[338]:=",ExpressionUUID->"b7cfda01-f7f3-45f4-befc-ed5dde36e8a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"output", "<>", "\"\<1 Cropped Images\\\\\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filesToZip", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"output", "<>", "\"\<1 Cropped Images\\\\\>\"", "<>", "#"}], 
      "&"}], "/@", 
     RowBox[{"FileNames", "[", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"CreateArchive", "[", "\[IndentingNewLine]", 
   RowBox[{"filesToZip", ",", 
    RowBox[{"dataMHTXcompressedFolder", "<>", "\"\<Shapes.zip\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"CompressionLevel", "\[Rule]", "1"}], ",", 
    RowBox[{"CreateIntermediateDirectories", "\[Rule]", "False"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9265581979838753`*^9, 3.926558199872574*^9}, {
   3.9265582392892847`*^9, 3.9265582927368383`*^9}, {3.9265583862386236`*^9, 
   3.9265584437040215`*^9}, {3.926558590242437*^9, 3.9265586062722297`*^9}, {
   3.9265586462262983`*^9, 3.926558647159938*^9}, 3.9265588106486087`*^9, {
   3.9265588478082314`*^9, 3.926558879847418*^9}, {3.926558965816244*^9, 
   3.92655899144821*^9}, {3.9265590567037363`*^9, 3.9265591045839434`*^9}, {
   3.9265591995007687`*^9, 3.926559317128125*^9}, {3.9265593539138513`*^9, 
   3.9265593920334773`*^9}, {3.9265594458904314`*^9, 3.9265594525840163`*^9}, 
   3.9265603594426537`*^9, {3.9265609230170712`*^9, 3.926560929297767*^9}, {
   3.9265613902264433`*^9, 3.9265614342817273`*^9}, 3.9265614960106544`*^9, {
   3.926561964842947*^9, 3.926561971639552*^9}, {3.926562115841423*^9, 
   3.926562143217572*^9}, {3.926575716479705*^9, 3.926575789503421*^9}, {
   3.9265758647446766`*^9, 3.92657586486343*^9}, {3.926576555194078*^9, 
   3.926576587185217*^9}, {3.9265766483859754`*^9, 3.926576665858013*^9}, {
   3.9265818705436068`*^9, 3.926581882310726*^9}, 3.9265819243773055`*^9},
 CellLabel->
  "In[344]:=",ExpressionUUID->"dc184d1c-1f96-4f00-854c-d8e64ee355fb"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bacteria Tracking", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.842969150048052*^9, 3.8429691537910447`*^9}, {3.8615435122762966`*^9, 
  3.861543517725723*^9}, {3.890209056062702*^9, 3.89020905769811*^9}, {
  3.9170402805792403`*^9, 
  3.917040291056275*^9}},ExpressionUUID->"0d8689fa-7cdd-4577-b326-\
9b230686960c"],

Cell[CellGroupData[{

Cell["Nearest Neighbor Tracking", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.91703999042743*^9, 3.917039992258114*^9}},
 FontSize->24,ExpressionUUID->"01da7cf0-85f2-4179-8cfb-734234406e09"],

Cell["\<\
Defaults :
   
motionThreshold=25;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}, {3.9038691848644695`*^9, 
   3.9038691932406826`*^9}, {3.903879337705083*^9, 3.9038793378903737`*^9}},
 FontSize->16,ExpressionUUID->"1ad30552-fb44-434b-8b6d-fcc89b7fcc9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"motionThreshold", "=", "20"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.890120843901436*^9, 3.890120904244889*^9}, {
   3.8901209450900283`*^9, 3.890120946571348*^9}, {3.890122984319893*^9, 
   3.890122986920873*^9}, {3.890123972255765*^9, 3.8901239812237415`*^9}, {
   3.8901286047546916`*^9, 3.890128617816607*^9}, {3.8905933876064982`*^9, 
   3.8905934097210183`*^9}, {3.892888572138487*^9, 3.8928886439450073`*^9}, {
   3.89288867921037*^9, 3.8928886948808603`*^9}, {3.8928934734380713`*^9, 
   3.892893475158003*^9}, {3.899621115166462*^9, 3.899621126726269*^9}, {
   3.899809797229292*^9, 3.899809807661023*^9}, {3.899809859365857*^9, 
   3.89980987282913*^9}, 3.9000459223038635`*^9, {3.9000460974853687`*^9, 
   3.9000461181971183`*^9}, {3.900047471229046*^9, 3.9000474712918773`*^9}, {
   3.900047521853744*^9, 3.900047522092066*^9}, {3.900047642997147*^9, 
   3.900047643253462*^9}, {3.9000476988209467`*^9, 3.900047735516001*^9}, 
   3.9000884802620645`*^9, {3.9000886592531214`*^9, 3.9000886680371304`*^9}, {
   3.900090509211933*^9, 3.900090515426762*^9}, {3.900091936146394*^9, 
   3.9000919363618402`*^9}, {3.900092058709553*^9, 3.90009205893095*^9}, {
   3.9000923348506317`*^9, 3.9000923364492006`*^9}, {3.900093319675212*^9, 
   3.900093349631632*^9}, {3.9000933926968393`*^9, 3.9000934164642553`*^9}, {
   3.900093537297714*^9, 3.900093541545133*^9}, {3.900094822369808*^9, 
   3.900094876032826*^9}, 3.900095412465242*^9, 3.9000954557195616`*^9, 
   3.9000956755426216`*^9, {3.9000957923188176`*^9, 3.900095793346131*^9}, {
   3.9000961070223875`*^9, 3.9000961143902287`*^9}, 3.900096191838406*^9, 
   3.900097210277793*^9, {3.9000973865575647`*^9, 3.9000973888454237`*^9}, 
   3.90009742527022*^9, 3.9001057592020116`*^9, 3.9001060840472345`*^9, {
   3.9001434989365644`*^9, 3.9001435000484114`*^9}, {3.900264963298522*^9, 
   3.900264963954007*^9}, {3.9002674562974343`*^9, 3.9002674755220814`*^9}, {
   3.900268127216963*^9, 3.900268146639017*^9}, {3.900268202303647*^9, 
   3.9002682177603607`*^9}, {3.900268262808874*^9, 3.900268263471103*^9}, {
   3.9002683356102085`*^9, 3.90026835651132*^9}, {3.900325008715393*^9, 
   3.9003250184822206`*^9}, {3.900398773213009*^9, 3.900398816298752*^9}, {
   3.90039898014942*^9, 3.9003990106096315`*^9}, {3.9004145482139564`*^9, 
   3.900414548348624*^9}, 3.9004276405890713`*^9, 3.9004282919139214`*^9, {
   3.900477260199849*^9, 3.900477267508355*^9}, {3.900477366924247*^9, 
   3.900477390811407*^9}, {3.900477461788267*^9, 3.9004774724915886`*^9}, {
   3.9004775397318025`*^9, 3.9004775497639694`*^9}, {3.9004780329109135`*^9, 
   3.9004780329627748`*^9}, {3.900478125660155*^9, 3.9004781532503815`*^9}, {
   3.9004784768362713`*^9, 3.9004785042020264`*^9}, {3.900491398658142*^9, 
   3.90049140842603*^9}, {3.900491441282195*^9, 3.900491441392842*^9}, {
   3.9004914860429854`*^9, 3.9004914861048203`*^9}, {3.90049174118616*^9, 
   3.9004917479690094`*^9}, {3.9006898106060534`*^9, 
   3.9006898107942743`*^9}, {3.900690122678644*^9, 3.9006901426517878`*^9}, {
   3.9007442987966795`*^9, 3.900744299772108*^9}, {3.9007454554641113`*^9, 
   3.9007454923729377`*^9}, {3.900751028550321*^9, 3.9007510302576275`*^9}, {
   3.9007555621437745`*^9, 3.9007555685441523`*^9}, {3.9007584800733857`*^9, 
   3.9007585182344494`*^9}, {3.9007610043781652`*^9, 
   3.9007610672631493`*^9}, {3.901017399995025*^9, 3.9010174014027424`*^9}, {
   3.9011760993043876`*^9, 3.9011761044050827`*^9}, 3.901176423348361*^9, {
   3.9011772254375644`*^9, 3.9011772326845407`*^9}, {3.9011773342388926`*^9, 
   3.9011773345006657`*^9}, {3.901180344375981*^9, 3.9011803445889096`*^9}, {
   3.901183758550838*^9, 3.901183758797877*^9}, {3.9011867166841497`*^9, 
   3.901186717691967*^9}, {3.903869082953444*^9, 3.9038690980334315`*^9}, {
   3.903869420858544*^9, 3.9038694213381186`*^9}, {3.903879328187174*^9, 
   3.9038793512011795`*^9}, {3.90388131285351*^9, 3.9038813729215584`*^9}, {
   3.903881421423966*^9, 3.9038814220010586`*^9}, {3.9038814996675434`*^9, 
   3.9038815129795327`*^9}, {3.9038823919881706`*^9, 3.903882392073794*^9}, {
   3.903882515149567*^9, 3.903882515388111*^9}, {3.903884261554979*^9, 
   3.9038842997250013`*^9}, {3.9054490906399865`*^9, 3.9054491364876733`*^9}, 
   3.905449245558367*^9, {3.9054510446871386`*^9, 3.905451123179369*^9}, {
   3.905453006202749*^9, 3.905453008863242*^9}, {3.905453625309708*^9, 
   3.905453628262081*^9}, {3.9054540501748657`*^9, 3.905454058335825*^9}, {
   3.9054543323237123`*^9, 3.9054543384772778`*^9}, {3.9054544124866905`*^9, 
   3.905454412701849*^9}, {3.90545569808771*^9, 3.9054557138635488`*^9}, {
   3.912684884562395*^9, 3.9126849471600137`*^9}, {3.912685652792041*^9, 
   3.9126856768957148`*^9}, {3.9126897471131277`*^9, 3.91268976829602*^9}, {
   3.917040023166954*^9, 3.917040104050865*^9}, {3.9170401638552713`*^9, 
   3.9170401772908173`*^9}, {3.91749974044915*^9, 3.9174997412690077`*^9}, {
   3.917500063024603*^9, 3.9175000785179176`*^9}, {3.9176700903626547`*^9, 
   3.9176701122888107`*^9}, {3.9273869558005943`*^9, 3.927386956560449*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"02cfe379-c867-433e-855f-83e988752177"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaCentroids", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "@", 
             RowBox[{"Length", "@", "#"}]}], ",", "#"}], "}"}], "&"}], "@", 
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"#", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], "&"}], "@", 
       RowBox[{"bacteriaCentroidsResolved", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "75"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"shitToClean", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Last", "/@", "bacteriaCentroids"}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "@", "#"}], ">", "1050"}], "&&", 
         RowBox[{"340", "<", 
          RowBox[{"Last", "@", "#"}], "<", "430"}]}], "&"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\n", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Last", "/@", "bacteriaCentroids"}], ",", "1"}], "]"}], ",",
         "shitToClean"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bacteriaCentroids", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"k", ",", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Last", "@", 
            RowBox[{"bacteriaCentroids", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ",", "shitToClean"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "bacteriaCentroids"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\n", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Last", "/@", "bacteriaCentroids"}], ",", "1"}], "]"}], "//", 
     "ListPlot"}]}], "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bacteriaTracks", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ReverseSortBy", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{"Length", "@", "#"}], "&"}]}], "]"}], "&"}], "@", 
      RowBox[{"getNearestNeighborTracks", "[", "\[IndentingNewLine]", 
       RowBox[{"bacteriaCentroids", ",", "motionThreshold"}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bacteriaTracks", "//", "Length"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Length", "/@", "bacteriaTracks"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Last", "@", 
       RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", "bacteriaTracks"}], 
    ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", "#"}], ">", "10"}], "&"}]}], "]"}], "//", 
  "ListLinePlot"}]}], "Input",
 CellChangeTimes->{{3.9006898350302887`*^9, 3.900689900681117*^9}, {
   3.900690099781435*^9, 3.9006901074460335`*^9}, {3.9007580815800195`*^9, 
   3.900758100207562*^9}, 3.900758146643773*^9, {3.901009534815013*^9, 
   3.9010095435098443`*^9}, {3.901009600158641*^9, 3.901009613630962*^9}, 
   3.9038822131228104`*^9, {3.903882265491188*^9, 3.903882269410581*^9}, {
   3.917619786968227*^9, 3.9176198137972527`*^9}, {3.9176198451341963`*^9, 
   3.917619848115704*^9}, {3.9176199745586863`*^9, 3.9176199756116776`*^9}, {
   3.91762920977536*^9, 3.9176292126798744`*^9}, {3.917635962855893*^9, 
   3.917635963206185*^9}, {3.917636081895691*^9, 3.9176360994619637`*^9}, {
   3.917670097840538*^9, 3.917670108982366*^9}, {3.917670257593466*^9, 
   3.9176702576742487`*^9}, {3.9265805542877846`*^9, 3.926580565359172*^9}, {
   3.926652833786811*^9, 3.9266528342514467`*^9}, {3.9267382912342353`*^9, 
   3.9267382915543795`*^9}, {3.92675168879504*^9, 3.9267516888634753`*^9}, 
   3.926865863816289*^9, {3.926865915207881*^9, 3.926865921110905*^9}, {
   3.92700063888658*^9, 3.9270006391867476`*^9}, {3.9273630159037104`*^9, 
   3.9273630162428536`*^9}, {3.9273837744826193`*^9, 3.927383774698028*^9}, {
   3.9273839121260905`*^9, 3.927383912276541*^9}, {3.927534119476942*^9, 
   3.9275341197004733`*^9}, {3.9275434509006224`*^9, 3.927543476738414*^9}, {
   3.9418191698814077`*^9, 3.9418191700153723`*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"7fee3c13-3388-47aa-aaf2-1e5edb9c800d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Track Refinement (\[Delta]t > 1, optional)", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.91703999042743*^9, 3.9170400064818554`*^9}},
 FontSize->24,ExpressionUUID->"999f98ec-deb8-4533-b205-e1750468e328"],

Cell["\<\
Last working config:

singletRemovalThreshold=0;

runParameters=Join[
{0,3,#}&/@{15,20,25}
]\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}, 3.900265210171418*^9, 
   3.9004080272102995`*^9, {3.9005691576501884`*^9, 3.9005692341363425`*^9}, {
   3.9005751484783916`*^9, 3.900575151829876*^9}, 3.9005752516464343`*^9, 
   3.9005811586028366`*^9, {3.9005861093764315`*^9, 3.900586124174613*^9}, 
   3.900590521891239*^9, 3.917635664999777*^9},
 FontSize->16,ExpressionUUID->"03e70019-11f3-43e1-8ba4-cb41086e7197"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"singletRemovalThreshold", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"runParameters", "=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "3", ",", "#"}], "}"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"15", ",", "20", ",", "25"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9005176508851247`*^9, 3.900517700794817*^9}, {
   3.9005178261971636`*^9, 3.9005178415949373`*^9}, {3.9005179945199738`*^9, 
   3.900518007563015*^9}, {3.900518105420293*^9, 3.9005181203635774`*^9}, {
   3.900531831113387*^9, 3.9005318469570217`*^9}, {3.9005321073339925`*^9, 
   3.900532109994667*^9}, {3.9005321947208414`*^9, 3.9005321958528476`*^9}, {
   3.900532279919711*^9, 3.9005323321896467`*^9}, {3.900532366415073*^9, 
   3.900532368557638*^9}, {3.9005324350542135`*^9, 3.900532435847437*^9}, {
   3.900532949558832*^9, 3.9005329497017083`*^9}, {3.90053325919941*^9, 
   3.9005332619183445`*^9}, {3.900570001252911*^9, 3.900570002610753*^9}, {
   3.9005701999472804`*^9, 3.9005702062593718`*^9}, {3.9005747593035355`*^9, 
   3.9005747758471537`*^9}, 3.900574963335165*^9, {3.9005751242170815`*^9, 
   3.9005751252443247`*^9}, 3.900575241219746*^9, {3.900581036823209*^9, 
   3.900581037836811*^9}, {3.9005811564537106`*^9, 3.90058116223007*^9}, {
   3.9005812597080193`*^9, 3.9005812598427362`*^9}, {3.9005818550809937`*^9, 
   3.900581872708151*^9}, {3.900581946973035*^9, 3.9005819502922077`*^9}, {
   3.900583791158499*^9, 3.900583824237439*^9}, {3.900584987974312*^9, 
   3.900584988155039*^9}, {3.9005851575439205`*^9, 3.9005851696204276`*^9}, {
   3.9005854051059637`*^9, 3.900585459984561*^9}, {3.9005856758568034`*^9, 
   3.9005856782943287`*^9}, {3.9005859075835505`*^9, 3.900585925770328*^9}, {
   3.9005860057200384`*^9, 3.9005860058153853`*^9}, {3.900586099096962*^9, 
   3.9005861315034657`*^9}, {3.900586217916505*^9, 3.9005862219454193`*^9}, {
   3.900586260120139*^9, 3.900586260254857*^9}, {3.912686819449164*^9, 
   3.9126868378715644`*^9}, {3.91268982979375*^9, 3.9126898604885063`*^9}, {
   3.917040185212904*^9, 3.9170402233466225`*^9}, 3.91704026457934*^9, {
   3.917040409538041*^9, 3.9170404165481887`*^9}, 3.917040696995887*^9, {
   3.91704085055132*^9, 3.9170408517063665`*^9}, {3.9266528743396206`*^9, 
   3.9266528755717497`*^9}},
 CellLabel->
  "In[312]:=",ExpressionUUID->"dcfecb3d-08fd-4138-87ce-c06add2bafd3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bacteriaTracks", ",", "runConvergence"}], "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"runTrackRefinement", "[", 
         RowBox[{"bacteriaTracks", ",", "#"}], "]"}], "&"}], "@", 
       "runParameters"}], "//", "Quiet"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "#"}]}], ",", "#"}], "}"}]}], "&"}], "@", 
     RowBox[{"Last", "@", "runConvergence"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"getLatexStyling", "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<n\>\"", ",", "\"\<N\>\""}], "}"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"Mesh", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
    RowBox[{"MeshStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"PointSize", "@", "0.01"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Length", "/@", "bacteriaTracks"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.900264574761524*^9, 3.900264588506133*^9}, {
   3.900265078498198*^9, 3.9002651006980076`*^9}, {3.9002651835796056`*^9, 
   3.9002651880172977`*^9}, {3.900477583901711*^9, 3.900477612036512*^9}, {
   3.900477645477172*^9, 3.9004776685250206`*^9}, {3.9004784024295187`*^9, 
   3.9004784041629333`*^9}, {3.900478859596779*^9, 3.9004788612224293`*^9}, {
   3.9004803284351263`*^9, 3.9004803309616885`*^9}, {3.900514770072656*^9, 
   3.9005147790688515`*^9}, {3.9005167128832483`*^9, 3.9005167169218454`*^9}, 
   3.9005696017854047`*^9, {3.9005758655673695`*^9, 3.900575871189328*^9}, {
   3.9005855495931225`*^9, 3.9005855668301706`*^9}, 3.9005856724481277`*^9, 
   3.9005858512900267`*^9, {3.900585931025942*^9, 3.900585932478716*^9}, {
   3.912686856564012*^9, 3.9126868664203973`*^9}, {3.912687502892301*^9, 
   3.9126875041888385`*^9}, 3.917040533847085*^9, {3.917625444736014*^9, 
   3.917625448273418*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"b36aa250-7d25-4d6c-b78b-15b0e6f5ee32"]
}, Closed]],

Cell[CellGroupData[{

Cell["Track Cleanup", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.91703999042743*^9, 3.917040017664878*^9}},
 FontSize->24,ExpressionUUID->"59d71f38-4a7c-42c4-a35e-6e598610a7bf"],

Cell["\<\
Defaults :
   
trackLengthThreshold=50;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}, {3.900265210171418*^9, 
   3.900265222082325*^9}, {3.900408037816942*^9, 3.9004080378737907`*^9}},
 FontSize->16,ExpressionUUID->"2d7207b5-33a2-4848-878a-9a33759e244c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trackLengthThreshold", "=", "5"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.900265223740287*^9, 3.9002652238420725`*^9}, {
   3.9002652677069597`*^9, 3.900265267987208*^9}, {3.9002675284405465`*^9, 
   3.900267530256688*^9}, {3.9002684600176954`*^9, 3.9002684818871536`*^9}, {
   3.900325031523388*^9, 3.9003250325636487`*^9}, {3.9003268661698914`*^9, 
   3.9003268663853145`*^9}, 3.900398170171976*^9, {3.900399040946347*^9, 
   3.900399079397722*^9}, 3.9004011594957705`*^9, 3.9004039296796713`*^9, {
   3.9004137348352566`*^9, 3.900413735718841*^9}, {3.9004146355179515`*^9, 
   3.9004146357443457`*^9}, {3.9004276599951105`*^9, 
   3.9004276661895494`*^9}, {3.90043417583022*^9, 3.9004341772125235`*^9}, {
   3.900477707221244*^9, 3.900477707596242*^9}, {3.9004777840126357`*^9, 
   3.900477784978941*^9}, {3.900478313462046*^9, 3.900478313674477*^9}, {
   3.9004885524831915`*^9, 3.9004885592422967`*^9}, {3.9004885991233125`*^9, 
   3.9004885992828856`*^9}, {3.90048937953327*^9, 3.9004893894507923`*^9}, 
   3.900490671020129*^9, {3.9005765784098663`*^9, 3.9005765786073084`*^9}, {
   3.9005813461568565`*^9, 3.900581346227949*^9}, {3.900583534710637*^9, 
   3.900583534945099*^9}, 3.9005849422319417`*^9, {3.9005895108026896`*^9, 
   3.900589510992714*^9}, {3.900589545690627*^9, 3.9005895457177496`*^9}, {
   3.90069017644744*^9, 3.9006901883718004`*^9}, {3.9010064999476852`*^9, 
   3.901006500250963*^9}, {3.9010072761805363`*^9, 3.9010072900120735`*^9}, {
   3.901008363740991*^9, 3.901008364076604*^9}, {3.901016645742159*^9, 
   3.901016654347109*^9}, {3.901017076963785*^9, 3.901017077036702*^9}, {
   3.901094157187654*^9, 3.901094162015312*^9}, {3.901105343801083*^9, 
   3.901105350047829*^9}, 3.901106209176536*^9, 3.9011090604445014`*^9, {
   3.901110071555543*^9, 3.901110078733237*^9}, {3.901112262724823*^9, 
   3.9011122629167347`*^9}, 3.9011129536777673`*^9, 3.901175039748267*^9, 
   3.9011764280138507`*^9, {3.90117682898193*^9, 3.9011768455498238`*^9}, {
   3.901177340983654*^9, 3.9011773421647196`*^9}, 3.901180386497407*^9, {
   3.901180525977207*^9, 3.901180526096727*^9}, {3.9011837666618443`*^9, 
   3.901183766980725*^9}, 3.9038794474450045`*^9, {3.905449315319645*^9, 
   3.905449316529868*^9}, {3.905456954447837*^9, 3.905456957280708*^9}, {
   3.912604668386571*^9, 3.912604670021428*^9}, {3.917040802103508*^9, 
   3.9170408223717937`*^9}, {3.917041243524535*^9, 3.9170412451714125`*^9}, {
   3.9176250904120626`*^9, 3.917625108742225*^9}, {3.917629243045223*^9, 
   3.917629244020074*^9}, 3.926654515831311*^9, 3.9266545617053595`*^9, {
   3.9266616367228155`*^9, 3.9266616695448017`*^9}, {3.926745372345598*^9, 
   3.926745386201048*^9}, 3.9267454271614213`*^9, 3.926745557419753*^9, 
   3.926752087385992*^9, {3.92738700138428*^9, 3.9273870023205214`*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"abfe8584-59d4-436a-89bd-81fada03aa92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bacteriaTracksClean", ",", "bacteriaTrackTimestamps"}], "}"}], 
    "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Last", "/@", "#"}], "&"}], "/@", "#"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "/@", "#"}], "&"}], "/@", "#"}]}], 
       "\[IndentingNewLine]", "}"}], "&"}], "@", 
     RowBox[{"Select", "[", 
      RowBox[{"bacteriaTracks", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "#"}], ">", "trackLengthThreshold"}], "&"}]}],
       "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"bacteriaTracksClean", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "/@", "bacteriaTracksClean"}], "\[IndentingNewLine]", 
 RowBox[{"bacteriaTracksClean", "//", "ListLinePlot"}]}], "Input",
 CellChangeTimes->{
  3.900265157003474*^9, {3.900265254169712*^9, 3.900265257667534*^9}, {
   3.9002723300605135`*^9, 3.9002723311954775`*^9}, {3.900276473937078*^9, 
   3.9002765126106815`*^9}, {3.9002766672749653`*^9, 3.900276675207779*^9}, {
   3.9004020173946323`*^9, 3.9004020182473516`*^9}, {3.900477718404358*^9, 
   3.9004777258943596`*^9}, {3.900477969428753*^9, 3.9004780098296986`*^9}, {
   3.9004782258374043`*^9, 3.900478246002471*^9}, 3.900478289238835*^9, {
   3.9004894723390446`*^9, 3.9004894836517878`*^9}, {3.9004895392590704`*^9, 
   3.9004895446113625`*^9}, {3.9004896117887173`*^9, 3.9004896211536837`*^9}, 
   3.90048967275065*^9, 3.900491461650225*^9, {3.9006901976129637`*^9, 
   3.900690235076126*^9}, {3.9011022239729033`*^9, 3.9011022569975853`*^9}, {
   3.9011036324312353`*^9, 3.901103690271983*^9}, {3.9011752893254957`*^9, 
   3.901175300564514*^9}, {3.90117536465273*^9, 3.901175426778551*^9}, {
   3.9011768588621426`*^9, 3.901176872581365*^9}, {3.9011776620384264`*^9, 
   3.9011776628064566`*^9}, {3.901180399536597*^9, 3.901180407048043*^9}, 
   3.901180452689025*^9, {3.901184346564712*^9, 3.9011843531726217`*^9}, {
   3.9011859431883545`*^9, 3.901185968324256*^9}, {3.9011860114644804`*^9, 
   3.9011860834779816`*^9}, 3.9011882652546263`*^9, {3.905449287049795*^9, 
   3.905449303519285*^9}, {3.9054544323297133`*^9, 3.905454437366556*^9}, {
   3.9054569547439575`*^9, 3.9054569560284953`*^9}, {3.9126877173202124`*^9, 
   3.9126877248555756`*^9}, {3.9126878159538994`*^9, 3.912687829205614*^9}, {
   3.912688989586048*^9, 3.9126889959860325`*^9}, {3.9126891523998036`*^9, 
   3.912689153091897*^9}, 3.9170412416918783`*^9, 3.927476532217944*^9},
 CellLabel->
  "In[317]:=",ExpressionUUID->"b996fb21-f8ae-4ad4-8bbd-0f9ce37aad6c"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Tracks from MHT-X ]]", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.91703999042743*^9, 3.917040017664878*^9}, {
   3.9268580035935583`*^9, 3.9268580075851526`*^9}, {3.9274516561171594`*^9, 
   3.9274516590996685`*^9}},
 FontSize->24,ExpressionUUID->"df62ec4c-b4fc-44ec-b932-0d58a73b5126"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testSequenceFolder", "=", "\"\<23_oct_7\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testDataMainFolder", "=", 
    RowBox[{
    "\"\<D:\\\\Science\\\\MMML\\\\Image Processing\\\\MHT-X\\\\Data for \
Tracking\\\\\>\"", "<>", "testSequenceFolder", "<>", 
     "\"\<\\\\Front view\\\\Tracer Output\\\\\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", "testDataMainFolder"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testDataFolders", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testParameters", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", "\[IndentingNewLine]", 
       RowBox[{
       "testDataMainFolder", "<>", "#", "<>", "$PathnameSeparator", "<>", 
        "\"\<parameters.csv\>\""}], "\[IndentingNewLine]", "]"}], "&"}], "/@",
      "testDataFolders"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testParameterTables", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ToString", "@", "#1"}], "<>", "\"\< = \>\"", "<>", 
            RowBox[{"ToString", "@", "#2"}]}], ")"}], "&"}], "@@", "#"}], 
        "&"}], "/@", "#"}], "&"}], "/@", "testParameters"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testCommonParameters", "=", 
    RowBox[{"Intersection", "@@", "testParameterTables"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"testCommonIndices", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"testParameterTables", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "\[Equal]", 
             RowBox[{"testCommonParameters", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "&"}], ")"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "testCommonParameters"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testVariedParameters", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Delete", "[", 
       RowBox[{"#", ",", "testCommonIndices"}], "]"}], "&"}], "/@", 
     "testParameterTables"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trackLengthThreshold", "=", "5"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.92667377214878*^9, 3.9266738272157736`*^9}, {
   3.926673867046918*^9, 3.926673887649118*^9}, 3.926674288063329*^9, {
   3.926745407177164*^9, 3.9267454078161087`*^9}, {3.926745662417695*^9, 
   3.9267456843455057`*^9}, {3.926745813320904*^9, 3.926745878544973*^9}, {
   3.9267517194476876`*^9, 3.926751720091151*^9}, {3.926758000775349*^9, 
   3.9267580009371834`*^9}, {3.9267697124355764`*^9, 3.926769724530121*^9}, {
   3.9267702171285567`*^9, 3.926770217691797*^9}, 3.9267841465628104`*^9, {
   3.9268351191661263`*^9, 3.926835121884968*^9}, {3.92685325355462*^9, 
   3.9268532539307146`*^9}, 3.9268599520728426`*^9, {3.9268605411599936`*^9, 
   3.9268605447132087`*^9}, {3.926868905664034*^9, 3.9268689290122757`*^9}, {
   3.9268718629037027`*^9, 3.926871867765608*^9}, {3.9268719007603693`*^9, 
   3.9268719008460255`*^9}, {3.926871951214758*^9, 3.926871968247184*^9}, {
   3.926996917261155*^9, 3.9269969173479347`*^9}, {3.9269973333002477`*^9, 
   3.9269973346915464`*^9}, {3.9270008236046686`*^9, 3.927000823718089*^9}, {
   3.927004787355993*^9, 3.9270047878451233`*^9}, 3.9273650072008533`*^9, 
   3.9273802226515045`*^9, {3.927383792202119*^9, 3.927383792533443*^9}, 
   3.927387017963785*^9, 3.9273874263078127`*^9, 3.9274375545282774`*^9, 
   3.9274765386972437`*^9, 3.9275313103096647`*^9, 3.9275445194759073`*^9, 
   3.927804019697564*^9, {3.9278093856249475`*^9, 3.927809386357917*^9}, 
   3.9278140008267803`*^9, 3.9278152280494056`*^9, 3.9386869593945417`*^9, {
   3.9386871698191605`*^9, 3.938687170132866*^9}, {3.9387463657737627`*^9, 
   3.9387463820224943`*^9}, {3.938876732242543*^9, 3.9388767335632725`*^9}, {
   3.9391104087619023`*^9, 3.939110408978527*^9}, 3.939194516467411*^9, {
   3.939195114605954*^9, 3.939195137774846*^9}, 3.9392054411313076`*^9, 
   3.939209329686261*^9, 3.95129237447744*^9, 3.9517339744232283`*^9, 
   3.951735258309619*^9, 3.9517355936434474`*^9, 3.9517963160684204`*^9, 
   3.9518325579745584`*^9, 3.951876219579156*^9, 3.9525682305687857`*^9, 
   3.952572981249031*^9, 3.95257789919561*^9, 3.9525788351966877`*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"bd611090-ff5e-40b8-99b1-850600c4f95e"],

Cell[CellGroupData[{

Cell["Preview All MHT-X Tracks", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.91703999042743*^9, 3.917040017664878*^9}, {
   3.9268580035935583`*^9, 3.9268580075851526`*^9}, {3.9274516561171594`*^9, 
   3.9274516590996685`*^9}, {3.9391921536667013`*^9, 3.939192161386927*^9}},
 FontSize->24,ExpressionUUID->"e71d650e-b5f5-4396-a99b-1b1c515f1247"],

Cell["If the plot shows up as empty, simply run the cell again.", "Abstract",
 CellChangeTimes->{{3.938876904782802*^9, 3.9388769198917837`*^9}, {
  3.9388769772486176`*^9, 3.93887698625082*^9}, {3.952573220829854*^9, 
  3.9525732420706406`*^9}},ExpressionUUID->"cbb62edb-fa52-47fe-8996-\
b0e8fc6393c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tablePartitionSize", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"showTrackCount", "=", 
    RowBox[{"Min", "[", 
     RowBox[{"200", ",", 
      RowBox[{"Length", "@", "testTracksMHTclean"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"{", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetterBar", "[", 
    RowBox[{
     RowBox[{"Dynamic", "@", "dynamicSelector"}], ",", "testDataFolders", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Row\>\""}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Dynamic", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"testWXFtracks", "=", 
      RowBox[{"Import", "[", 
       RowBox[{
       "testDataMainFolder", "<>", "dynamicSelector", "<>", 
        "$PathnameSeparator", "<>", 
        "\"\<trajectories\\\\trajectories.wxf\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"testTracksWithTime", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3", ",", "4"}], "}"}], "]"}], "]"}]}], "&"}],
          "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Normal", "@", "#"}]}]}], "&"}], "/@", 
       RowBox[{"testWXFtracks", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", "All"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"testTracks", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}], "]"}], "]"}]}], "&"}], "@", 
         RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", 
       "testTracksWithTime"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"testTracksMHTclean", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"testTracks", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "#"}], ">", "trackLengthThreshold"}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"testTracksMHTclean", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "showTrackCount"}], "]"}], "]"}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"TableForm", "/@", 
             RowBox[{"TakeList", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ConstantArray", "[", "\[IndentingNewLine]", 
                   RowBox[{"tablePartitionSize", ",", 
                    RowBox[{"Floor", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"First", "@", "testVariedParameters"}]}], "/", 
                    "tablePartitionSize"}], "]"}]}], "\[IndentingNewLine]", 
                   "]"}], ",", "All"}], "}"}]}]}], "\[IndentingNewLine]", 
              "]"}]}], "&"}], "@", 
           RowBox[{"First", "@", 
            RowBox[{"testVariedParameters", "[", 
             RowBox[{"[", "\[IndentingNewLine]", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Position", "[", 
                RowBox[{"testDataFolders", ",", 
                 RowBox[{"_", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", "\[Equal]", "dynamicSelector"}], "&"}], 
                   ")"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
             "]"}]}]}], ",", 
          RowBox[{"TableDirections", "\[Rule]", "Row"}]}], "]"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"11", ",", "Black", ",", "Bold"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "}"}]}], "Input",
 CellChangeTimes->{{3.926674211258257*^9, 3.9266742166252966`*^9}, {
   3.92667426342272*^9, 3.926674265464847*^9}, {3.9266743095042453`*^9, 
   3.926674396801014*^9}, {3.9266744310721025`*^9, 3.926674458926072*^9}, {
   3.9267452113128576`*^9, 3.9267452498565454`*^9}, {3.9267453022643023`*^9, 
   3.926745358135821*^9}, 3.926745680042969*^9, {3.92675272941461*^9, 
   3.9267527309425216`*^9}, {3.9267574749192357`*^9, 3.926757575377079*^9}, {
   3.9267577014585114`*^9, 3.9267577030949764`*^9}, {3.92675776274755*^9, 
   3.926757826161547*^9}, {3.926757868808163*^9, 3.926757973407089*^9}, {
   3.9267580154618235`*^9, 3.926758016518094*^9}, {3.926758178904414*^9, 
   3.926758306831088*^9}, {3.9267597521673994`*^9, 3.9267597634989486`*^9}, {
   3.9267598033134837`*^9, 3.9267598305503597`*^9}, {3.926759887931244*^9, 
   3.9267599111050725`*^9}, {3.9267601133359537`*^9, 3.9267601134875402`*^9}, 
   3.9267697155576887`*^9, {3.9267701241660147`*^9, 3.92677018523627*^9}, {
   3.9267702271034384`*^9, 3.926770325396291*^9}, {3.9267703949114337`*^9, 
   3.926770431696272*^9}, {3.9267704784533978`*^9, 3.926770508836352*^9}, {
   3.926835185613745*^9, 3.9268352881656494`*^9}, {3.9268583254738235`*^9, 
   3.9268583303937206`*^9}, {3.926860077357422*^9, 3.9268600830540633`*^9}, {
   3.926860113668803*^9, 3.9268601148167896`*^9}, {3.9268601605059705`*^9, 
   3.926860160609969*^9}, {3.926860549074869*^9, 3.9268605574177413`*^9}, {
   3.9268690727310247`*^9, 3.926869072975231*^9}, 3.926878054815418*^9, {
   3.92699642967826*^9, 3.9269964297321167`*^9}, {3.9270041747245336`*^9, 
   3.9270041747923517`*^9}, {3.927006585299698*^9, 3.927006600146146*^9}, {
   3.92700840467447*^9, 3.927008415970406*^9}, {3.927806379495101*^9, 
   3.927806386454382*^9}, {3.9278079384697776`*^9, 3.9278079467103434`*^9}, {
   3.92780799377108*^9, 3.9278080198407593`*^9}, {3.927815248911111*^9, 
   3.927815327499234*^9}, {3.939962166731058*^9, 3.9399621690459642`*^9}, {
   3.951292382004866*^9, 3.9512923904125967`*^9}, {3.951795298924401*^9, 
   3.9517953003809457`*^9}, {3.9518762406988688`*^9, 3.951876240929492*^9}, {
   3.9525789103718214`*^9, 3.952578923027654*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"4671006c-fe4b-4116-a535-561479e260da"]
}, Closed]],

Cell[CellGroupData[{

Cell["Get Clean Tracks by Temporal/Spatial Length", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.91703999042743*^9, 3.917040017664878*^9}, {
   3.9268580035935583`*^9, 3.9268580075851526`*^9}, {3.9274516561171594`*^9, 
   3.9274516590996685`*^9}, {3.9391921536667013`*^9, 3.939192196282396*^9}},
 FontSize->24,ExpressionUUID->"64e09817-15a7-4c9a-ac1f-24ac8ff5c970"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bacteriaTracksCleanMHT", ",", "bacteriaTrackTimestampsMHT"}], 
     "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Last", "/@", "#"}], "&"}], "/@", "#"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "/@", "#"}], "&"}], "/@", "#"}]}], 
       "\[IndentingNewLine]", "}"}], "&"}], "@", 
     RowBox[{"Select", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "@", "#"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;", "3"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          "#"}], "&"}], "/@", "testTracksWithTime"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "#"}], ">", "trackLengthThreshold"}], "&"}]}],
       "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}], "@", 
  RowBox[{"bacteriaTracksCleanMHT", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "showTrackCount"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.927008149304957*^9, 3.927008155121957*^9}, {
   3.927008326930312*^9, 3.9270083340329933`*^9}, {3.9270083927455015`*^9, 
   3.927008425867917*^9}, {3.9270084698665123`*^9, 3.927008481769876*^9}, 
   3.9270085189546757`*^9, 3.927008602147147*^9, 3.92700876112858*^9, {
   3.9399621901529493`*^9, 3.9399621960257626`*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"0ebbc99c-c379-4c13-9e56-1dad16ba4a23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tracksByPhysicalLength", ",", "timestampsByPhyscalLength"}], 
     "}"}], "=", 
    RowBox[{"ReverseSortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testTracksMHTclean", ",", "bacteriaTrackTimestampsMHT"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Norm", "/@", 
         RowBox[{"Differences", "@", 
          RowBox[{"First", "@", "#"}]}]}], "]"}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Mesh", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
    RowBox[{"tracksByPhysicalLength", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "tracksByPhysicalLength"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.927804202938831*^9, 3.9278042961991215`*^9}, {
   3.927804371739297*^9, 3.9278044237192745`*^9}, {3.9278064197357016`*^9, 
   3.9278064246864624`*^9}, {3.927813557845792*^9, 3.9278135585224037`*^9}, {
   3.9278136013260174`*^9, 3.927813602025663*^9}, 3.9278155064783397`*^9, 
   3.927815546108486*^9, 3.9278157400578947`*^9, 3.938687229340481*^9, {
   3.9387785514045496`*^9, 3.93877864664758*^9}, 3.938787690758867*^9, 
   3.938789003189969*^9, {3.938876608097395*^9, 3.938876633995688*^9}, {
   3.938876684084676*^9, 3.9388766856457043`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"eb9689ad-3d48-45d1-aaf3-545efefa1ef1"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Mesh", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
    RowBox[{"bacteriaTracksCleanMHT", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "bacteriaTracksCleanMHT"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9391103302988667`*^9, 3.939110354491026*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"01a1b047-22a5-4fd1-8190-a6803451f207"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Tracks with MTB Shape Overlays ]]", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.91703999042743*^9, 3.917040017664878*^9}, {
   3.9268580035935583`*^9, 3.9268580075851526`*^9}, {3.9274516561171594`*^9, 
   3.9274516590996685`*^9}, {3.9391921536667013`*^9, 3.939192207217124*^9}, {
   3.939192237417778*^9, 3.9391922445781083`*^9}},
 FontSize->24,ExpressionUUID->"05a82a43-c939-4e6f-82aa-3379263582cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imagesCorrected", "=", "croppedImages"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotationSwitch", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trackTestIDs", "=", 
   RowBox[{"{", "1", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.93910998984914*^9, 3.9391099923530445`*^9}, {
   3.939186479003913*^9, 3.939186509006324*^9}, 3.9391922847425222`*^9, {
   3.939192461900451*^9, 3.9391924649244623`*^9}, {3.939199522361745*^9, 
   3.93919952247981*^9}, {3.9392061104620657`*^9, 3.9392061107566385`*^9}, 
   3.9392099365547523`*^9, 3.9517950520508375`*^9, {3.9518763016896777`*^9, 
   3.9518763019015703`*^9}, 3.9525682958062596`*^9, {3.9525689893856764`*^9, 
   3.9525689895106573`*^9}, {3.9525692964396935`*^9, 3.9525692974128637`*^9}, 
   3.9525693830722065`*^9, {3.9525734290721846`*^9, 3.9525734304091644`*^9}, {
   3.9525780085624294`*^9, 3.952578008665455*^9}, 3.9525789766055393`*^9},
 CellLabel->
  "In[182]:=",ExpressionUUID->"13553c55-2d04-475e-8e7d-6f0453bc7428"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testTrack", "=", 
   RowBox[{"tracksByPhysicalLength", "[", 
    RowBox[{"[", 
     RowBox[{"First", "@", "trackTestIDs"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testPlotRange", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "#"}], "}"}], "&"}], "/@", 
     RowBox[{"ImageDimensions", "@", 
      RowBox[{"First", "@", "croppedImages"}]}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testTrackImages", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"imagesCorrected", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
     RowBox[{"timestampsByPhyscalLength", "[", 
      RowBox[{"[", 
       RowBox[{"First", "@", "trackTestIDs"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testTrackShapes", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"bacteriaMasksClean", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
     RowBox[{"timestampsByPhyscalLength", "[", 
      RowBox[{"[", 
       RowBox[{"First", "@", "trackTestIDs"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"testTrackImages", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tracksByPhysicalLength", "[", 
   RowBox[{"[", "trackTestIDs", "]"}], "]"}], "//", "Length"}], "\n", 
 RowBox[{
  RowBox[{"timestampsByPhyscalLength", "[", 
   RowBox[{"[", 
    RowBox[{"First", "@", "trackTestIDs"}], "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"PlotRange", "\[Rule]", "testPlotRange"}]}], "]"}], "&"}], "@", 
  "testTrack"}]}], "Input",
 CellChangeTimes->{{3.939029279723569*^9, 3.9390294090214643`*^9}, {
   3.9390361339362707`*^9, 3.9390361343147144`*^9}, {3.939037158831633*^9, 
   3.93903721274603*^9}, 3.9390405390522304`*^9, {3.939186483172328*^9, 
   3.9391864876307516`*^9}, {3.9391924605185575`*^9, 3.939192472265884*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"09e5cb60-1050-4d64-8ce0-92adc6fa4292"],

Cell["\<\
Defaults:

erosionScaleShapes=1;\
\>", "Abstract",
 CellChangeTimes->{{3.938876904782802*^9, 3.9388769198917837`*^9}, {
  3.9388769772486176`*^9, 3.93887698625082*^9}, {3.9525688414613857`*^9, 
  3.952568845632072*^9}},ExpressionUUID->"3b78ae5c-f002-46a6-a3b2-\
0d6f19f240b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"erosionScaleShapes", "=", "1"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.939192435315742*^9, 3.9391924470904603`*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"30ab5ce6-1e06-419f-9c72-0bc3941405bf"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rotateImage", "@", 
         RowBox[{"ImageAdjust", "@", 
          RowBox[{"testTrackImages", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "@", "0.001"}], ",", 
          RowBox[{"Opacity", "@", "1"}], ",", "Red", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ImageMarker", "[", 
               RowBox[{"#", ",", "\"\<Cross\>\""}], "]"}], "&"}], "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "&"}], "@", "testTrack"}]}], 
         "}"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"PlotRange", "\[Rule]", "testPlotRange"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"{", 
             RowBox[{"Thin", ",", "Dashed", ",", "Red"}], "}"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", "testTrack"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "testTrack"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.938687429773093*^9, 3.9386874567724085`*^9}, {
   3.9386874915654345`*^9, 3.93868756682076*^9}, {3.9386876090040736`*^9, 
   3.9386876131953526`*^9}, {3.938687723813916*^9, 3.9386877690642333`*^9}, {
   3.938745604349735*^9, 3.9387456149484587`*^9}, {3.938745678126088*^9, 
   3.938745689940188*^9}, {3.9388772199082007`*^9, 3.9388772363993835`*^9}, {
   3.9390309482788954`*^9, 3.9390309684890103`*^9}, {3.9390342075938187`*^9, 
   3.9390342101617084`*^9}, {3.939034277792943*^9, 3.9390342858249736`*^9}, {
   3.9390372208586845`*^9, 3.93903724065067*^9}, {3.939040553220546*^9, 
   3.9390405541156607`*^9}, 3.93919254294748*^9},
 CellLabel->
  "In[194]:=",ExpressionUUID->"f70fe180-70ab-4b03-be59-47dd42477ca4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"testRealMasks", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getRealMask", "[", 
       RowBox[{
       "testTrackShapes", ",", "testTrack", ",", "#", ",", 
        "erosionScaleShapes"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "testTrack"}]}]}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.9390380633007965`*^9, 3.939038116602418*^9}, {
  3.9390387745235868`*^9, 3.939038841585552*^9}, {3.9390389349708548`*^9, 
  3.9390389633511815`*^9}, {3.9391924272586536`*^9, 3.9391924511634316`*^9}, {
  3.9391925927482624`*^9, 3.9391925941949043`*^9}, {3.951795204875553*^9, 
  3.9517952118240767`*^9}, {3.9517953456755795`*^9, 3.95179534601863*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"2fae5440-f099-44ad-a30f-e7a5fd6d51cc"],

Cell["\<\
Defaults:

trackRegionPadding=25;
trackImageDownscaleFactor=2;
trackShapeOverlayIDs=Range[1,Length@testRealMasks,1];\
\>", "Abstract",
 CellChangeTimes->{{3.938876904782802*^9, 3.9388769198917837`*^9}, {
  3.9388769772486176`*^9, 3.93887698625082*^9}, {3.9525688414613857`*^9, 
  3.9525688562564635`*^9}},ExpressionUUID->"3b751cc0-bae7-4553-a7db-\
69d12ecc5a01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trackRegionPadding", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trackImageDownscaleFactor", "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trackShapeOverlayIDs", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Length", "@", "testRealMasks"}], ",", "5"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.939192612900695*^9, 3.939192643963374*^9}, {
   3.939192674754492*^9, 3.93919268864242*^9}, {3.939199599664002*^9, 
   3.9391996922879105`*^9}, {3.93920613875705*^9, 3.93920624069163*^9}, {
   3.939209997407647*^9, 3.9392100514859176`*^9}, {3.951795428131682*^9, 
   3.951795449330649*^9}, {3.9517954954199953`*^9, 3.9517955535707374`*^9}, {
   3.951876335136999*^9, 3.951876373849492*^9}, 3.9525687046583605`*^9, 
   3.952568772335254*^9, {3.9525793494680357`*^9, 3.952579359333205*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"5dab7c26-63e9-45f9-bfdc-778d77d93102"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"trackImageCropBounds", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#1", "-", "trackRegionPadding"}], ",", 
        RowBox[{"#2", "+", "trackRegionPadding"}]}], "}"}], "&"}], "@@", 
     RowBox[{"BoundingRegion", "[", 
      RowBox[{"testTrack", ",", "\"\<MinRectangle\>\""}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"viewImage", "@", 
      RowBox[{"ImageTrim", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"Round", "[", 
         RowBox[{"trackImageCropBounds", "/", "trackImageDownscaleFactor"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
    RowBox[{"Image", "[", "\[IndentingNewLine]", 
     RowBox[{"#", ",", "Byte", ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{
        RowBox[{"ImageDimensions", "@", 
         RowBox[{"First", "@", "testTrackImages"}]}], "/", 
        "trackImageDownscaleFactor"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "&"}], "@", 
  RowBox[{"Show", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ImageAdd", "@@", 
       RowBox[{"testRealMasks", "[", 
        RowBox[{"[", "trackShapeOverlayIDs", "]"}], "]"}]}], "//", 
      "rotateImage"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", 
         RowBox[{"PlotRange", "\[Rule]", "testPlotRange"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Dashing", "[", 
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{"0.01", "-", "#"}]}], "}"}], "]"}], "&"}], "@", 
              "0.005"}], ",", 
             RowBox[{"Darker", "@", "Red"}]}], "}"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], "@", "testTrack"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9390414808437815`*^9, 3.939041509572923*^9}, {
   3.939041592356964*^9, 3.9390416087556725`*^9}, {3.939041651533513*^9, 
   3.9390416966594715`*^9}, {3.939110086331787*^9, 3.939110087561238*^9}, 
   3.939192603858352*^9, {3.9391926483751917`*^9, 3.9391926912672973`*^9}, {
   3.9525687117762556`*^9, 3.952568716101965*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"13ed54ac-c320-49bb-8633-9b5e196aef5a"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"viewImage", "@", 
        RowBox[{"ImageTrim", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"Round", "[", 
           RowBox[{"trackImageCropBounds", "/", "trackImageDownscaleFactor"}],
            "]"}]}], "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
      RowBox[{"Image", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", "Byte", ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{
          RowBox[{"ImageDimensions", "@", 
           RowBox[{"First", "@", "testTrackImages"}]}], "/", 
          "trackImageDownscaleFactor"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "&"}], "@", 
    RowBox[{"Show", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rotateImage", "@", 
        RowBox[{"testRealMasks", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{"PlotRange", "\[Rule]", "testPlotRange"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"{", 
              RowBox[{"Thin", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dashing", "[", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"0.01", "-", "#"}]}], "}"}], "]"}], "&"}], "@", 
                "0.005"}], ",", 
               RowBox[{"Darker", "@", "Red"}]}], "}"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "@", "testTrack"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "testTrack"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.938687429773093*^9, 3.9386874567724085`*^9}, {
   3.9386874915654345`*^9, 3.93868756682076*^9}, {3.9386876090040736`*^9, 
   3.9386876131953526`*^9}, {3.938687723813916*^9, 3.9386877690642333`*^9}, {
   3.938745604349735*^9, 3.9387456149484587`*^9}, {3.938745678126088*^9, 
   3.938745689940188*^9}, {3.9388772199082007`*^9, 3.9388772363993835`*^9}, {
   3.9390309482788954`*^9, 3.9390309684890103`*^9}, {3.9390342075938187`*^9, 
   3.9390342101617084`*^9}, {3.939034277792943*^9, 3.9390342858249736`*^9}, {
   3.9390354577239385`*^9, 3.939035472240638*^9}, {3.93903551752957*^9, 
   3.9390356138578424`*^9}, 3.939035679141534*^9, {3.9390358217453575`*^9, 
   3.9390358218556643`*^9}, {3.9390365997545557`*^9, 
   3.9390366062487106`*^9}, {3.9390366720661135`*^9, 3.939036676578268*^9}, {
   3.9390377537331343`*^9, 3.939037805259976*^9}, {3.9390378417084055`*^9, 
   3.9390378449543943`*^9}, {3.939038132236762*^9, 3.939038136914085*^9}, {
   3.9390388126790786`*^9, 3.9390388216791964`*^9}, {3.9390399880135207`*^9, 
   3.9390399888516593`*^9}, {3.939192702774149*^9, 3.9391927230760655`*^9}, {
   3.939192786284525*^9, 3.939192786651112*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"ddd02268-ec2e-4ecc-b8ed-50f866443cd2"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"viewImage", "@", 
        RowBox[{"ImageTrim", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"Round", "[", 
           RowBox[{"trackImageCropBounds", "/", "trackImageDownscaleFactor"}],
            "]"}]}], "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
      RowBox[{"Image", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", "Byte", ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{
          RowBox[{"ImageDimensions", "@", 
           RowBox[{"First", "@", "testTrackImages"}]}], "/", 
          "trackImageDownscaleFactor"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "&"}], "@", 
    RowBox[{"Show", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rotateImage", "@", 
          RowBox[{"ImageAdjust", "@", 
           RowBox[{"testTrackImages", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageMarker", "[", 
          RowBox[{
           RowBox[{"testTrack", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Cross\>\""}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{"PlotRange", "\[Rule]", "testPlotRange"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"{", 
              RowBox[{"Thin", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dashing", "[", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"0.01", "-", "#"}]}], "}"}], "]"}], "&"}], "@", 
                "0.005"}], ",", 
               RowBox[{"Darker", "@", "Red"}]}], "}"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "@", "testTrack"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "testTrack"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.938687429773093*^9, 3.9386874567724085`*^9}, {
   3.9386874915654345`*^9, 3.93868756682076*^9}, {3.9386876090040736`*^9, 
   3.9386876131953526`*^9}, {3.938687723813916*^9, 3.9386877690642333`*^9}, {
   3.938745604349735*^9, 3.9387456149484587`*^9}, {3.938745678126088*^9, 
   3.938745689940188*^9}, {3.9388772199082007`*^9, 3.9388772363993835`*^9}, {
   3.9390309482788954`*^9, 3.9390309684890103`*^9}, {3.9390342075938187`*^9, 
   3.9390342101617084`*^9}, {3.939034277792943*^9, 3.9390342858249736`*^9}, {
   3.9390354577239385`*^9, 3.939035472240638*^9}, {3.93903551752957*^9, 
   3.9390356138578424`*^9}, 3.939035679141534*^9, {3.9390358217453575`*^9, 
   3.9390358218556643`*^9}, {3.93904183241488*^9, 3.9390418325892334`*^9}, {
   3.939192707452178*^9, 3.9391927350988884`*^9}, {3.9391928011642575`*^9, 
   3.939192867228726*^9}, {3.9391929583258066`*^9, 3.939193029029195*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"0bbb1b6b-e081-4508-8c65-a94f0703bce8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"trackImageDownscaleFactorExport", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotTrackVisuals", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ImageTrim", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"Round", "[", 
           RowBox[{
           "trackImageCropBounds", "/", "trackImageDownscaleFactorExport"}], 
           "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
       RowBox[{"Image", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", "Byte", ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{
           RowBox[{"ImageDimensions", "@", 
            RowBox[{"First", "@", "testTrackImages"}]}], "/", 
           "trackImageDownscaleFactorExport"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "&"}], "@", 
     RowBox[{"Show", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rotateImage", "@", 
         RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ColorToneMapping", "@", 
            RowBox[{"ImageAdjust", "@", 
             RowBox[{"testTrackImages", "[", 
              RowBox[{"[", 
               RowBox[{"Last", "@", "trackShapeOverlayIDs"}], "]"}], 
              "]"}]}]}], ",", 
           RowBox[{"ImageAdd", "@@", 
            RowBox[{"testRealMasks", "[", 
             RowBox[{"[", "trackShapeOverlayIDs", "]"}], "]"}]}], ",", 
           "White", ",", "1.5"}], "\[IndentingNewLine]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", 
            RowBox[{"PlotRange", "\[Rule]", "testPlotRange"}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "@", "0.0015"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dashing", "[", 
                   RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"0.01", "-", "#"}]}], "}"}], "]"}], "&"}], "@", 
                 "0.005"}], ",", 
                RowBox[{"Darker", "@", "Red"}]}], "}"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], "@", "testTrack"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"viewImage", "@", "plotTrackVisuals"}]}], "Input",
 CellChangeTimes->{{3.9390414808437815`*^9, 3.939041509572923*^9}, {
  3.939041592356964*^9, 3.9390416087556725`*^9}, {3.939041651533513*^9, 
  3.9390416966594715`*^9}, {3.939041770717003*^9, 3.939041807692475*^9}, {
  3.939041839038972*^9, 3.939041870444784*^9}, {3.9390419050136375`*^9, 
  3.939042065077112*^9}, {3.939042177389324*^9, 3.9390422561877313`*^9}, {
  3.9390423105346737`*^9, 3.939042320940258*^9}, {3.939199722289874*^9, 
  3.9391998182714477`*^9}, {3.939201808642936*^9, 3.9392018133992906`*^9}, {
  3.9525691138302984`*^9, 3.952569123668542*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"dce8626e-3c06-405e-ac52-93f2099c43f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<track_\>\"", "<>", 
     RowBox[{"ToString", "@", 
      RowBox[{"First", "@", "trackTestIDs"}]}], "<>", 
     "\"\<_contours.png\>\""}], ",", "plotTrackVisuals"}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9390420814415674`*^9, 3.9390420839826136`*^9}, {
   3.9390421151875734`*^9, 3.939042159812103*^9}, 3.939042342443385*^9, 
   3.9391100541035633`*^9, {3.952569131657283*^9, 3.9525691498531933`*^9}, 
   3.9525692239489527`*^9},
 CellLabel->
  "In[226]:=",ExpressionUUID->"14351500-7c91-45b2-a402-e06e18fc50a1"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Track Data >>", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.91703999042743*^9, 3.917040017664878*^9}, {
   3.9268580035935583`*^9, 3.9268580234955997`*^9}},
 FontSize->24,ExpressionUUID->"a19d602d-3682-42b2-b407-13e492342496"],

Cell[CellGroupData[{

Cell["<< Export Clean Bacteria Tracks & Timestamps >>", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.9004083591173897`*^9, 3.9004083714014845`*^9}, {3.9004084501855927`*^9, 
  3.9004084564578943`*^9}, {3.9170415507944126`*^9, 
  3.917041551802916*^9}},ExpressionUUID->"e6c87574-8e2f-4693-8348-\
c34a358fbae1"],

Cell["\<\
Defaults :
   
useMHTtracks=0;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}, {3.900265210171418*^9, 
   3.900265222082325*^9}, {3.900408037816942*^9, 3.9004080378737907`*^9}, {
   3.9269974478024187`*^9, 3.926997449885894*^9}},
 FontSize->16,ExpressionUUID->"6a90a8bc-fc39-4130-99fd-1d62ca80b8c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"useMHTtracks", "=", "1"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9269974092617455`*^9, 3.9269974450751877`*^9}, {
  3.927008659441693*^9, 3.9270086859393167`*^9}, {3.927008782361928*^9, 
  3.927008787289964*^9}, {3.9278093122098417`*^9, 3.92780931313249*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"37034ed4-1879-4b92-bc6f-f7da8b8a9225"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"useMHTtracks", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bacteriaTracksClean", ",", "bacteriaTrackTimestamps"}], "}"}],
       "=", 
      RowBox[{"{", 
       RowBox[{"bacteriaTracksCleanMHT", ",", "bacteriaTrackTimestampsMHT"}], 
       "}"}]}], ",", "\[IndentingNewLine]", "Nothing"}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}], "@", 
  RowBox[{"bacteriaTracksClean", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "showTrackCount"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.927008525214287*^9, 3.927008597918091*^9}, {
  3.9270086340894146`*^9, 3.927008676388774*^9}, {3.9270087680585127`*^9, 
  3.9270087684833736`*^9}, {3.9399622290725803`*^9, 3.939962234575694*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"d927bf49-3f01-4dab-8d72-d7204b9cc117"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "dataCompressedfolder", "<>", "\"\<Bacteria Tracks Timestamps.txt\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Compress", "@", 
      RowBox[{"{", 
       RowBox[{"bacteriaTracksClean", ",", "bacteriaTrackTimestamps"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataTracksFolder", "=", 
   RowBox[{"dataCSVfolder", "<>", "\"\<Track Data\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "dataTracksFolder"}], ";"}], "//", 
   "Quiet"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dataTracksFolder", "<>", "\"\<Track_\>\"", "<>", 
        RowBox[{"ToString", "@", "#"}], "<>", "\"\<_XY_only.csv\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"bacteriaTracksClean", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], "&"}],
     "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "bacteriaTracksClean"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trackDataUnified", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "/@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}]}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"bacteriaTrackTimestamps", ",", "bacteriaTracksClean"}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataTracksFolder", "<>", "\"\<Track_\>\"", "<>", 
       RowBox[{"ToString", "@", "#"}], "<>", "\"\<_(t,x,y).csv\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"trackDataUnified", "[", 
       RowBox[{"[", "#", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], 
   "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "trackDataUnified"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8903915643219943`*^9, 3.890391614698898*^9}, {
   3.900408423921915*^9, 3.900408436086995*^9}, {3.9004084695618296`*^9, 
   3.900408479681055*^9}, {3.900408511140123*^9, 3.900408515721835*^9}, {
   3.9004112146085463`*^9, 3.90041121488974*^9}, 3.900414264360875*^9, {
   3.9094005617702794`*^9, 3.9094005671113453`*^9}, {3.917041529378869*^9, 
   3.917041557444667*^9}, {3.917041770685213*^9, 3.9170417733015437`*^9}, {
   3.9170419537648125`*^9, 3.917041956610948*^9}, {3.927808520285831*^9, 
   3.927808521671866*^9}, 3.938877677203899*^9, 3.93887773586998*^9},
 CellLabel->
  "In[179]:=",ExpressionUUID->"757211b0-6027-42f7-b5cd-607355beae7a"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Clean Bacteria Tracks & Timestamps <<", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.9004083591173897`*^9, 3.9004083714014845`*^9}, {3.9004084501855927`*^9, 
  3.9004084564578943`*^9}, {3.9170415507944126`*^9, 3.917041551802916*^9}, {
  3.917635862072339*^9, 
  3.9176358719803247`*^9}},ExpressionUUID->"a67707dc-e65d-4ab2-9263-\
2b967a2cd363"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bacteriaTracksClean", ",", "bacteriaTrackTimestamps"}], "}"}], 
   "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "dataCompressedfolder", "<>", "\"\<Bacteria Tracks Timestamps.txt\>\""}],
      "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.917635898340686*^9, 3.917635910382876*^9}, 
   3.9278085500060825`*^9},
 CellLabel->
  "In[243]:=",ExpressionUUID->"d0504684-0251-448a-a1d7-8fc2bb358fa8"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Property Tracking", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.91703999042743*^9, 3.917040017664878*^9}, {
   3.9176292901266065`*^9, 3.9176292923789043`*^9}},
 FontSize->24,ExpressionUUID->"bd36558d-a5cd-411b-b6a1-e7eb12bf8b55"],

Cell[CellGroupData[{

Cell["Sort Properties By Tracks", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.9004083591173897`*^9, 3.9004083714014845`*^9}, {3.9004084501855927`*^9, 
  3.9004084564578943`*^9}, {3.9170415507944126`*^9, 3.917041551802916*^9}, {
  3.917635098236889*^9, 3.9176351049970627`*^9}, {3.927451717923957*^9, 
  3.927451734100955*^9}},ExpressionUUID->"f367133f-dcae-4fdc-86fb-\
00b0df95ada0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bacteriaCentroidsUnified", ",", "bacteriaRadiiUnified"}], "}"}],
     "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"bacteriaCentroidsResolved", ",", "bacteriaRadiiResolved"}], 
      "}"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"bacteriaTrackDataIDs", "=", 
       RowBox[{"Flatten", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Parallelize", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"monitorCounter", "++"}], ";", 
                RowBox[{"getMatchingIndex", "[", 
                 RowBox[{"bacteriaCentroidsUnified", ",", "#"}], "]"}]}], 
               ")"}], "&"}], "/@", "#"}], "\[IndentingNewLine]", "]"}], "&"}],
           "/@", "bacteriaTracksClean"}], ")"}]}]}], ";"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{
        RowBox[{"Length", "/@", "bacteriaTracksClean"}], "//", "Total"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaRadiiByTrack", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"bacteriaRadiiUnified", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
     "bacteriaTrackDataIDs"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"bacteriaRadiiByTrackCorrected", " ", "--"}], " ", "QUICK"}], 
      " ", "&"}], " ", "DIRTY", " ", "FIX"}], ",", " ", 
    RowBox[{
     RowBox[{"MAY", " ", "OR", " ", "MAY", " ", "NOT", " ", "BACKFIRE"}], ";",
      " ", 
     RowBox[{"POSSIBLE", " ", "SOURCE", " ", "OF", " ", "UNEVEN", " ", 
      RowBox[{"LENGTH", ":", " ", 
       RowBox[{"getResolvedRadii", " ", "FUNCTION"}]}]}]}]}], "*)"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaRadiiByTrackCorrected", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"bacteriaRadiiByTrack", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", 
           RowBox[{"1", ";;", "#"}]}], "]"}], "]"}], "&"}], "@", 
       RowBox[{"Length", "@", 
        RowBox[{"bacteriaTrackTimestamps", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "bacteriaTrackTimestamps"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"trackDataUnifiedRadii", "=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "/@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", "##", "}"}]}]}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "bacteriaTrackTimestamps", ",", "bacteriaTracksClean", ",", 
       "bacteriaRadiiByTrackCorrected"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9176296020522733`*^9, 3.9176296029164176`*^9}, {
   3.917629643572917*^9, 3.917629653498582*^9}, {3.9176340397275896`*^9, 
   3.9176340522857494`*^9}, {3.917634358573036*^9, 3.917634390668877*^9}, {
   3.917634487382233*^9, 3.9176344896219597`*^9}, 3.9176346164720907`*^9, {
   3.9176349145451164`*^9, 3.9176349166522484`*^9}, {3.9176355009185953`*^9, 
   3.917635502420749*^9}, 3.927382051834541*^9, 3.927382935250679*^9, {
   3.9274408180401473`*^9, 3.927440822545681*^9}, {3.927443610102522*^9, 
   3.9274436135752296`*^9}, {3.9275301835248213`*^9, 
   3.9275302415765295`*^9}, {3.92780863682277*^9, 3.9278087112293367`*^9}, {
   3.9391101655829096`*^9, 3.9391101682865176`*^9}, {3.9391105362028437`*^9, 
   3.939110539632327*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"21125c16-7b17-4b6a-b9df-c6d0a35ca81d"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Unified Track Data >>", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.9004083591173897`*^9, 3.9004083714014845`*^9}, {3.9004084501855927`*^9, 
  3.9004084564578943`*^9}, {3.9170415507944126`*^9, 3.917041551802916*^9}, {
  3.917635098236889*^9, 
  3.9176351049970627`*^9}},ExpressionUUID->"56117cc6-ab6c-4ef9-8b5c-\
2d96923661d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "dataCompressedfolder", "<>", 
      "\"\<Bacteria Tracks Data Unified.txt\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Compress", "@", "trackDataUnifiedRadii"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataTracksFolder", "=", 
    RowBox[{"dataCSVfolder", "<>", "\"\<Track Data\\\\\>\""}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataTracksFolder", "<>", "\"\<Track_\>\"", "<>", 
       RowBox[{"ToString", "@", "#"}], "<>", "\"\<_(t,x,y,r).csv\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"trackDataUnifiedRadii", "[", 
       RowBox[{"[", "#", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], 
   "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "trackDataUnifiedRadii"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9176355823162413`*^9, 3.9176355909813156`*^9}, {
  3.9176357004706063`*^9, 3.917635703508215*^9}, {3.9278085305097713`*^9, 
  3.927808532053498*^9}, {3.939129591381117*^9, 3.9391295941834803`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"8c01581f-8849-402e-9275-a60093b8d935"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Unified Track Data <<", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.9004083591173897`*^9, 3.9004083714014845`*^9}, {3.9004084501855927`*^9, 
  3.9004084564578943`*^9}, {3.9170415507944126`*^9, 3.917041551802916*^9}, {
  3.917635098236889*^9, 3.9176351049970627`*^9}, {3.9176357096952224`*^9, 
  3.917635711348832*^9}, {3.9176358758367705`*^9, 
  3.9176358789746084`*^9}},ExpressionUUID->"140cec79-705c-49b3-93e0-\
ebd0e503be14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trackDataUnifiedRadii", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "dataCompressedfolder", "<>", 
      "\"\<Bacteria Tracks Data Unified.txt\>\""}], "\[IndentingNewLine]", 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9176355823162413`*^9, 3.9176355909813156`*^9}, {
   3.9176357004706063`*^9, 3.917635733153318*^9}, 3.927808543040316*^9},
 CellLabel->
  "In[227]:=",ExpressionUUID->"044e1790-784f-4ca4-8aae-be8f00d05c0a"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bacteria Velocimetry & Size Measurements", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, 3.9156903194919915`*^9, {3.915739910762867*^9, 
   3.915739918324235*^9}, {3.9270104763766985`*^9, 3.9270104896393433`*^9}, 
   3.9518765468406687`*^9},
 FontSize->24,ExpressionUUID->"5b08617f-06df-47be-9f46-90fc17939434"],

Cell[CellGroupData[{

Cell["Get Velocity & Radii", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.915225186935465*^9, 3.915225188518117*^9}, {
   3.9156903225298924`*^9, 3.9156903337503414`*^9}, {3.928646800316945*^9, 
   3.9286468215419436`*^9}},
 FontSize->24,ExpressionUUID->"04390ac5-77fc-4903-891b-c7d8a68bf1de"],

Cell[CellGroupData[{

Cell["Compute Velocity & Match Radii [DEFAULT]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 3.915222540309099*^9}, 
   3.9156274163924828`*^9, {3.91562792161534*^9, 3.915627925454192*^9}, {
   3.915710406724619*^9, 3.915710411066506*^9}, {3.915739689635098*^9, 
   3.915739694739092*^9}, {3.926998246278369*^9, 3.9269982650158195`*^9}, {
   3.9286468266777525`*^9, 
   3.928646829104138*^9}},ExpressionUUID->"13a219ef-07e5-4173-b011-\
82366b07517b"],

Cell["\<\
Defaults :
   
motionThreshold=50;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, {3.905446106002844*^9, 3.9054461063221574`*^9}, 
   3.912238906748783*^9, 3.912247697133684*^9, {3.9122477658867474`*^9, 
   3.9122477785803137`*^9}, 3.9152128103077116`*^9, {3.915699240200105*^9, 
   3.915699242912198*^9}},
 FontSize->16,ExpressionUUID->"9ffa6fce-5b77-46ca-a7e4-cdddedeb763b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"motionThreshold", "=", "75"}], ";"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9152252257539062`*^9, 3.9152252273765182`*^9}, {
   3.9152257177197013`*^9, 3.9152257283695536`*^9}, {3.915225880489108*^9, 
   3.915225880753631*^9}, {3.9152259170462265`*^9, 3.915225917213434*^9}, {
   3.915226183406436*^9, 3.9152261973605933`*^9}, {3.9156991631884336`*^9, 
   3.915699163424266*^9}, {3.9156992743451366`*^9, 3.915699274392647*^9}, {
   3.9156995857143774`*^9, 3.9156995860084205`*^9}, {3.915699729977909*^9, 
   3.915699730024139*^9}, {3.9157117071492844`*^9, 3.915711708658794*^9}, {
   3.915812396724368*^9, 3.915812396964836*^9}, 3.91581245909313*^9, {
   3.915812496285466*^9, 3.9158124965154533`*^9}, {3.9158154683672094`*^9, 
   3.9158154684519825`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"b5eb7c86-e98e-4d28-bc7d-e3ba9ad1ab6b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"matchIndices", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "#"}], "\[Equal]", "2"}], "&"}]}], "]"}], 
         "&"}], "@", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "checkID", "}"}], ",", 
               RowBox[{"Nearest", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"bacteriaCentroidsResolved", "[", 
                   RowBox[{"[", 
                    RowBox[{"frameID", "-", "1"}], "]"}], "]"}], "\[Rule]", 
                  "\"\<Index\>\""}], ",", "#", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "motionThreshold"}], "}"}]}], 
                "\[IndentingNewLine]", "]"}]}], "}"}]}], "&"}], "@", 
           RowBox[{"bacteriaCentroidsResolved", "[", 
            RowBox[{"[", 
             RowBox[{"frameID", ",", "checkID"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"checkID", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"bacteriaCentroidsResolved", "[", 
              RowBox[{"[", "frameID", "]"}], "]"}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"frameID", ",", "2", ",", 
         RowBox[{"Length", "@", "bacteriaCentroidsResolved"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.915710648881449*^9, 3.91571065830927*^9}, {
   3.9157106964358864`*^9, 3.9157107424196577`*^9}, {3.9157107803654504`*^9, 
   3.9157107897962036`*^9}, {3.9157113854377356`*^9, 
   3.9157114316908197`*^9}, {3.915711588915888*^9, 3.915711626340905*^9}, {
   3.915711680358251*^9, 3.915711731257104*^9}, {3.9157117984448557`*^9, 
   3.915711940565372*^9}, 3.9157119828911886`*^9, {3.915734027403614*^9, 
   3.915734083219096*^9}, {3.915734327668689*^9, 3.915734331398556*^9}, {
   3.915734722348336*^9, 3.9157347455386925`*^9}, 3.915739574875415*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"113e9469-8067-4d38-b0a6-d7f103dedc3a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"bacteriaDisplacements", "=", 
        RowBox[{
         RowBox[{"operateOnMatchingElements", "[", "\[IndentingNewLine]", 
          RowBox[{"bacteriaCentroidsResolved", ",", "matchIndices", ",", 
           RowBox[{
            RowBox[{"Subtract", "@@", "#"}], "&"}]}], "\[IndentingNewLine]", 
          "]"}], "//", "Quiet"}]}], ";"}], "//", 
      RowBox[{
      "AbsoluteTiming", "\[IndentingNewLine]", "\n", "bacteriaRadii"}]}], "=", 
     RowBox[{
      RowBox[{"operateOnMatchingElements", "[", "\[IndentingNewLine]", 
       RowBox[{"bacteriaRadiiResolved", ",", "matchIndices", ",", "Mean"}], 
       "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], ";"}], "//", 
   RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Length", "/@", "#"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"bacteriaCentroidsResolved", ",", "bacteriaDisplacements"}], 
       "}"}]}], "//", 
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"#", ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9157342902066603`*^9, 3.9157343630593696`*^9}, {
   3.9157344953485622`*^9, 3.9157345555599155`*^9}, {3.9157345953077617`*^9, 
   3.9157346213699245`*^9}, {3.9157346580359545`*^9, 3.9157346746463747`*^9}, 
   3.915739590166086*^9, {3.917017735498335*^9, 3.9170177393290462`*^9}, {
   3.917101337489276*^9, 3.9171013611702986`*^9}, {3.917495883770378*^9, 
   3.917495887444654*^9}, {3.917495926595904*^9, 3.9174959272548327`*^9}, {
   3.917495957505468*^9, 3.917496092013011*^9}, {3.9174961250014668`*^9, 
   3.9174961362215805`*^9}, {3.9174963762823105`*^9, 
   3.9174964951747236`*^9}, {3.9174969767281685`*^9, 3.91749698095215*^9}, {
   3.9174970608189735`*^9, 3.917497114312349*^9}, {3.917497199839493*^9, 
   3.9174972147431064`*^9}, {3.9174987523352265`*^9, 
   3.9174987684225235`*^9}, {3.9174988104713564`*^9, 3.917498816243815*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"499cabd4-9a31-4fd0-ae1c-c1acb70e6428"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"bacteriaDisplacementsJoined", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pixelSizeMicroMeters", "/", "frameDurationSeconds"}], 
           ")"}], "*", 
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
        "bacteriaDisplacements"}]}], ";"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"displacementsX", ",", "displacementsY"}], "}"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"First", "@", "#"}], ",", 
        RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], "@", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "@", "bacteriaDisplacementsJoined"}]}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"displacementsAbs", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "@", "#"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"displacementsX", ",", "displacementsY"}], "}"}], "]"}]}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"bacteriaRadiiJoined", "=", 
    RowBox[{"pixelSizeMicroMeters", "*", 
     RowBox[{"Flatten", "@", "bacteriaRadii"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.915225479831275*^9, 3.9152255045149074`*^9}, {
   3.915225543273244*^9, 3.915225646558111*^9}, {3.915628445887369*^9, 
   3.9156284773103933`*^9}, {3.9156383078560886`*^9, 3.9156383173809533`*^9}, 
   3.9156383524569035`*^9, 3.915640439248766*^9, {3.915738473770915*^9, 
   3.9157384756758776`*^9}, {3.9171012384711905`*^9, 3.917101239583703*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"f5116177-6145-48d2-a8d4-e61c1f808785"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute Velocity & Match Radii [MHT-X Version]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 3.915222540309099*^9}, 
   3.9156274163924828`*^9, {3.91562792161534*^9, 3.915627925454192*^9}, {
   3.915710406724619*^9, 3.915710411066506*^9}, {3.915739689635098*^9, 
   3.915739694739092*^9}, {3.926998246278369*^9, 3.9269982650158195`*^9}, {
   3.9286468266777525`*^9, 3.928646829104138*^9}, {3.9286468843318405`*^9, 
   3.928646887402439*^9}},ExpressionUUID->"e3c8fe69-6762-47d2-b407-\
2ae801e07558"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pixelSizeMicroMeters", "*", 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", "3"}], "]"}], "]"}]}], "&"}], "/@", "#"}], "&"}], 
   "/@", 
   RowBox[{"trackDataUnifiedRadii", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "150"}], "]"}], "]"}]}], "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.928641022383927*^9, 3.928641118544923*^9}, {
   3.928646298316266*^9, 3.9286463211126146`*^9}, {3.9286468928803654`*^9, 
   3.9286468974243565`*^9}, {3.939193155732169*^9, 3.939193159594496*^9}, {
   3.939209134455285*^9, 3.9392091358923364`*^9}, {3.9517964026773615`*^9, 
   3.951796404316324*^9}, 3.95187938428889*^9},
 CellLabel->
  "In[228]:=",ExpressionUUID->"73575f08-75ca-4353-9f09-21b1da0edc08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"selectedTracks", "=", 
    RowBox[{"trackDataUnifiedRadii", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "All"}], "]"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"displacementsXYJoined", "=", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Differences", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", "3"}], "]"}], "]"}]}]}], "&"}], "@", 
         RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", "selectedTracks"}], 
      ",", "1"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"displacementsX", ",", "displacementsY"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"First", "@", "#"}], ",", 
       RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], "@", 
    RowBox[{"Transpose", "@", "displacementsXYJoined"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"displacementsAbs", "=", 
   RowBox[{"Norm", "/@", "displacementsXYJoined"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"timeDifferencesJoined", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Differences", "@", 
        RowBox[{"First", "@", 
         RowBox[{"Transpose", "@", "#"}]}]}], "&"}], "/@", "selectedTracks"}],
      "//", "Flatten"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"radiiShiftedJoined", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"MovingAverage", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
         RowBox[{"Last", "@", 
          RowBox[{"Transpose", "@", "#"}]}]}], "&"}], "/@", 
       "selectedTracks"}], "//", "Flatten"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", "-", 
        RowBox[{"Mean", "@", "#"}]}], ")"}], "&"}], "@", 
     RowBox[{"(", 
      RowBox[{"Length", "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "displacementsX", ",", "displacementsY", ",", "displacementsAbs", ",",
          "\[IndentingNewLine]", "timeDifferencesJoined", ",", 
         "radiiShiftedJoined"}], "\[IndentingNewLine]", "}"}]}], ")"}]}], "//",
     "Flatten"}], "//", "Total"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"velocityRadiiPhysical", "=", 
     RowBox[{"Transpose", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pixelSizeMicroMeters", "*", 
            RowBox[{"Flatten", "[", 
             RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "/", "#4"}], "/", 
             "frameDurationSeconds"}], ",", "#5"}], "}"}]}], "&"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "displacementsX", ",", "displacementsY", ",", "displacementsAbs", 
          ",", "\[IndentingNewLine]", "timeDifferencesJoined", ",", 
          "radiiShiftedJoined"}], "\[IndentingNewLine]", "}"}]}], "]"}]}]}], 
    ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bacteriaVelocityPhysical", "=", 
   RowBox[{"velocityRadiiPhysical", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bacteriaRadiiPhysical", "=", 
   RowBox[{"Last", "@", "velocityRadiiPhysical"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928641200832429*^9, 3.9286413236395645`*^9}, {
   3.9286413543994155`*^9, 3.9286413658603587`*^9}, {3.92864164442013*^9, 
   3.9286416546266427`*^9}, {3.9286461681781087`*^9, 3.928646170087559*^9}, {
   3.928646215157948*^9, 3.928646241358034*^9}, {3.9286463402961903`*^9, 
   3.9286463414982123`*^9}, {3.9286465057322865`*^9, 
   3.9286465368286867`*^9}, {3.9286467140911846`*^9, 
   3.9286467738307433`*^9}, {3.9286470409913993`*^9, 
   3.9286470586013536`*^9}, {3.9286472411572695`*^9, 3.928647255035428*^9}, {
   3.928647310254676*^9, 3.928647436483485*^9}, {3.928647485455553*^9, 
   3.928647539634139*^9}, {3.9286477408349504`*^9, 3.928647768688169*^9}, {
   3.928648030279338*^9, 3.9286480479166365`*^9}, {3.928648085457136*^9, 
   3.928648197825527*^9}, {3.928648410218983*^9, 3.9286484156959715`*^9}, {
   3.928648576777299*^9, 3.928648597533202*^9}, 3.928731835581317*^9, {
   3.9391938103319583`*^9, 3.939193810939825*^9}, {3.9525319322173653`*^9, 
   3.9525319596861153`*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"f4836780-968c-4b64-a46a-95c758b3c99b"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Bacteria Displacements & Radii >>", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 3.915222540309099*^9}, 
   3.9156274163924828`*^9, {3.91562792161534*^9, 3.915627925454192*^9}, {
   3.915710406724619*^9, 3.915710411066506*^9}, {3.915739689635098*^9, 
   3.915739694739092*^9}},ExpressionUUID->"37478185-fd4a-47a3-a262-\
d5507f6ae1de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "dataCompressedfolder", "<>", 
      "\"\<Bacteria Displacements Formatted.txt\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Compress", "@", "bacteriaVelocityPhysical"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "dataCompressedfolder", "<>", "\"\<Bacteria Radii Formatted.txt\>\""}], 
     ",", 
     RowBox[{"Compress", "@", "bacteriaRadiiPhysical"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataCSVfolder", "<>", "\"\<Vx_Vy_absV_r.csv\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Transpose", "@", "velocityRadiiPhysical"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8892817493431044`*^9, 3.8892817805519447`*^9}, {
   3.889281837143244*^9, 3.88928191320846*^9}, {3.8892819594009056`*^9, 
   3.889281979209507*^9}, {3.8892821229194517`*^9, 3.8892821513839016`*^9}, {
   3.889621126101282*^9, 3.8896211918063293`*^9}, 3.8896214994948688`*^9, {
   3.8896215537218475`*^9, 3.889621561789811*^9}, {3.8896216430248423`*^9, 
   3.8896216457023907`*^9}, 3.8896216789445276`*^9, {3.8896220419612627`*^9, 
   3.8896220975531425`*^9}, {3.889623340867552*^9, 3.8896233411228905`*^9}, {
   3.8899819697164917`*^9, 3.889981979009638*^9}, 3.889982019469488*^9, {
   3.8899820760598574`*^9, 3.8899820783107395`*^9}, {3.890046229067525*^9, 
   3.890046277931983*^9}, {3.890527335932677*^9, 3.8905273362291927`*^9}, {
   3.899494914195033*^9, 3.8994949154990673`*^9}, {3.9152225301919775`*^9, 
   3.915222534823679*^9}, {3.9152225847640715`*^9, 3.9152226171491485`*^9}, {
   3.915223424822422*^9, 3.915223436343696*^9}, {3.9152234753578963`*^9, 
   3.915223478397222*^9}, {3.9152235935791206`*^9, 3.915223594570014*^9}, {
   3.915627418998305*^9, 3.9156274598009987`*^9}, {3.915627514288991*^9, 
   3.9156275151584177`*^9}, {3.9156275989867334`*^9, 
   3.9156276263016367`*^9}, {3.915627943039804*^9, 3.9156279902950764`*^9}, {
   3.9156280748404016`*^9, 3.915628091218577*^9}, {3.9156281246315737`*^9, 
   3.915628125174774*^9}, {3.9157104254762263`*^9, 3.915710432251785*^9}, {
   3.915738211923329*^9, 3.915738240465977*^9}, {3.9157383452024174`*^9, 
   3.915738439835179*^9}, 3.9157384872456737`*^9, {3.915738517283326*^9, 
   3.915738529547226*^9}, {3.9157389130028214`*^9, 3.9157389284230328`*^9}, {
   3.9286482238243246`*^9, 3.928648252927431*^9}, {3.9525319707691784`*^9, 
   3.9525319777059464`*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"f516cdf9-e5fa-4552-b514-e541debe64af"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Bacteria Displacements & Radii <<", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, {3.88962249911553*^9, 3.8896225193161316`*^9}, 
   3.8896234870902314`*^9, {3.915222523970116*^9, 3.9152225455522757`*^9}, {
   3.915627409410327*^9, 3.9156274110175133`*^9}, {3.9156279304544163`*^9, 
   3.9156279317014713`*^9}, {3.9157104185491734`*^9, 3.9157104197390137`*^9}, 
   3.9157396975561237`*^9},ExpressionUUID->"314b7093-fb5e-4b32-9ccd-\
e8012011c435"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaVelocityPhysical", "=", 
    RowBox[{"Uncompress", "@", 
     RowBox[{"Import", "[", "\[IndentingNewLine]", 
      RowBox[{
      "dataCompressedfolder", "<>", 
       "\"\<Bacteria Displacements Formatted.txt\>\""}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bacteriaRadiiPhysical", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "dataCompressedfolder", "<>", "\"\<Bacteria Radii Formatted.txt\>\""}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896225359098797`*^9, 3.8896226218372874`*^9}, {3.88962271829244*^9, 
   3.8896227275498905`*^9}, {3.889623134636578*^9, 3.889623137861703*^9}, {
   3.889623351635437*^9, 3.889623352090786*^9}, {3.8896235050986195`*^9, 
   3.889623534803034*^9}, 3.8899815513595295`*^9, {3.8901546653652105`*^9, 
   3.890154666131366*^9}, {3.8903837878670807`*^9, 3.8903837896332626`*^9}, {
   3.8903838511865406`*^9, 3.890383858398181*^9}, 3.8903839043715124`*^9, {
   3.890384135310108*^9, 3.890384146650017*^9}, {3.890386917039728*^9, 
   3.8903869187284775`*^9}, {3.8904093272504597`*^9, 3.890409333525776*^9}, 
   3.890409366183757*^9, {3.890527338154413*^9, 3.8905273383735204`*^9}, {
   3.8988782099719763`*^9, 3.8988782104193707`*^9}, {3.900093179450349*^9, 
   3.9000932064248447`*^9}, {3.9152226218831253`*^9, 3.915222649675064*^9}, {
   3.9152234558563757`*^9, 3.915223457637218*^9}, {3.915627421287032*^9, 
   3.9156274663753643`*^9}, {3.915627517399713*^9, 3.9156275181985207`*^9}, {
   3.9156276276549125`*^9, 3.915627627831148*^9}, {3.91562799744701*^9, 
   3.9156280485341587`*^9}, {3.9157104384041367`*^9, 3.915710448470223*^9}, {
   3.9157389565322905`*^9, 3.9157389650366077`*^9}, {3.9157397150761113`*^9, 
   3.915739725782365*^9}, {3.952531993608452*^9, 3.9525319996559753`*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"3eff419d-eaf6-493c-ae6c-101c10eb0bf9"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot Velocity Statistics", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.915225186935465*^9, 3.915225188518117*^9}, {
   3.915646936249711*^9, 3.915646945438861*^9}},
 FontSize->24,ExpressionUUID->"f05f1729-0360-41d4-995e-95680bb40e24"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "dataCSVfolder", "=", 
    "\"\<D:\\\\Science\\\\MMML\\\\Image Processing\\\\Bacteria \
Tracking\\\\Output\\\\18\\\\CSV\\\\\>\""}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"SetDirectory", "@", "dataCSVfolder"}], ";", "\[IndentingNewLine]", 
   RowBox[{"filesToMerge", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", "\"\<Set\>\""}], "]"}], "&"}]}], "]"}], "&"}], 
     "@", 
     RowBox[{"FileNames", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"filesToMerge", "//", "TableForm"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.915800338333746*^9, 3.9158003687948074`*^9}, 
   3.915812421626546*^9, {3.915812746697293*^9, 3.9158127529710026`*^9}, 
   3.9158130975644684`*^9, {3.915814246453658*^9, 3.9158142484781666`*^9}, 
   3.9158150287340336`*^9, 3.915815458326429*^9, 3.916489585789424*^9, 
   3.917017764692069*^9, {3.917037318764109*^9, 3.917037347654994*^9}, 
   3.9170373957079177`*^9, 3.9170395959584527`*^9, {3.9171020868439493`*^9, 
   3.9171020887653594`*^9}, 3.9171026844319153`*^9, 3.9171028717732735`*^9, 
   3.917103110150211*^9, {3.9173462510301685`*^9, 3.9173462591023483`*^9}, {
   3.917346300188689*^9, 3.9173463072545547`*^9}, {3.917346421772687*^9, 
   3.917346436676885*^9}, 3.9173502575856447`*^9, 3.917498881855729*^9},
 CellLabel->
  "In[281]:=",ExpressionUUID->"fadd9a50-f923-4466-b7e0-587ca83d4aee"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"dataToMerge", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"dataCSVfolder", "<>", "#"}], "]"}], "&"}], "/@", 
     "filesToMerge"}]}], ";", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "displacementsX", ",", "displacementsY", ",", "displacementsAbs", ",", 
      "bacteriaRadiiJoined"}], "}"}], "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", "##", "]"}], "&"}], ",", 
      RowBox[{"Transpose", "/@", "dataToMerge"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.917346502645291*^9, 3.917346537413804*^9}, {
   3.917347649071746*^9, 3.917347650550483*^9}, 3.9174988797484508`*^9},
 CellLabel->
  "In[282]:=",ExpressionUUID->"c3827892-5b4b-46ac-9224-b53402c6f991"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aspectLogLog", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"histogramBinningMethod", "=", "\"\<FreedmanDiaconis\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.915628575025424*^9, 3.9156286636574383`*^9}, {
  3.9156411223517547`*^9, 3.915641129650144*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"218f51df-a0fc-47db-89db-f51775e338e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"displacementsPDF", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getDataBinsNoRescaling", "@", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Log\>\"", ",", "histogramBinningMethod"}], "}"}], ",", 
         "\"\<PDF\>\""}], "]"}]}], "&"}], "/@", 
     "bacteriaVelocityPhysical"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fontSize", "=", "16"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotDisplacementsPDF", "=", 
  RowBox[{"getLogLog10Plot", "[", "\[IndentingNewLine]", 
   RowBox[{"displacementsPDF", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.2", "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "1"}]}]}], ",", "All"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "6"}]}]}], ",", 
        RowBox[{"5", "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "1"}]}]}]}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"getLatexStyling", "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<v,~\\\\mu m/s\>\"", ",", "\"\<\\\\textbf{PDF}(v)\>\""}], 
      "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getLatexStyling", "/@", 
      RowBox[{"{", 
       RowBox[{
       "\"\<v_x\>\"", ",", "\"\<v_y\>\"", ",", 
        "\"\<\\\\lVert \\\\vec{v} \\\\rVert\>\""}], "}"}]}], "//", 
     RowBox[{
      RowBox[{"Placed", "[", 
       RowBox[{"#", ",", "Top"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.915628430881915*^9, 3.9156284376779814`*^9}, {
   3.9156285165109415`*^9, 3.915628559584439*^9}, 3.915628625359742*^9, {
   3.9156290845948944`*^9, 3.9156291143442016`*^9}, {3.915637272705576*^9, 
   3.9156372770466967`*^9}, {3.915637497896391*^9, 3.915637564632138*^9}, {
   3.91563812258589*^9, 3.9156382471610518`*^9}, {3.9156383890038548`*^9, 
   3.9156384502098083`*^9}, {3.915640319498372*^9, 3.9156403426260614`*^9}, {
   3.9156404523523655`*^9, 3.915640467703992*^9}, {3.915641020241952*^9, 
   3.915641091209325*^9}, 3.915641132003211*^9, {3.915734805235694*^9, 
   3.9157348104031973`*^9}, {3.9157352125077615`*^9, 3.915735234954419*^9}, {
   3.915738810829782*^9, 3.91573881140351*^9}, 3.91581251667746*^9, {
   3.917037006453822*^9, 3.917037006852403*^9}, {3.9170374206749983`*^9, 
   3.917037420851162*^9}, {3.917039612884918*^9, 3.91703963909078*^9}, {
   3.917059720261229*^9, 3.9170597683004003`*^9}, {3.917102129787833*^9, 
   3.9171021430082855`*^9}, 3.9171029864491296`*^9, {3.9173465956900034`*^9, 
   3.9173466103346024`*^9}, {3.917346647174559*^9, 3.917346649334819*^9}, {
   3.917498899688475*^9, 3.917498920518318*^9}, {3.9287322552555785`*^9, 
   3.928732295190575*^9}, {3.939185495404923*^9, 3.9391855536452503`*^9}, {
   3.939185639956588*^9, 3.9391856402110763`*^9}, {3.939185728548151*^9, 
   3.939185734445978*^9}, {3.9512913189230766`*^9, 3.951291319193654*^9}, {
   3.9512919485966597`*^9, 3.951292011563913*^9}, {3.9518100773263893`*^9, 
   3.951810097357072*^9}, {3.951879471237938*^9, 3.9518794714931636`*^9}, 
   3.952531766977812*^9, {3.95253201285818*^9, 3.9525320161198273`*^9}, {
   3.952532141903517*^9, 3.952532184287897*^9}, 3.9525737269791775`*^9, 
   3.9525781147121134`*^9, {3.9525794219046493`*^9, 3.9525794546017284`*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"8a12b23d-c3c5-429a-a71e-15aa7840c980"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{"plotDisplacementsPDF", ",", "\"\<Velocity_PDF\>\"", ",", "100"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9156466299043827`*^9, 3.9156466472793045`*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"015bdac7-b39e-4eb4-ad88-9d22ed916e78"],

Cell[BoxData[
 RowBox[{
  RowBox[{"displacementComponentTags", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<abs\>\""}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.915739042606563*^9, 3.9157390820513535`*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"e338ae49-62b4-4924-bb1e-9d622b0a9ca4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "dataCSVfolder", "<>", "\"\<PDF(V\>\"", "<>", "#1", "<>", 
        "\"\<).csv\>\""}], ",", "#2"}], "]"}], "&"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"displacementComponentTags", ",", "displacementsPDF"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.915738737424815*^9, 3.9157387409301963`*^9}, {
  3.915738977866706*^9, 3.91573915849588*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"032f40d0-5bd2-4e9e-acf7-b009ff49711a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"histogramInterpolationOrder", "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"histogramBinningMethod", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<Log\>\"", ",", "\"\<FreedmanDiaconis\>\""}], "}"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binPlotFrameTicks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"#", ",", "None"}], "}"}]}], "}"}], "&"}], "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"10", "^", "i"}], ",", 
        RowBox[{"Superscript", "[", 
         RowBox[{"10", ",", "i"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.915628575025424*^9, 3.9156286636574383`*^9}, {
  3.9156411223517547`*^9, 3.915641129650144*^9}, {3.9156411599446993`*^9, 
  3.9156411734237638`*^9}, {3.915699664266512*^9, 3.9156996855459704`*^9}, {
  3.915814974141218*^9, 3.915814979988533*^9}, {3.915815071876423*^9, 
  3.9158150737583294`*^9}, {3.9173469858943176`*^9, 3.917347001726364*^9}, {
  3.9173471522936525`*^9, 3.917347198806902*^9}, {3.9173472537960606`*^9, 
  3.917347333226414*^9}, {3.917347848038826*^9, 3.91734785664777*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"40d0f996-96d9-41e2-8466-960b6e0604ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fontSize", "=", "16"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotDisplacementsHistogram", "=", 
  RowBox[{"getSmoothPropertyHistogram", "[", "\[IndentingNewLine]", 
   RowBox[{"bacteriaVelocityPhysical", ",", "\[IndentingNewLine]", 
    RowBox[{"getLatexStyling", "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<v,~\\\\mu m/s\>\"", ",", "\"\<\\\\rho(v)\>\""}], "}"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"0.05", ",", "All"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getLatexStyling", "/@", 
      RowBox[{"{", 
       RowBox[{
       "\"\<v_x\>\"", ",", "\"\<v_y\>\"", ",", 
        "\"\<\\\\lVert \\\\vec{v} \\\\rVert\>\""}], "}"}]}], "//", 
     RowBox[{
      RowBox[{"Placed", "[", 
       RowBox[{"#", ",", "Top"}], "]"}], "&"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\"\<Log10\>\"", ",", "None"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9156406595991497`*^9, 3.9156408468799953`*^9}, {
   3.915640896136227*^9, 3.915640935208528*^9}, {3.915644974586903*^9, 
   3.9156450019842215`*^9}, {3.9156455018574843`*^9, 3.915645531757579*^9}, {
   3.9156463650707216`*^9, 3.9156463925779877`*^9}, {3.915646717410963*^9, 
   3.9156467187529325`*^9}, {3.915646773800509*^9, 3.9156467747227983`*^9}, {
   3.9156995245360208`*^9, 3.9156995425203695`*^9}, {3.9156996938341913`*^9, 
   3.9156996954245796`*^9}, {3.915699754155054*^9, 3.9156997748107767`*^9}, {
   3.9157076311807146`*^9, 3.9157076484444475`*^9}, 3.915735680556465*^9, {
   3.9157388141903343`*^9, 3.915738814642826*^9}, 3.9158149831207643`*^9, {
   3.9158150679732857`*^9, 3.915815069156322*^9}, {3.917039652493333*^9, 
   3.917039658907998*^9}, 3.917059780805636*^9, {3.9173467903416195`*^9, 
   3.9173467914715033`*^9}, {3.917346821845471*^9, 3.917346894294193*^9}, {
   3.9173470187107744`*^9, 3.9173470193098116`*^9}, {3.9173474026397724`*^9, 
   3.917347413342599*^9}, {3.9173478645469007`*^9, 3.917347892397957*^9}, 
   3.917350306848111*^9, 3.9174989369995575`*^9, {3.939185919252302*^9, 
   3.93918592148573*^9}, 3.95179642742972*^9, 3.952532055757677*^9, 
   3.9525322046310587`*^9, 3.952573752079475*^9, 3.952578131987361*^9},
 CellLabel->
  "In[294]:=",ExpressionUUID->"df49e4c7-bb6f-485b-9dd9-a49f883cf9bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fontSize", "=", "16"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotDisplacementsHistogramOnlyAbs", "=", 
  RowBox[{"getSmoothPropertyHistogram", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Last", "@", "bacteriaVelocityPhysical"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"getLatexStyling", "/@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<\\\\lVert \\\\vec{v} \\\\rVert, ~\\\\mu m/s\>\"", ",", 
       "\[IndentingNewLine]", 
       "\"\<\\\\rho \\\\left( \\\\lVert \\\\vec{v} \\\\rVert \
\\\\right)\>\""}], "\[IndentingNewLine]", "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2.5", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "1"}]}]}], ",", "All"}], "}"}], ",", "None", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Log10\>\"", ",", "None"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9156406595991497`*^9, 3.9156408468799953`*^9}, {
   3.915640896136227*^9, 3.915640935208528*^9}, {3.915644974586903*^9, 
   3.9156450019842215`*^9}, {3.9156455018574843`*^9, 3.915645531757579*^9}, {
   3.9156463650707216`*^9, 3.9156463925779877`*^9}, {3.915646717410963*^9, 
   3.9156467187529325`*^9}, {3.915646773800509*^9, 3.9156467747227983`*^9}, {
   3.9156995245360208`*^9, 3.9156995425203695`*^9}, {3.9156996938341913`*^9, 
   3.9156996954245796`*^9}, {3.915699754155054*^9, 3.9156997748107767`*^9}, {
   3.9157076311807146`*^9, 3.9157076484444475`*^9}, 3.915735680556465*^9, {
   3.9157388141903343`*^9, 3.915738814642826*^9}, 3.9158149831207643`*^9, {
   3.9158150679732857`*^9, 3.915815069156322*^9}, {3.917039652493333*^9, 
   3.917039658907998*^9}, 3.917059780805636*^9, {3.9173467903416195`*^9, 
   3.9173467914715033`*^9}, {3.917346821845471*^9, 3.917346894294193*^9}, {
   3.9173470187107744`*^9, 3.9173470193098116`*^9}, {3.91734737573623*^9, 
   3.9173473915130997`*^9}, {3.9173474240479245`*^9, 
   3.9173475858891163`*^9}, {3.9173478783282824`*^9, 3.917347916517523*^9}, {
   3.9173503333988934`*^9, 3.9173503526696215`*^9}, {3.9174989613687744`*^9, 
   3.9174989658778625`*^9}, {3.951796277094266*^9, 3.9517962860379424`*^9}, 
   3.9525309346179886`*^9, {3.9525320671999917`*^9, 3.9525320694283*^9}, {
   3.952532213118554*^9, 3.952532213205346*^9}, {3.952573774193372*^9, 
   3.9525737801502886`*^9}, 3.9525781444125147`*^9, {3.9525794742522697`*^9, 
   3.952579477393473*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"9c8275bc-8a7d-44d1-b646-9d9beb60896f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotDisplacementsHistogram", ",", "\"\<Velocity_histogram\>\"", ",", 
    "100"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotDisplacementsHistogramOnlyAbs", ",", "\"\<Velocity_histogram_abs\>\"",
     ",", "100"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.915646815976452*^9, 3.9156468207616105`*^9}, {
  3.9173475488940554`*^9, 3.9173475564033275`*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"56da7190-0ce3-4e11-b4e0-b8e5b1868d8f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bacteria Size Statistics", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.915225186935465*^9, 3.915225188518117*^9}, {
   3.915646936249711*^9, 3.915646945438861*^9}, {3.915708512980127*^9, 
   3.9157085222663326`*^9}, {3.915734862754013*^9, 3.9157348702665644`*^9}},
 FontSize->24,ExpressionUUID->"96ebe85e-ac59-448d-9f90-a0f1b68f6f8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"histogramInterpolationOrder", "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"histogramBinningMethod", "=", "\"\<FreedmanDiaconis\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binPlotFrameTicks", "=", "Automatic"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.915628575025424*^9, 3.9156286636574383`*^9}, {
   3.9156411223517547`*^9, 3.915641129650144*^9}, {3.9156411599446993`*^9, 
   3.9156411734237638`*^9}, {3.9156480468964767`*^9, 3.9156480877039733`*^9}, 
   3.915708272576334*^9, 3.915735333815382*^9, {3.917347711440367*^9, 
   3.917347713909232*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"7efbd823-8762-4c70-9d15-a0e19ced5df9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fontSize", "=", "16"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotRadiiHistogram", "=", 
  RowBox[{"getSmoothPropertyHistogram", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "bacteriaRadiiPhysical", "}"}], ",", 
    RowBox[{"getLatexStyling", "/@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<r_{\\\\text{bacteria}},~\\\\mu m\>\"", ",", 
       "\"\<\\\\rho(r_{\\\\text{bacteria}})\>\""}], "\[IndentingNewLine]", 
      "}"}]}], ",", "All", ",", "None", ",", "None"}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9156406595991497`*^9, 3.9156408468799953`*^9}, {
   3.915640896136227*^9, 3.915640935208528*^9}, {3.915644974586903*^9, 
   3.9156450019842215`*^9}, {3.9156455018574843`*^9, 3.915645531757579*^9}, {
   3.9156463650707216`*^9, 3.9156463925779877`*^9}, {3.915646717410963*^9, 
   3.9156467187529325`*^9}, {3.915646773800509*^9, 3.9156467747227983`*^9}, {
   3.915647966680848*^9, 3.915648060521001*^9}, {3.9156481001152544`*^9, 
   3.915648104115715*^9}, 3.9157082702984037`*^9, {3.9157353387250977`*^9, 
   3.9157353665720043`*^9}, {3.915738817132744*^9, 3.9157388175465064`*^9}, {
   3.9173476975356903`*^9, 3.9173476993103757`*^9}, {3.9287323854449806`*^9, 
   3.9287323864953384`*^9}, 3.9525320304018574`*^9},
 CellLabel->
  "In[303]:=",ExpressionUUID->"528607d2-8730-437e-8788-fcd35565e34c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotRadiiHistogram", ",", "\"\<Bacteria_radii_histogram\>\"", ",", 
    "100"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.915648115010803*^9, 3.9156481330422773`*^9}, 
   3.915708275405222*^9, {3.9157353754428544`*^9, 3.9157353759778137`*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"4e55e748-4190-48c1-a244-51d61f2ad267"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bacteria Size/Velocity Statistics", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.915225186935465*^9, 3.915225188518117*^9}, {
   3.915646936249711*^9, 3.915646945438861*^9}, {3.915708512980127*^9, 
   3.9157085222663326`*^9}, {3.915734862754013*^9, 3.9157348702665644`*^9}, {
   3.915736073674736*^9, 3.915736075298809*^9}},
 FontSize->24,ExpressionUUID->"92553685-3b93-4515-82ee-da748e8d80dc"],

Cell["\<\
Defaults :
   
histogramBinningMethod=\[CloseCurlyDoubleQuote]FreedmanDiaconis\
\[CloseCurlyDoubleQuote];
densityPlotSize=Automatic;
densityPlotLabelSize=10;
colorScheme={\[OpenCurlyDoubleQuote]RedBlueTones\[CloseCurlyDoubleQuote],\
\[CloseCurlyDoubleQuote]Reverse\[CloseCurlyDoubleQuote]};
aspectRatio=1/1.5;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}, 
   3.9157368454102073`*^9, 3.91573884230005*^9, {3.9170181261303744`*^9, 
   3.91701812778405*^9}},
 FontSize->16,ExpressionUUID->"ff14ec22-7e6d-4f7b-aa5a-254a74f0da09"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"frameLabels", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<\\\\lVert \\\\vec{v} \\\\rVert, ~\\\\mu m/s\>\"", ",", 
      "\[IndentingNewLine]", "\"\<r_{\\\\text{bacteria}},~\\\\mu m\>\""}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"histogramBinningMethod", "=", "\"\<FreedmanDiaconis\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"densityPlotSize", "=", "Automatic"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"densityPlotLabelSize", "=", "13"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"colorScheme", "=", "\"\<BlueGreenYellow\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"colorScheme", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<RedBlueTones\>\"", ",", "\"\<Reverse\>\""}], "}"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"legendSize", "=", "150"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aspectRatio", "=", 
   RowBox[{"1", "/", "1.5"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotRange", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.25"}], ",", "2"}], "}"}], ",", "All"}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902086900138836`*^9}, {3.8907227930962863`*^9, 
   3.890722840532838*^9}, 3.89072288470811*^9, {3.8907229230706444`*^9, 
   3.890722923613117*^9}, {3.8934788534985437`*^9, 3.8934788586315804`*^9}, 
   3.899713391285178*^9, {3.899713657567227*^9, 3.8997136803964653`*^9}, 
   3.899713757151433*^9, {3.8997138004614725`*^9, 3.8997138023493795`*^9}, 
   3.91573609789408*^9, {3.91573615552339*^9, 3.9157361590834465`*^9}, {
   3.915736225248452*^9, 3.915736233095745*^9}, {3.915736746850672*^9, 
   3.9157367469227953`*^9}, {3.915736813343663*^9, 3.9157368368033957`*^9}, {
   3.915737003251014*^9, 3.915737028539095*^9}, {3.9157370702593126`*^9, 
   3.915737070464864*^9}, {3.915737111382168*^9, 3.9157371115923204`*^9}, {
   3.9157388319856052`*^9, 3.915738838282246*^9}, {3.9164924291588182`*^9, 
   3.9164925216640553`*^9}, 3.916493214987236*^9, {3.9170178817541533`*^9, 
   3.9170178846125774`*^9}, {3.9170179938360066`*^9, 3.917018006525507*^9}, {
   3.917018095024851*^9, 3.917018110577448*^9}, {3.9170185630740595`*^9, 
   3.9170185966663322`*^9}, {3.9170371018838034`*^9, 
   3.9170371031832566`*^9}, {3.917039673482251*^9, 3.917039691723049*^9}, {
   3.9170598433584743`*^9, 3.9170598745967064`*^9}, {3.917059974589573*^9, 
   3.9170599747183385`*^9}, 3.917348103211779*^9, {3.9173481731579*^9, 
   3.917348175530368*^9}, 3.9173482287610283`*^9, {3.9173482737356253`*^9, 
   3.9173482817560215`*^9}, {3.9173504138716145`*^9, 
   3.9173504142448173`*^9}, {3.9173504872047625`*^9, 
   3.9173505058991585`*^9}, {3.917350599104048*^9, 3.917350605693224*^9}, {
   3.9174990192505217`*^9, 3.9174991749291725`*^9}, {3.9174992505110474`*^9, 
   3.9174992513914275`*^9}, {3.927000449347958*^9, 3.9270004962826767`*^9}, {
   3.927000622475372*^9, 3.92700062332316*^9}, {3.9512914862429333`*^9, 
   3.951291550945635*^9}, {3.951879641055202*^9, 3.9518796415579834`*^9}, {
   3.952532257808514*^9, 3.952532281376479*^9}, 3.952574106140154*^9, 
   3.952578157956931*^9, {3.9525795320049815`*^9, 3.9525795324363832`*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"6fd5c14b-b0a0-438c-acee-08148800a1bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fontSize", "=", 
    RowBox[{"densityPlotLabelSize", "-", "2"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radiiDisplacementsAbs", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"NumericQ", "/@", "#"}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"True", ",", "True"}], "}"}]}], "&"}]}], "]"}], "&"}], "@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Log10", "@", 
         RowBox[{"Last", "@", "bacteriaVelocityPhysical"}]}], ",", 
        "bacteriaRadiiPhysical"}], "}"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotRadiiVelocityHistogram", "=", 
    RowBox[{"DensityHistogram", "[", "\[IndentingNewLine]", 
     RowBox[{
     "radiiDisplacementsAbs", ",", "histogramBinningMethod", ",", 
      "\"\<Intensity\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "densityPlotSize"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Black", ",", "Bold", ",", "densityPlotLabelSize"}], "}"}]}], 
      ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"ColorData", "[", "colorScheme", "]"}]}], ",", 
      RowBox[{"PerformanceGoal", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "aspectRatio"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"getLatexStyling", "/@", "frameLabels"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", "Automatic"}], "}"}]}], "}"}]}], "&"}], "@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Superscript", "[", 
            RowBox[{"10", ",", "i"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], ",", 
      RowBox[{"GridLines", "\[Rule]", "None"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"plotRadiiVelocityHistogramLegended", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Legended", "[", "\[IndentingNewLine]", 
     RowBox[{"#", ",", 
      RowBox[{"BarLegend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"colorScheme", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "9", ",", 
        RowBox[{"LegendMarkerSize", "\[Rule]", "legendSize"}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fontSize", "+", "2"}], ",", "Black", ",", "Bold"}], 
          "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}], "&"}], "@", 
   "plotRadiiVelocityHistogram"}]}]}], "Input",
 CellChangeTimes->{{3.915735795290084*^9, 3.9157358001961713`*^9}, 
   3.915736042813382*^9, {3.915736139052148*^9, 3.9157361811716146`*^9}, {
   3.915736227428466*^9, 3.9157362280362496`*^9}, {3.9157362893956685`*^9, 
   3.915736291826125*^9}, {3.9157363265310993`*^9, 3.9157363669176817`*^9}, {
   3.915736434938649*^9, 3.9157365731067696`*^9}, {3.9157366185869207`*^9, 
   3.9157366831407733`*^9}, {3.915736730476161*^9, 3.915736732571748*^9}, {
   3.9157367666774497`*^9, 3.9157367737161374`*^9}, {3.9157369287612405`*^9, 
   3.9157369298797865`*^9}, {3.915737178901184*^9, 3.915737185863806*^9}, 
   3.915737667127427*^9, {3.9157377235481462`*^9, 3.9157377239523153`*^9}, {
   3.9157388331725264`*^9, 3.9157388343150597`*^9}, {3.915739357679239*^9, 
   3.915739357748043*^9}, {3.916492058645728*^9, 3.9164920681664286`*^9}, 
   3.916492098295985*^9, {3.9164921862877636`*^9, 3.916492217969328*^9}, {
   3.9164922488454237`*^9, 3.9164923159530916`*^9}, {3.9164924572882338`*^9, 
   3.916492473889613*^9}, {3.9164925062661486`*^9, 3.9164925274243298`*^9}, {
   3.9164932212795515`*^9, 3.916493226461316*^9}, {3.9170371049882746`*^9, 
   3.9170371065390253`*^9}, 3.9173477454865103`*^9, {3.917348004517226*^9, 
   3.9173480646230607`*^9}, {3.9173481195748196`*^9, 3.917348121653239*^9}, 
   3.917348188974818*^9, {3.9173484044757323`*^9, 3.917348425418873*^9}, {
   3.917350108769901*^9, 3.917350111237706*^9}, {3.917350141655579*^9, 
   3.917350143058998*^9}, {3.917350421554365*^9, 3.9173504232859993`*^9}, {
   3.9287324364795113`*^9, 3.928732437321635*^9}, {3.9525320795035152`*^9, 
   3.9525321002668233`*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"b6efb721-b3d3-42c8-8378-3e364208eaee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opacityModel", "[", "value_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"value", ">", "hexDisplayThreshold"}], ",", 
    RowBox[{"Opacity", "@", "1"}], ",", 
    RowBox[{"Opacity", "@", "0"}]}], "]"}]}], "\n", 
 RowBox[{"ClearAll", "@", "Hexagon"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "@", "Vertices"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9164821864567504`*^9, 3.916482253808258*^9}, {
   3.916482638593404*^9, 3.916482664719305*^9}, {3.916486909624178*^9, 
   3.916486937926056*^9}, {3.9164869920783052`*^9, 3.916487057551034*^9}, {
   3.9164871652899475`*^9, 3.9164873415425277`*^9}, {3.916487552113742*^9, 
   3.9164875524871397`*^9}, {3.9164876198221874`*^9, 
   3.9164876251267815`*^9}, {3.916487676358471*^9, 3.916487678535117*^9}, {
   3.9164877933360367`*^9, 3.916487797583047*^9}, {3.9164878344091945`*^9, 
   3.9164879333514676`*^9}, {3.9164879694174547`*^9, 
   3.9164879987320004`*^9}, {3.916488143824873*^9, 3.91648816020907*^9}, {
   3.9164882122243056`*^9, 3.9164882579557304`*^9}, {3.916488325385427*^9, 
   3.9164883624125566`*^9}, {3.916488393192866*^9, 3.9164884374476037`*^9}, 
   3.9164884689210577`*^9, 3.9164885013821306`*^9, {3.9164885683788176`*^9, 
   3.916488744983401*^9}, {3.916488777625414*^9, 3.916488870842574*^9}, {
   3.9164890135879173`*^9, 3.916489019256195*^9}, {3.9164891259121513`*^9, 
   3.916489141272584*^9}, {3.916489598402871*^9, 3.9164896347944255`*^9}, {
   3.916490362618971*^9, 3.916490394802356*^9}, {3.916492237309776*^9, 
   3.9164922428186865`*^9}, {3.916492721064706*^9, 3.916492734618147*^9}, 
   3.9164928078012867`*^9, 3.916494002377364*^9, 3.916924019625037*^9, {
   3.9170052786015406`*^9, 3.9170052811280804`*^9}, {3.9170183473350935`*^9, 
   3.9170183504245915`*^9}, {3.917034219698118*^9, 3.9170342199171543`*^9}, {
   3.917037479267267*^9, 3.9170375015871544`*^9}, 3.9525795103474684`*^9},
 CellLabel->
  "In[409]:=",ExpressionUUID->"3bb495d7-8737-4a8e-bfa0-c1e943633cd6"],

Cell["\<\
Defaults :
   
hexBinSplitFactor=0.02;
hexDisplayThreshold=0.02;
colorScheme=\[CloseCurlyDoubleQuote]BlueGreenYellow\[CloseCurlyDoubleQuote];
aspectRatio=1/2.5;

In case of an error, please re-run the Function Definitions cell, then plot \
again\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}, 
   3.9157368454102073`*^9, 3.91573884230005*^9, {3.9170181261303744`*^9, 
   3.91701812778405*^9}, {3.9170181677373314`*^9, 3.917018195576191*^9}, {
   3.9170183030096045`*^9, 3.9170183053547583`*^9}, {3.939193429626299*^9, 
   3.939193445034378*^9}, {3.9525741832717557`*^9, 3.952574186030406*^9}},
 FontSize->16,ExpressionUUID->"28575577-4c9e-465f-8035-7b696d894ae7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fontSize", "=", "12"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"hexBinSplitFactor", "=", "0.015"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"colorScheme", "=", "\"\<BlueGreenYellow\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"colorScheme", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<RedBlueTones\>\"", ",", "\"\<Reverse\>\""}], "}"}]}], 
    ";"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"hexDisplayThreshold", "=", "0.045"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"plotRange", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.225"}], ",", "1.9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.15", ",", "1.25"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"legendSize", "=", "150"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"aspectRatio", "=", 
    RowBox[{"1", "/", "2.5"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"frameLabels", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<\\\\lVert \\\\vec{v} \\\\rVert, ~\\\\mu m/s\>\"", ",", 
      "\[IndentingNewLine]", "\"\<r_{\\\\text{bacteria}},~\\\\mu m\>\""}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"hexPlotFrameTicks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"#", ",", "Automatic"}], "}"}]}], "}"}], "&"}], "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Superscript", "[", 
         RowBox[{"10", ",", "i"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9164821864567504`*^9, 3.916482253808258*^9}, {
   3.916482638593404*^9, 3.916482664719305*^9}, {3.916486909624178*^9, 
   3.916486937926056*^9}, {3.9164869920783052`*^9, 3.916487057551034*^9}, {
   3.9164871652899475`*^9, 3.91648737668582*^9}, {3.916487814903083*^9, 
   3.9164878152413445`*^9}, {3.9164879022729654`*^9, 
   3.9164879038149905`*^9}, {3.9164879590535417`*^9, 
   3.9164880050944586`*^9}, {3.916488051504553*^9, 3.9164880851074667`*^9}, {
   3.916488129720036*^9, 3.9164881322288017`*^9}, {3.916488167046026*^9, 
   3.916488178274112*^9}, 3.916488385086907*^9, 3.916488454862877*^9, {
   3.9164885870862103`*^9, 3.9164885886808453`*^9}, {3.9164888623347816`*^9, 
   3.916488895320959*^9}, 3.9164891026962013`*^9, {3.9164892186489754`*^9, 
   3.9164892479267545`*^9}, 3.916489299206959*^9, 3.9164893578541403`*^9, {
   3.9164894438408766`*^9, 3.916489444925701*^9}, {3.9164896228070126`*^9, 
   3.9164896288854437`*^9}, {3.916490365013877*^9, 3.9164903896153264`*^9}, {
   3.9164927814015503`*^9, 3.9164928029445677`*^9}, {3.9164929271637964`*^9, 
   3.9164929697752285`*^9}, 3.916493006983545*^9, {3.9164930465221415`*^9, 
   3.9164931920266795`*^9}, 3.916493234078109*^9, {3.9164934164567413`*^9, 
   3.9164934165190115`*^9}, {3.9164935306955633`*^9, 3.9164935587362976`*^9}, 
   3.9164936117047653`*^9, {3.9164936844244003`*^9, 3.916493705745996*^9}, {
   3.9164939264716196`*^9, 3.9164940543889456`*^9}, {3.917018150439307*^9, 
   3.917018179690077*^9}, {3.917018316129195*^9, 3.917018316819105*^9}, {
   3.9170184366515875`*^9, 3.9170184804195733`*^9}, {3.9170187684333105`*^9, 
   3.9170188222354126`*^9}, {3.9170342439817266`*^9, 3.91703424703453*^9}, {
   3.9170343622444825`*^9, 3.917034372954815*^9}, {3.9170375203640723`*^9, 
   3.917037562934087*^9}, {3.917039751515636*^9, 3.9170398277641506`*^9}, {
   3.917039889676105*^9, 3.9170398904023743`*^9}, {3.917059921153411*^9, 
   3.9170599495743866`*^9}, {3.9170599902660427`*^9, 
   3.9170600202466364`*^9}, {3.917101418375786*^9, 3.9171014926573524`*^9}, 
   3.9171022721828074`*^9, {3.917102305303567*^9, 3.9171023546701326`*^9}, {
   3.91710249029887*^9, 3.917102490930393*^9}, {3.91710255019564*^9, 
   3.917102577472559*^9}, {3.917102961703131*^9, 3.917102962926014*^9}, {
   3.9171030383914547`*^9, 3.917103040351465*^9}, 3.9173483484876537`*^9, {
   3.9173485124696417`*^9, 3.9173485310375543`*^9}, {3.9173486199429293`*^9, 
   3.9173486347910137`*^9}, 3.917348710974928*^9, 3.917349786801526*^9, {
   3.9173505757783995`*^9, 3.9173505851716166`*^9}, 3.917351627616289*^9, {
   3.9173516891674137`*^9, 3.9173517543270636`*^9}, {3.9173518839320693`*^9, 
   3.9173519017193594`*^9}, {3.917499295608034*^9, 3.9174994164188814`*^9}, {
   3.917542797269911*^9, 3.9175427983639374`*^9}, {3.927000525252324*^9, 
   3.927000560690583*^9}, {3.9270006046919727`*^9, 3.9270006264268703`*^9}, {
   3.9391861339791403`*^9, 3.939186201018912*^9}, {3.9391941598619986`*^9, 
   3.9391941867959576`*^9}, {3.9392052435647535`*^9, 
   3.9392053160922675`*^9}, {3.9392110072555804`*^9, 
   3.9392110637139463`*^9}, {3.9512915904513054`*^9, 3.951291701147048*^9}, {
   3.951292120564643*^9, 3.9512921914364104`*^9}, {3.9512922268043175`*^9, 
   3.951292226899731*^9}, 3.9518017675349064`*^9, {3.951810689854472*^9, 
   3.951810709199012*^9}, {3.951879819486988*^9, 3.9518798733195944`*^9}, {
   3.9525310690128155`*^9, 3.9525310738064957`*^9}, {3.952532288423273*^9, 
   3.9525322909741435`*^9}, {3.9525355453862047`*^9, 3.952535636048688*^9}, {
   3.952574163179779*^9, 3.9525741642430763`*^9}, {3.952578169250729*^9, 
   3.9525781759559517`*^9}, {3.9525795739178667`*^9, 3.9525795835259*^9}, {
   3.9525796146808395`*^9, 3.952579625842992*^9}, {3.952579659963883*^9, 
   3.9525797267073393`*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"523b10ca-7f65-49af-8c23-31a2243f4eb3"],

Cell[BoxData[
 RowBox[{"plotRadiiVelocityHistogramHexplot", "=", 
  RowBox[{
   RowBox[{"hexBinPlot", "[", "\[IndentingNewLine]", 
    RowBox[{"radiiDisplacementsAbs", ",", "hexBinSplitFactor", ",", "1"}], 
    "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.916490474030081*^9, 3.9164904805982604`*^9}, {
   3.9164905480092945`*^9, 3.916490627640668*^9}, {3.916490867927307*^9, 
   3.9164909122868953`*^9}, {3.916491289463844*^9, 3.9164912972530994`*^9}, {
   3.9164921433639126`*^9, 3.916492155355933*^9}, 3.9164929575817947`*^9, {
   3.916493324017359*^9, 3.9164933269598627`*^9}, {3.9164940243424473`*^9, 
   3.916494024934919*^9}, {3.9170189732104588`*^9, 3.9170189860501213`*^9}, {
   3.9170341656892223`*^9, 3.9170341672521486`*^9}, {3.9170600105267277`*^9, 
   3.9170600117961946`*^9}, {3.9171014617754188`*^9, 3.917101463062349*^9}, {
   3.939205279971901*^9, 3.9392052813557324`*^9}},
 CellLabel->
  "In[491]:=",ExpressionUUID->"f49f9f32-aac6-4b12-a1e1-57aadd75db7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"exportImagesTwoFormat", "[", "\[IndentingNewLine]", 
    RowBox[{
    "plotRadiiVelocityHistogramLegended", ",", 
     "\"\<Bacteria_radii_velocity_histogram\>\"", ",", "200"}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", "\[IndentingNewLine]", 
   RowBox[{
   "plotRadiiVelocityHistogramHexplot", ",", 
    "\"\<Bacteria_radii_velocity_histogram_hexplot\>\"", ",", "200"}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.915648115010803*^9, 3.9156481330422773`*^9}, 
   3.915708275405222*^9, {3.9157353754428544`*^9, 3.9157353759778137`*^9}, {
   3.91573687019776*^9, 3.9157368813252993`*^9}, {3.915737073877739*^9, 
   3.9157370748919*^9}, {3.915737115254693*^9, 3.915737116261586*^9}, 
   3.9164925678010235`*^9, {3.916492628624577*^9, 3.9164926432548285`*^9}, {
   3.916493721425295*^9, 3.916493723399071*^9}, 3.9173491447733283`*^9, 
   3.9173491823031673`*^9, {3.917351776998371*^9, 3.917351792633855*^9}},
 CellLabel->
  "In[492]:=",ExpressionUUID->"911e6823-b1cb-4246-8235-9fcef9d04411"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bacteria Size/Velocity Populations", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000536168066792`*^9}, {3.9006897623986382`*^9, 
   3.9006897640348864`*^9}, {3.915225186935465*^9, 3.915225188518117*^9}, {
   3.915646936249711*^9, 3.915646945438861*^9}, {3.915708512980127*^9, 
   3.9157085222663326`*^9}, {3.915734862754013*^9, 3.9157348702665644`*^9}, {
   3.915736073674736*^9, 3.915736075298809*^9}, {3.9524916703816123`*^9, 
   3.952491672429102*^9}},
 FontSize->24,ExpressionUUID->"ffda348c-707a-4576-9958-3bf53e7c0b40"],

Cell[CellGroupData[{

Cell["Get & Format Radii/Velocity Bins", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 3.915222540309099*^9}, 
   3.9156274163924828`*^9, {3.91562792161534*^9, 3.915627925454192*^9}, {
   3.915710406724619*^9, 3.915710411066506*^9}, {3.915739689635098*^9, 
   3.915739694739092*^9}, {3.952533461271457*^9, 
   3.952533473917592*^9}},ExpressionUUID->"9872da17-9b74-49f1-8c7f-\
5b56583ce302"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"radiiDisplacementsBins", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"HistogramList", "[", 
       RowBox[{"#", ",", "histogramBinningMethod", ",", "\"\<PDF\>\""}], 
       "]"}], "&"}], "@", "radiiDisplacementsAbs"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"binCentersX", ",", "binCentersY"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"MovingAverage", "[", 
       RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"radiiDisplacementsBins", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"radiiDisplacementsBins", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radiiDisplacementsBinsFormatted", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"binCentersX", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", 
        RowBox[{"binCentersY", "[", 
         RowBox[{"[", "m", "]"}], "]"}], ",", 
        RowBox[{"radiiDisplacementsBins", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "k", ",", "m"}], "]"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "binCentersX"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"Length", "@", "binCentersY"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListPlot3D", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
        RowBox[{"{", 
         RowBox[{"plotRange", ",", 
          RowBox[{"{", "All", "}"}]}], "}"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"ColorData", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<RedBlueTones\>\"", ",", "\"\<Reversed\>\""}], "}"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
  "radiiDisplacementsBinsFormatted"}]}], "Input",
 CellChangeTimes->{{3.9518173575506167`*^9, 3.9518174135257893`*^9}, {
  3.951817472152143*^9, 3.951817478031337*^9}, {3.951818055898658*^9, 
  3.95181806381155*^9}, {3.951818663433905*^9, 3.951818665335776*^9}, {
  3.9518190727952023`*^9, 3.9518190798553343`*^9}, {3.9518202671172347`*^9, 
  3.9518202694334154`*^9}, {3.952532343400937*^9, 3.9525324314964333`*^9}, {
  3.9525380860745754`*^9, 3.9525380878406825`*^9}},
 CellLabel->
  "In[494]:=",ExpressionUUID->"0e3fce83-583a-4a50-9a15-ffe778e1c54a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "dataCompressedfolder", "<>", "\"\<Bins PDF Velocity Radii.txt\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", "radiiDisplacementsBinsFormatted"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.952532615810728*^9, 3.9525326895052843`*^9}},
 CellLabel->
  "In[498]:=",ExpressionUUID->"c5a1212c-25cf-48c0-8b37-4fa8a7d7b9c6"]
}, Closed]],

Cell[CellGroupData[{

Cell["2D N-Gaussian Fit", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 3.915222540309099*^9}, 
   3.9156274163924828`*^9, {3.91562792161534*^9, 3.915627925454192*^9}, {
   3.915710406724619*^9, 3.915710411066506*^9}, {3.915739689635098*^9, 
   3.915739694739092*^9}, {3.952533461271457*^9, 
   3.952533486126015*^9}},ExpressionUUID->"dc581774-72a4-4de4-bfd4-\
4286cc10be2a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "x"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "@", "y"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaussian2D", "[", 
    RowBox[{"x", ",", "y", ",", 
     SubscriptBox["\[Mu]", "1"], ",", 
     SubscriptBox["\[Mu]", "2"], ",", 
     SubscriptBox["\[Sigma]", "1"], " ", ",", 
     SubscriptBox["\[Sigma]", "2"], ",", "\[Rho]", ",", "a"}], "]"}], "//", 
   "TeXForm"}], "//", "getLatexStyling"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"variables2D", "@", "3"}], "//", "MatrixForm"}], "//", 
   "TeXForm"}], "//", "getLatexStyling"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951974963369756*^9, 3.9519749638031425`*^9}, 
   3.951997366550952*^9, {3.9525329844412813`*^9, 3.952533021230056*^9}, {
   3.9525381032958636`*^9, 3.9525381295199347`*^9}, {3.952574663185354*^9, 
   3.952574676301906*^9}},
 CellLabel->
  "In[499]:=",ExpressionUUID->"667692a7-630a-4871-b7cd-2a600830b8fc"],

Cell["\<\
Defaults :
   
constraintFactorMagnitude=50;
constraintFactorDeviation=2;
constraintLowerBound=0.001;
fitGoodnessMeasure=\[CloseCurlyDoubleQuote]AIC\[CloseCurlyDoubleQuote];    >> \
\[OpenCurlyDoubleQuote]AIC\[CloseCurlyDoubleQuote] or (for small datasets) \
\[OpenCurlyDoubleQuote]AICc\[CloseCurlyDoubleQuote]\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}, 
   3.9157368454102073`*^9, 3.91573884230005*^9, {3.9170181261303744`*^9, 
   3.91701812778405*^9}, {3.9170181677373314`*^9, 3.917018195576191*^9}, {
   3.9170183030096045`*^9, 3.9170183053547583`*^9}, {3.939193429626299*^9, 
   3.939193445034378*^9}, 3.9525333699608364`*^9, 3.952535050039613*^9, {
   3.9525673254683022`*^9, 3.952567342748459*^9}, {3.952579849202073*^9, 
   3.952579856690034*^9}},
 FontSize->16,ExpressionUUID->"7bd06757-b0ff-4792-b792-f5562b105aff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"constraintFactorMagnitude", "=", "50"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constraintFactorDeviation", "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constraintLowerBound", "=", "0.001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitGoodnessMeasure", "=", "\"\<AIC\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.952533211794696*^9, 3.9525333351267443`*^9}, {
  3.9525350452311316`*^9, 3.9525350469853687`*^9}},
 CellLabel->
  "In[503]:=",ExpressionUUID->"9336249b-cad8-4213-ab31-2aeb0f9b911c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fitData", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "@", "#"}], ">", "0"}], "&"}]}], "]"}], "&"}], "@", 
      RowBox[{"Flatten", "[", 
       RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
    "radiiDisplacementsBinsFormatted"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"parameters2D", "@", "3"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"model2D", "@", "3"}], "//", "Quiet"}], "//", "TeXForm"}], "//", 
  "getLatexStyling"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"constraints2D", "[", 
     RowBox[{"3", ",", "fitData"}], "]"}], "//", "TableForm"}], "//", 
   "TeXForm"}], "//", "getLatexStyling"}]}], "Input",
 CellChangeTimes->{{3.9519750246730623`*^9, 3.9519750265777864`*^9}, {
   3.951975167918482*^9, 3.9519752013657875`*^9}, {3.9519760153378167`*^9, 
   3.951976025996726*^9}, {3.9519779601299577`*^9, 3.9519779627522583`*^9}, {
   3.951978398754021*^9, 3.9519784082580504`*^9}, {3.951979068555457*^9, 
   3.9519790798035593`*^9}, {3.951996949894306*^9, 3.9519969545922527`*^9}, {
   3.951997484401371*^9, 3.9519974904147315`*^9}, 3.951998002191824*^9, 
   3.952000464515502*^9, {3.9520052031286316`*^9, 3.952005224587554*^9}, 
   3.9524931263854914`*^9, {3.952533151514842*^9, 3.952533180102294*^9}},
 CellLabel->
  "In[507]:=",ExpressionUUID->"432d5d3e-74af-4061-9e5e-2108251b82e5"],

Cell["\<\
Defaults :
   
maxGaussianCount=5;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}, 
   3.9157368454102073`*^9, 3.91573884230005*^9, {3.9170181261303744`*^9, 
   3.91701812778405*^9}, {3.9170181677373314`*^9, 3.917018195576191*^9}, {
   3.9170183030096045`*^9, 3.9170183053547583`*^9}, {3.939193429626299*^9, 
   3.939193445034378*^9}, 3.9525333699608364`*^9, 3.952535050039613*^9, 
   3.952567257606496*^9},
 FontSize->16,ExpressionUUID->"4ccbb041-c677-45d0-8f0b-c99311c17a0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxGaussianCount", "=", "5"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.952533211794696*^9, 3.9525333351267443`*^9}, {
  3.9525350452311316`*^9, 3.9525350469853687`*^9}, {3.952567241581662*^9, 
  3.952567246252286*^9}},
 CellLabel->
  "In[511]:=",ExpressionUUID->"56cdb3eb-4f6a-4747-9fb2-7d4b3b735fca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fitModel", "=", 
    RowBox[{
     RowBox[{"fitMultiGauss2D", "[", 
      RowBox[{"fitData", ",", "maxGaussianCount"}], "]"}], "//", "Quiet"}]}], 
   ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.915808682710224*^9, 3.915808745333336*^9}, {
   3.9158088196139708`*^9, 3.915808972172538*^9}, {3.915809251855893*^9, 
   3.915809251965021*^9}, {3.915809344518675*^9, 3.91580942740702*^9}, {
   3.9158095040287952`*^9, 3.915809506140175*^9}, 3.9158095633263583`*^9, {
   3.9158096076693563`*^9, 3.91580962449994*^9}, {3.915809693135312*^9, 
   3.9158097398061204`*^9}, {3.9158103612850513`*^9, 
   3.9158103627787647`*^9}, {3.9158104181893263`*^9, 
   3.9158104194360123`*^9}, {3.915810580577323*^9, 3.9158105929348273`*^9}, {
   3.9158111314089737`*^9, 3.9158111343313537`*^9}, 3.915811338086918*^9, {
   3.9158116892285137`*^9, 3.9158116934686728`*^9}, {3.915811855807384*^9, 
   3.9158118966131167`*^9}, {3.9158119740220127`*^9, 
   3.9158119743002706`*^9}, {3.9158128688601522`*^9, 
   3.9158128699208736`*^9}, {3.9158133160296535`*^9, 3.915813326660072*^9}, {
   3.915813460604691*^9, 3.9158134829019785`*^9}, {3.9158136587089996`*^9, 
   3.915813660775992*^9}, {3.915814369813246*^9, 3.9158143701717625`*^9}, 
   3.9158152112457647`*^9, {3.91581737047248*^9, 3.915817372276557*^9}, {
   3.915817510540058*^9, 3.9158175427322006`*^9}, 3.951813419370615*^9, 
   3.9518134700581264`*^9, {3.951813514046485*^9, 3.951813558939022*^9}, {
   3.9518140071177163`*^9, 3.951814020115408*^9}, {3.9518140522595053`*^9, 
   3.9518140662920036`*^9}, 3.9518141936193943`*^9, {3.951821065659751*^9, 
   3.951821067325218*^9}, 3.9518211396128635`*^9, {3.951898771540085*^9, 
   3.9518987873151865`*^9}, 3.951968578608906*^9, 3.951968612545292*^9, {
   3.951974158223349*^9, 3.9519741615030146`*^9}, {3.9519752513826094`*^9, 
   3.9519753546400375`*^9}, 3.95197539246736*^9, 3.9519792047476397`*^9, 
   3.9519975094859858`*^9, 3.9519980070803146`*^9, {3.951999607546294*^9, 
   3.9519996625274696`*^9}, 3.9519997072682385`*^9, 3.9519997939311976`*^9, {
   3.952006858457372*^9, 3.952006862873791*^9}, {3.952095041118844*^9, 
   3.952095059008248*^9}, {3.9525333999121494`*^9, 3.952533427917816*^9}, 
   3.952567251111596*^9},
 CellLabel->
  "In[512]:=",ExpressionUUID->"a66dd750-3ad2-48ec-a81b-b11284bd5ce8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extract Population Parameters", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.9152225149927397`*^9, 3.915222540309099*^9}, 
   3.9156274163924828`*^9, {3.91562792161534*^9, 3.915627925454192*^9}, {
   3.915710406724619*^9, 3.915710411066506*^9}, {3.915739689635098*^9, 
   3.915739694739092*^9}, {3.952533461271457*^9, 3.9525335172231255`*^9}, {
   3.9525336192461896`*^9, 
   3.952533624975685*^9}},ExpressionUUID->"c52af2f1-08ff-4f18-8efd-\
55bfd666bf0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelID", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Last", "/@", "fitModel"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedModel", "=", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"fitModel", "[", 
      RowBox[{"[", "modelID", "]"}], "]"}]}], "//", "Quiet"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "@", "selectedModel"}], "//", "TeXForm"}], "//", 
  "getLatexStyling"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedModel", "[", "\"\<ParameterTable\>\"", "]"}], "//", 
  "Quiet"}]}], "Input",
 CellChangeTimes->{{3.915808682710224*^9, 3.915808745333336*^9}, {
   3.9158088196139708`*^9, 3.915808972172538*^9}, {3.915809251855893*^9, 
   3.915809251965021*^9}, {3.915809344518675*^9, 3.91580942740702*^9}, {
   3.9158095040287952`*^9, 3.915809506140175*^9}, 3.9158095633263583`*^9, {
   3.9158096076693563`*^9, 3.91580962449994*^9}, {3.915809693135312*^9, 
   3.9158097398061204`*^9}, {3.9158103612850513`*^9, 
   3.9158103627787647`*^9}, {3.9158104181893263`*^9, 
   3.9158104194360123`*^9}, {3.915810580577323*^9, 3.9158105929348273`*^9}, {
   3.9158111314089737`*^9, 3.9158111343313537`*^9}, 3.915811338086918*^9, {
   3.9158116892285137`*^9, 3.9158116934686728`*^9}, {3.915811855807384*^9, 
   3.9158118966131167`*^9}, {3.9158119740220127`*^9, 
   3.9158119743002706`*^9}, {3.9158128688601522`*^9, 
   3.9158128699208736`*^9}, {3.9158133160296535`*^9, 3.915813326660072*^9}, {
   3.915813460604691*^9, 3.9158134829019785`*^9}, {3.9158136587089996`*^9, 
   3.915813660775992*^9}, {3.915814369813246*^9, 3.9158143701717625`*^9}, 
   3.9158152112457647`*^9, {3.91581737047248*^9, 3.915817372276557*^9}, {
   3.915817510540058*^9, 3.9158175427322006`*^9}, 3.951813419370615*^9, 
   3.9518134700581264`*^9, {3.951813514046485*^9, 3.951813558939022*^9}, {
   3.9518140071177163`*^9, 3.951814020115408*^9}, {3.9518140522595053`*^9, 
   3.9518140662920036`*^9}, 3.9518141936193943`*^9, {3.951821065659751*^9, 
   3.951821067325218*^9}, 3.9518211396128635`*^9, {3.951898771540085*^9, 
   3.9518987873151865`*^9}, 3.951968578608906*^9, 3.951968612545292*^9, {
   3.951974158223349*^9, 3.9519741615030146`*^9}, {3.9519752513826094`*^9, 
   3.9519753546400375`*^9}, 3.95197539246736*^9, 3.951978566468691*^9, 
   3.9519790062673073`*^9, {3.9519794950039587`*^9, 3.951979581691633*^9}, {
   3.9519797000769105`*^9, 3.951979737515006*^9}, {3.9519805526368823`*^9, 
   3.9519806015595217`*^9}, {3.9519975996454697`*^9, 3.9519976009174547`*^9}, 
   3.951997918814508*^9, {3.9519979840006776`*^9, 3.9519979906065464`*^9}, 
   3.951998460118765*^9, {3.9520013451722507`*^9, 3.952001346489485*^9}, {
   3.9520052374226246`*^9, 3.952005238430502*^9}, 3.952006876072777*^9, {
   3.952007113275464*^9, 3.9520071139131756`*^9}, {3.952007818811149*^9, 
   3.952007829058889*^9}, {3.9520125753556547`*^9, 3.952012660011985*^9}, 
   3.9520517848394504`*^9, 3.952051937493509*^9, 3.9520950494709487`*^9, {
   3.952097871203683*^9, 3.9520978970425973`*^9}, {3.9520988571585703`*^9, 
   3.952098857259654*^9}, {3.952533525184939*^9, 3.952533532747903*^9}, {
   3.9525381544326305`*^9, 3.9525381586471434`*^9}, 3.9525756467697797`*^9, {
   3.9525757077601457`*^9, 3.9525757327517753`*^9}, {3.9525758563808203`*^9, 
   3.9525758748970127`*^9}, {3.9525759253845615`*^9, 3.9525759256734657`*^9}, 
   3.952576272110021*^9, 3.9525763481937294`*^9, 3.9525782786050167`*^9, {
   3.9525799387653675`*^9, 3.9525799682499847`*^9}},
 CellLabel->
  "In[552]:=",ExpressionUUID->"3a31fbbe-082d-41b8-b5de-1ac635cd3342"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Length", "@", 
       RowBox[{"variables2D", "@", "1"}]}]}], "]"}], "&"}], "@", 
   RowBox[{"selectedModel", "[", "\"\<BestFitParameters\>\"", "]"}]}], "//", 
  "TableForm"}], "\n", 
 RowBox[{
  RowBox[{"fitModelParameters", "=", 
   RowBox[{"getGaussianEllipseParameters", "@", "selectedModel"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixForm", "/@", "#"}], "&"}], "/@", "fitModelParameters"}], "//",
   "TableForm"}]}], "Input",
 CellChangeTimes->{{3.951998050103772*^9, 3.951998094006057*^9}, {
   3.9520050790635185`*^9, 3.952005080035453*^9}, 3.9525335891675496`*^9, 
   3.952538211712447*^9},
 CellLabel->
  "In[557]:=",ExpressionUUID->"a06f9a06-78f5-4677-be5f-2cd91bf1b4a6"],

Cell["\<\
Defaults :
   
populationQuantile=0.68;  (1 sigma; 0.95 for 2 sigma)
populationEllipseColor=Red;

Initial `drawIDs`:
drawIDs=Range@Length@fitModelParameters;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}, 
   3.9157368454102073`*^9, 3.91573884230005*^9, {3.9170181261303744`*^9, 
   3.91701812778405*^9}, {3.9170181677373314`*^9, 3.917018195576191*^9}, {
   3.9170183030096045`*^9, 3.9170183053547583`*^9}, {3.939193429626299*^9, 
   3.939193445034378*^9}, 3.9525333699608364`*^9, 3.952535050039613*^9, 
   3.952535227673063*^9, 3.952535463059251*^9, 3.9525357499112873`*^9, {
   3.9525358109263024`*^9, 3.952535812822243*^9}, {3.9525675937343435`*^9, 
   3.9525676356688004`*^9}, 3.9525754390405455`*^9, {3.952575575040656*^9, 
   3.9525755773410664`*^9}, {3.952576631919241*^9, 3.952576650693914*^9}},
 FontSize->16,ExpressionUUID->"4eb98b75-4d5c-4511-8fbd-d0c97b56c3f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"populationQuantile", "=", "0.68"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"populationEllipseColor", "=", "Red"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.952535241360672*^9, 3.952535248072281*^9}, {
   3.9525354556474495`*^9, 3.952535481381735*^9}, {3.952535514816663*^9, 
   3.952535515826414*^9}, {3.952535688632518*^9, 3.9525356890306063`*^9}, {
   3.9525357194647274`*^9, 3.952535745950363*^9}, {3.9525357837600117`*^9, 
   3.952535809447526*^9}, 3.9525764018676844`*^9, 3.9525766255451145`*^9},
 CellLabel->
  "In[562]:=",ExpressionUUID->"1fb49f1b-cca7-485c-b877-134994499c33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"drawIDs", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListDensityPlot", "[", "\[IndentingNewLine]", 
    RowBox[{"#", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
      RowBox[{"{", 
       RowBox[{"plotRange", ",", 
        RowBox[{"{", "All", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"ColorData", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<RedBlueTones\>\"", ",", "\"\<Reversed\>\""}], "}"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"getGaussianEllipseGraphics", "/@", 
       RowBox[{"fitModelParameters", "[", 
        RowBox[{"[", "drawIDs", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}], "&"}], "@", "fitData"}]}], "Input",
 CellChangeTimes->{{3.9521793081701937`*^9, 3.952179364703387*^9}, {
   3.952181152211191*^9, 3.952181256972704*^9}, {3.9521813003047547`*^9, 
   3.952181302170418*^9}, {3.9521813628780284`*^9, 3.9521814003365145`*^9}, {
   3.952181790386983*^9, 3.9521817920490494`*^9}, {3.952517437980091*^9, 
   3.952517461465311*^9}, {3.9525183330824623`*^9, 3.9525183355953856`*^9}, {
   3.9525183684829645`*^9, 3.952518400025206*^9}, {3.9525184728634777`*^9, 
   3.952518506542028*^9}, {3.9525336538211737`*^9, 3.9525336709974847`*^9}, 
   3.9525338076008177`*^9, {3.952533849023369*^9, 3.9525338491927323`*^9}, {
   3.9525338818753953`*^9, 3.952533906605833*^9}, {3.952535204250213*^9, 
   3.9525352306818447`*^9}, {3.9525353130815277`*^9, 
   3.9525353166873245`*^9}, {3.9525353502002277`*^9, 3.9525354068265843`*^9}, 
   3.952535468104391*^9, 3.9525382552087526`*^9, {3.952538497632367*^9, 
   3.9525385119774065`*^9}, {3.9525675460469184`*^9, 
   3.9525675764367075`*^9}, {3.9525676291678257`*^9, 3.9525676429509263`*^9}, 
   3.952575001699318*^9, 3.952575443915881*^9, {3.9525755856894484`*^9, 
   3.9525756614442987`*^9}, {3.9525758254733105`*^9, 
   3.9525758683354006`*^9}, {3.952575946610072*^9, 3.952575994191745*^9}, {
   3.9525762807241883`*^9, 3.9525763039351816`*^9}, {3.952576359954139*^9, 
   3.952576371918912*^9}, 3.952578295755622*^9, 3.9525784249877844`*^9, 
   3.952579822075369*^9, {3.952580407148075*^9, 3.9525804233129225`*^9}},
 CellLabel->
  "In[574]:=",ExpressionUUID->"952f83f7-33e1-4a92-8b64-95792f47858c"],

Cell[BoxData[
 RowBox[{"plotBacteriaRadiiVelocityPopulations", "=", 
  RowBox[{
   RowBox[{"hexBinPlotPopulations", "[", "\[IndentingNewLine]", 
    RowBox[{
    "radiiDisplacementsAbs", ",", "hexBinSplitFactor", ",", "1", ",", 
     "drawIDs"}], "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.952534323160977*^9, 3.952534323873107*^9}, {
  3.952534561183914*^9, 3.952534578185422*^9}, {3.952535951677676*^9, 
  3.9525359683584294`*^9}},
 CellLabel->
  "In[576]:=",ExpressionUUID->"331a7bf8-efd9-4330-9945-996ed2c96f7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", "\[IndentingNewLine]", 
   RowBox[{
   "plotBacteriaRadiiVelocityPopulations", ",", "\[IndentingNewLine]", 
    "\"\<Bacteria_radii_velocity_hexplot_populations\>\"", ",", "200"}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9525359364160786`*^9, 3.952535978198913*^9}},
 CellLabel->
  "In[577]:=",ExpressionUUID->"079919ce-1e4c-48d1-8b73-08a038660f62"],

Cell[BoxData[
 RowBox[{"populationParameterTable", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"getGaussianParametersErrors", "[", 
       RowBox[{"selectedModel", ",", "drawIDs"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TableHeadings", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"None", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(1\)]\)\>\"", ",", 
           "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(2\)]\)\>\"", ",", 
           "\"\<\!\(\*SubscriptBox[\(\[Sigma]\), \(1\)]\)\>\"", ",", 
           "\"\<\!\(\*SubscriptBox[\(\[Sigma]\), \(2\)]\)\>\"", ",", 
           "\"\<\[Rho]\>\""}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}], "//", "TeXForm"}], "//", "getLatexStyling"}]}]], "Input",
 CellChangeTimes->{{3.95253767610423*^9, 3.952537704355642*^9}, {
  3.9525377411147985`*^9, 3.952537746719947*^9}, {3.952538273936964*^9, 
  3.9525382751683083`*^9}},
 CellLabel->
  "In[578]:=",ExpressionUUID->"cc5ae4ab-f06c-4e6f-8395-51cdcef949a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "output", "<>", 
     "\"\<Population_parameter_table_velocity_radius.pdf\>\""}], ",", 
    "populationParameterTable"}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9525377543567467`*^9, 3.952537795503044*^9}, 
   3.9525378317698784`*^9, {3.9525695578007245`*^9, 3.952569561448147*^9}},
 CellLabel->
  "In[579]:=",ExpressionUUID->"269ac135-e2db-428a-9d5b-500cc1ec1732"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export Notebook With Parameters", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.842969150048052*^9, 3.8429691537910447`*^9}, {3.8615435122762966`*^9, 
  3.861543517725723*^9}, {3.890209056062702*^9, 
  3.89020905769811*^9}},ExpressionUUID->"462bb91e-cca9-42ca-a1c5-\
5aaf623a0bea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"notebookID", "=", "2"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookSave", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"notebookSnapshot", "=", 
    RowBox[{"NotebookOpen", "@", 
     RowBox[{"NotebookFileName", "[", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"output", "<>", 
        RowBox[{"Last", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"#", ",", "$PathnameSeparator"}], "]"}]}]}], "&"}], "@", 
      "output"}], "<>", "\"\<_Run_\>\"", "<>", 
     RowBox[{"ToString", "@", "notebookID"}], "<>", "\"\<.pdf\>\""}], ",", 
    "notebookSnapshot"}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.861543175536664*^9, 3.8615432357785387`*^9}, {
   3.86154342636442*^9, 3.861543447540553*^9}, {3.861543590796198*^9, 
   3.8615435924374075`*^9}, {3.861798817780515*^9, 3.861798818319141*^9}, {
   3.88928857082766*^9, 3.8892885935714035`*^9}, {3.889300824400525*^9, 
   3.889300826019042*^9}, {3.8900794555092363`*^9, 3.8900794592661676`*^9}, 
   3.8902083844570394`*^9, 3.890209069048913*^9, 3.8902093067789917`*^9, {
   3.8905940957431183`*^9, 3.890594096652687*^9}, 3.8905942440505*^9, {
   3.8941325023793926`*^9, 3.8941325032889395`*^9}, {3.89469919779359*^9, 
   3.894699197823932*^9}, {3.8947136469968*^9, 3.8947136482268553`*^9}, 
   3.8948274270813093`*^9, 3.8948275185738883`*^9, 3.896442076226533*^9, 
   3.9100898814482017`*^9, 3.910425786437649*^9, 3.9126150068030386`*^9, 
   3.912688067441677*^9, {3.912689997393589*^9, 3.912689998663714*^9}, 
   3.915226205688525*^9, 3.915645567121797*^9, 3.9278080508718495`*^9, {
   3.9391862441235204`*^9, 3.9391862442023163`*^9}, 3.939194059043627*^9, 
   3.939200121256432*^9, {3.941862421916143*^9, 3.9418624219590325`*^9}, {
   3.951291748810004*^9, 3.9512917514661183`*^9}, 3.951292305340238*^9, 
   3.951795081434761*^9, 3.9518329453462086`*^9, 3.951833037442835*^9},
 CellLabel->
  "In[584]:=",ExpressionUUID->"005b31f7-40f6-4a4c-a4e8-fd16784b653f"]
}, Closed]]
},
WindowSize->{766.8, 790.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{"TryRealOnly" -> False},
Magnification:>1. Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 9, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"572c1fb0-6990-41ea-b335-5a278486d73b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 228, 3, 73, "Abstract",ExpressionUUID->"a76476ed-08a0-407d-a6e0-2949da3fdc82"],
Cell[CellGroupData[{
Cell[811, 27, 572, 7, 35, "Item",ExpressionUUID->"6a59745b-6ad2-4ef1-89fd-eb4066bc4f53"],
Cell[1386, 36, 614, 9, 35, "Item",ExpressionUUID->"cae2cf31-d2d5-486b-a36b-ac3252bfc56e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2037, 50, 591, 9, 67, "Section",ExpressionUUID->"10050003-92b2-41b0-8436-5d8cb5b7cce9"],
Cell[2631, 61, 11443, 255, 1586, "Input",ExpressionUUID->"9f6bf2bf-eab3-43ac-8b5f-7574dacd0084",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[14111, 321, 564, 8, 53, "Section",ExpressionUUID->"7fc10344-7ed1-41e1-89e5-a93daa297024"],
Cell[14678, 331, 2433, 46, 522, "Abstract",ExpressionUUID->"18851393-ebac-4058-8d97-b1bd19b45a11"],
Cell[17114, 379, 18363, 324, 962, "Input",ExpressionUUID->"5d27874b-1d64-47be-80b3-3921d9f48e56",
 InitializationCell->True],
Cell[35480, 705, 2282, 48, 244, "Input",ExpressionUUID->"58d0290c-3868-4660-a823-1a43ede7fa0e"],
Cell[37765, 755, 533, 12, 88, "Input",ExpressionUUID->"6efd5adc-cdfe-4a2a-820b-d6417445bf63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38335, 772, 569, 8, 67, "Section",ExpressionUUID->"052c7a4d-1f88-45d3-b591-7e016adebad1"],
Cell[CellGroupData[{
Cell[38929, 784, 192, 2, 59, "Subsection",ExpressionUUID->"bdfa3a54-80d1-425a-b669-e0bc8e973848"],
Cell[39124, 788, 22249, 472, 2658, "Input",ExpressionUUID->"aaea907b-880f-43bf-ad0b-57bee5ae6643",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[61410, 1265, 503, 7, 43, "Subsection",ExpressionUUID->"8a3824ca-f692-4518-8496-1471ab3e1e6e"],
Cell[61916, 1274, 48823, 1171, 7631, "Input",ExpressionUUID->"f2cecb38-9f8d-4929-b2a9-a242eaa543b5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[110776, 2450, 516, 7, 43, "Subsection",ExpressionUUID->"447b3b0e-75f4-47b3-a64a-78bf3de169ee"],
Cell[111295, 2459, 33759, 797, 4277, "Input",ExpressionUUID->"ddc481c0-94e3-4c45-956f-8153bed520bd",
 InitializationCell->True],
Cell[145057, 3258, 1396, 30, 127, "Input",ExpressionUUID->"36090b63-ae54-4f1b-94e5-fa11e9a62475"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[146502, 3294, 204, 4, 67, "Section",ExpressionUUID->"705fb16b-8cc2-45c0-ad21-d6e11d6bf620"],
Cell[CellGroupData[{
Cell[146731, 3302, 491, 7, 45, "Subsubsection",ExpressionUUID->"1f27300e-a2ff-473e-bbec-27457f1ab2b6"],
Cell[147225, 3311, 683, 13, 114, "Abstract",ExpressionUUID->"d80f12ec-e7c7-40e5-8bad-f099f3729550"],
Cell[147911, 3326, 857, 15, 44, "Input",ExpressionUUID->"ea809154-2c1c-41a8-a2b3-a45f80bbdfad",
 InitializationCell->True],
Cell[148771, 3343, 5136, 104, 595, "Input",ExpressionUUID->"2b5cef35-4c1a-4a20-83fa-c586037cf742"],
Cell[153910, 3449, 1460, 32, 185, "Input",ExpressionUUID->"c896e02f-9b14-4d34-b522-6c913708f87a"],
Cell[155373, 3483, 653, 12, 114, "Abstract",ExpressionUUID->"e64fe3f4-2fa6-40aa-9559-4213b991c635"],
Cell[156029, 3497, 1357, 22, 44, "Input",ExpressionUUID->"d8d5bcef-e524-4621-8af8-ec25bbbe5cef",
 InitializationCell->True],
Cell[157389, 3521, 1174, 28, 107, "Input",ExpressionUUID->"ac438bf6-8991-4af6-a004-941a9b35b5af"]
}, Closed]],
Cell[CellGroupData[{
Cell[158600, 3554, 461, 7, 37, "Subsubsection",ExpressionUUID->"f057e038-c20b-4c37-be24-dc8b7caebf76"],
Cell[159064, 3563, 1826, 34, 127, "Input",ExpressionUUID->"481aef5d-0460-4b8a-90c1-981f84e664e5"]
}, Closed]],
Cell[CellGroupData[{
Cell[160927, 3602, 462, 7, 37, "Subsubsection",ExpressionUUID->"0b83ef93-446d-460d-a2eb-064a64462b5f"],
Cell[161392, 3611, 3146, 68, 419, "Input",ExpressionUUID->"cc3d71a1-0da4-48cd-a813-bc6f4261201e"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[164587, 3685, 663, 10, 67, "Section",ExpressionUUID->"a8f455e4-79ce-4a1f-aa6e-c1acf7a0f4f8"],
Cell[CellGroupData[{
Cell[165275, 3699, 959, 13, 59, "Subsection",ExpressionUUID->"57c12432-79fe-429b-90ae-cc5390c78762"],
Cell[CellGroupData[{
Cell[166259, 3716, 527, 7, 45, "Subsubsection",ExpressionUUID->"785ccf5c-0364-401f-bc40-87074b8ab9c8"],
Cell[166789, 3725, 918, 16, 139, "Abstract",ExpressionUUID->"2520eaf4-71de-477a-b1fd-56d1fbdf91f5"],
Cell[167710, 3743, 3186, 48, 123, "Input",ExpressionUUID->"23f96611-e7e7-42db-ba7b-cb26bb6f9d25",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[170933, 3796, 525, 7, 37, "Subsubsection",ExpressionUUID->"f5ba4b31-0e18-4925-98f0-95e8a6891566"],
Cell[171461, 3805, 988, 19, 189, "Abstract",ExpressionUUID->"27962eb2-7eab-428b-9cd2-b471c9a65d4c"],
Cell[172452, 3826, 594, 13, 104, "Input",ExpressionUUID->"09a3ae84-7d2b-4ab5-910d-136bc7180d02",
 InitializationCell->True],
Cell[173049, 3841, 696, 18, 49, "Input",ExpressionUUID->"46ff3fe9-3157-42b4-902f-da481bdcf34b"],
Cell[173748, 3861, 2091, 50, 244, "Input",ExpressionUUID->"bfc0f7fa-7303-4b4c-b24b-838e448a3f7e"],
Cell[175842, 3913, 1376, 33, 127, "Input",ExpressionUUID->"76038322-d853-430c-af3b-7f26e50dc209"],
Cell[177221, 3948, 1697, 46, 224, "Input",ExpressionUUID->"23cdcb8b-2164-4805-9f34-dfe88e5182eb"]
}, Closed]],
Cell[CellGroupData[{
Cell[178955, 3999, 500, 7, 37, "Subsubsection",ExpressionUUID->"e16f5a56-9ee3-4470-8084-1c59a81d0b83"],
Cell[179458, 4008, 4165, 86, 322, "Input",ExpressionUUID->"9efec952-6389-4b3d-a5a7-ce72a9be9bc7"],
Cell[183626, 4096, 828, 15, 114, "Abstract",ExpressionUUID->"3e4272f9-40b7-4687-82c6-e9b7d57619ea"],
Cell[184457, 4113, 482, 9, 44, "Input",ExpressionUUID->"cb24941b-fc44-4423-adf4-0c0481e177d6",
 InitializationCell->True],
Cell[184942, 4124, 788, 16, 88, "Input",ExpressionUUID->"6989c541-20e6-44bc-9a0e-0a82cb16a3b3"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[185779, 4146, 965, 13, 59, "Subsection",ExpressionUUID->"8c67e410-e8ef-4028-91ec-9a1fe745b787"],
Cell[186747, 4161, 577, 11, 114, "Abstract",ExpressionUUID->"a882c9bf-f789-44c4-a104-23816baa6891"],
Cell[187327, 4174, 635, 15, 44, "Input",ExpressionUUID->"d9ccee59-67aa-4520-8ce3-7f6d1611964b",
 InitializationCell->True],
Cell[187965, 4191, 3708, 83, 244, "Input",ExpressionUUID->"bfd2b433-fc8c-43ed-99fd-144dcc38119a"],
Cell[191676, 4276, 669, 15, 107, "Input",ExpressionUUID->"4ceeeabf-ea97-4992-909f-58aa55e1d6eb"],
Cell[192348, 4293, 452, 11, 68, "Input",ExpressionUUID->"205f8358-d959-445b-8cbb-ad8732d67c81"]
}, Closed]],
Cell[CellGroupData[{
Cell[192837, 4309, 1013, 13, 43, "Subsection",ExpressionUUID->"11e09dc4-7b2d-42be-82f1-0ad5ee354cf1"],
Cell[CellGroupData[{
Cell[193875, 4326, 271, 4, 45, "Subsubsection",ExpressionUUID->"241bb69c-deed-41e9-a9fc-946c007e235d"],
Cell[194149, 4332, 1184, 26, 339, "Abstract",ExpressionUUID->"8fef5d3f-6780-4f1c-aee6-ba385dd5683f"],
Cell[195336, 4360, 1936, 32, 104, "Input",ExpressionUUID->"b12395dd-321d-45a0-af32-783f05c262a9",
 InitializationCell->True],
Cell[197275, 4394, 3661, 80, 244, "Input",ExpressionUUID->"1cd5a62c-1f4d-4297-9814-f40a8aa0f182"]
}, Closed]],
Cell[CellGroupData[{
Cell[200973, 4479, 284, 4, 37, "Subsubsection",ExpressionUUID->"bf33ffca-ff4d-4605-98fe-dc908820c9da"],
Cell[201260, 4485, 724, 14, 139, "Abstract",ExpressionUUID->"65eec531-3915-4be4-b1e0-7dcc18524bed"],
Cell[201987, 4501, 425, 9, 65, "Input",ExpressionUUID->"1c8edb82-0058-4b9c-8ead-445ff4660900",
 InitializationCell->True],
Cell[202415, 4512, 1675, 36, 88, "Input",ExpressionUUID->"b20790f2-27b9-4ce8-9d0d-ead93ff5cf67"]
}, Closed]],
Cell[CellGroupData[{
Cell[204127, 4553, 320, 5, 37, "Subsubsection",ExpressionUUID->"f87cb3e8-c62c-4217-b3e2-faa8ab2130c2"],
Cell[204450, 4560, 2274, 60, 341, "Input",ExpressionUUID->"5af96644-784d-4732-b0ca-008f19fadd5a"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[206785, 4627, 1006, 13, 62, "Section",ExpressionUUID->"b50be401-c600-4e4b-acc1-e4229cbd348a"],
Cell[CellGroupData[{
Cell[207816, 4644, 293, 5, 54, "Subsection",ExpressionUUID->"ea3c928b-d6a6-465a-b2de-69af703d8ee8"],
Cell[CellGroupData[{
Cell[208134, 4653, 236, 4, 45, "Subsubsection",ExpressionUUID->"528ac027-0049-4b08-ae8f-818cdc7130ac"],
Cell[208373, 4659, 1807, 39, 489, "Abstract",ExpressionUUID->"9e4dc657-80bd-4756-8c14-f50b743eef7a"],
Cell[210183, 4700, 4435, 75, 182, "Input",ExpressionUUID->"b6452a88-a051-43e0-8781-18fda747bfcc",
 InitializationCell->True],
Cell[214621, 4777, 5958, 111, 302, "Input",ExpressionUUID->"4cac5f0b-7824-430b-959f-03a21be2c4e1"],
Cell[220582, 4890, 501, 8, 62, "Abstract",ExpressionUUID->"eac501b9-3b2f-4983-bf61-92d465e040bc"]
}, Closed]],
Cell[CellGroupData[{
Cell[221120, 4903, 170, 3, 37, "Subsubsection",ExpressionUUID->"5287eeea-12b4-41aa-bb24-b299f23bae50"],
Cell[221293, 4908, 2072, 47, 205, "Input",ExpressionUUID->"ec68b82b-4fe4-41d5-ba27-4c9eddded434"],
Cell[223368, 4957, 1906, 45, 224, "Input",ExpressionUUID->"89339474-5422-48fc-b2ff-d29334c02911"]
}, Closed]],
Cell[CellGroupData[{
Cell[225311, 5007, 415, 6, 37, "Subsubsection",ExpressionUUID->"6f01c45d-8e9d-4522-bda8-81d886133a7a"],
Cell[225729, 5015, 2093, 42, 185, "Input",ExpressionUUID->"cd332113-7721-4274-a73e-ef005b83d69a"]
}, Closed]],
Cell[CellGroupData[{
Cell[227859, 5062, 414, 6, 37, "Subsubsection",ExpressionUUID->"043b40e5-a83a-4eee-87f2-5039190f743b"],
Cell[228276, 5070, 2935, 64, 380, "Input",ExpressionUUID->"431189e7-285e-43bb-b569-b4c5912f2a72"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[231260, 5140, 320, 5, 54, "Subsection",ExpressionUUID->"4c4ea592-dfda-4ecc-b100-310a7c3f164e"],
Cell[CellGroupData[{
Cell[231605, 5149, 246, 4, 45, "Subsubsection",ExpressionUUID->"0286ee20-162e-4651-84b3-f368042ca6b9"],
Cell[231854, 5155, 1112, 19, 164, "Abstract",ExpressionUUID->"1baa7b90-5526-4815-93e1-646baa64c3ce"],
Cell[232969, 5176, 5346, 80, 84, "Input",ExpressionUUID->"02e3e63a-3b47-4435-b4c4-8cdab2c0bd0e",
 InitializationCell->True],
Cell[238318, 5258, 2495, 60, 224, "Input",ExpressionUUID->"5166c002-7a44-4136-9e53-e9f9b09df4a9"]
}, Closed]],
Cell[CellGroupData[{
Cell[240850, 5323, 170, 3, 37, "Subsubsection",ExpressionUUID->"2b42903a-c151-45eb-8851-9dd237eaa497"],
Cell[241023, 5328, 3367, 76, 361, "Input",ExpressionUUID->"a81767cd-fb1e-4d81-9d19-3022e3a6a5cb"]
}, Closed]],
Cell[CellGroupData[{
Cell[244427, 5409, 441, 6, 37, "Subsubsection",ExpressionUUID->"21fd8fa1-60db-415b-b1ad-271f1efdb2ea"],
Cell[244871, 5417, 2176, 42, 185, "Input",ExpressionUUID->"0c923432-fdae-45ad-b7cf-1c417e1bdda5"]
}, Closed]],
Cell[CellGroupData[{
Cell[247084, 5464, 468, 7, 37, "Subsubsection",ExpressionUUID->"741176c0-583c-4f52-8946-6871527c901d"],
Cell[247555, 5473, 3024, 65, 380, "Input",ExpressionUUID->"b8042fc3-f3a5-4da0-b0d9-f68bd80e4746"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[250628, 5544, 368, 6, 54, "Subsection",ExpressionUUID->"13d5d097-fe83-4093-82eb-c5d3b30df571"],
Cell[CellGroupData[{
Cell[251021, 5554, 410, 6, 45, "Subsubsection",ExpressionUUID->"fcde20d7-6d37-4802-9a84-63d6eb7077b1"],
Cell[251434, 5562, 905, 17, 189, "Abstract",ExpressionUUID->"1a67ff3a-8601-43f8-9b8e-b60789f8f57f"],
Cell[252342, 5581, 1354, 29, 104, "Input",ExpressionUUID->"2f44eaa2-e584-4a7d-8efe-89189236dbf7",
 InitializationCell->True],
Cell[253699, 5612, 1904, 45, 205, "Input",ExpressionUUID->"41c0578e-f87d-40cf-8db6-c8fbad50f919"]
}, Closed]],
Cell[CellGroupData[{
Cell[255640, 5662, 452, 7, 37, "Subsubsection",ExpressionUUID->"c6954c0f-993f-4baf-b16c-d2dac6a90db4"],
Cell[256095, 5671, 3262, 66, 205, "Input",ExpressionUUID->"0ab6cd17-61c5-43dd-a5c5-5ee8a6766803"]
}, Closed]],
Cell[CellGroupData[{
Cell[259394, 5742, 421, 6, 37, "Subsubsection",ExpressionUUID->"b6e7aad2-df50-43f2-9a9b-2a18a857b7f9"],
Cell[259818, 5750, 611, 12, 114, "Abstract",ExpressionUUID->"29b1709d-2e6c-4865-99a1-6492fc613cc9"],
Cell[260432, 5764, 1814, 27, 44, "Input",ExpressionUUID->"80888c19-c5cd-4c99-ba36-c5677f46c917",
 InitializationCell->True],
Cell[262249, 5793, 1913, 44, 146, "Input",ExpressionUUID->"9082d2f6-3120-4154-a31b-40ca956bd731"],
Cell[264165, 5839, 852, 19, 88, "Input",ExpressionUUID->"11d34b7f-8c3c-4dc1-bfe3-1e111d752e62"]
}, Closed]],
Cell[CellGroupData[{
Cell[265054, 5863, 452, 7, 37, "Subsubsection",ExpressionUUID->"3bfd97ac-fca0-43eb-9c8b-2743a1e395c4"],
Cell[265509, 5872, 1122, 22, 127, "Input",ExpressionUUID->"fe169004-6908-4770-91c6-1fc6caca6adb"]
}, Closed]],
Cell[CellGroupData[{
Cell[266668, 5899, 546, 8, 37, "Subsubsection",ExpressionUUID->"ee00c5e3-13ec-4adc-a652-1507966c0e2e"],
Cell[267217, 5909, 2312, 39, 185, "Input",ExpressionUUID->"ffc1ed16-7771-4abb-aa9c-f35f346937d7"]
}, Closed]],
Cell[CellGroupData[{
Cell[269566, 5953, 578, 8, 37, "Subsubsection",ExpressionUUID->"16fa1ebb-2f61-4dbb-9517-6fd3250f5c82"],
Cell[270147, 5963, 2055, 36, 146, "Input",ExpressionUUID->"938c1213-8b9f-4918-a6a3-7d88eab3ea91"]
}, Closed]],
Cell[CellGroupData[{
Cell[272239, 6004, 682, 10, 37, "Subsubsection",ExpressionUUID->"8cbbf77b-7209-4708-8432-8a88bec5e046"],
Cell[272924, 6016, 468, 11, 68, "Input",ExpressionUUID->"41741181-8ccb-451b-993a-b48291736a7b"],
Cell[273395, 6029, 439, 11, 44, "Input",ExpressionUUID->"c20695a2-252a-4628-ad15-7dfd134ab684",
 InitializationCell->True],
Cell[273837, 6042, 4517, 104, 478, "Input",ExpressionUUID->"b7cfda01-f7f3-45f4-befc-ed5dde36e8a3"],
Cell[278357, 6148, 2010, 38, 146, "Input",ExpressionUUID->"dc184d1c-1f96-4f00-854c-d8e64ee355fb"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[280428, 6193, 659, 10, 67, "Section",ExpressionUUID->"0d8689fa-7cdd-4577-b326-9b230686960c"],
Cell[CellGroupData[{
Cell[281112, 6207, 1067, 14, 59, "Subsection",ExpressionUUID->"01da7cf0-85f2-4179-8cfb-734234406e09"],
Cell[282182, 6223, 660, 12, 114, "Abstract",ExpressionUUID->"1ad30552-fb44-434b-8b6d-fcc89b7fcc9f"],
Cell[282845, 6237, 5206, 72, 44, "Input",ExpressionUUID->"02cfe379-c867-433e-855f-83e988752177",
 InitializationCell->True],
Cell[288054, 6311, 5029, 125, 458, "Input",ExpressionUUID->"7fee3c13-3388-47aa-aaf2-1e5edb9c800d"]
}, Closed]],
Cell[CellGroupData[{
Cell[293120, 6441, 1086, 14, 43, "Subsection",ExpressionUUID->"999f98ec-deb8-4533-b205-e1750468e328"],
Cell[294209, 6457, 916, 19, 214, "Abstract",ExpressionUUID->"03e70019-11f3-43e1-8ba4-cb41086e7197"],
Cell[295128, 6478, 2547, 43, 123, "Input",ExpressionUUID->"dcfecb3d-08fd-4138-87ce-c06add2bafd3",
 InitializationCell->True],
Cell[297678, 6523, 2561, 57, 224, "Input",ExpressionUUID->"b36aa250-7d25-4d6c-b78b-15b0e6f5ee32"]
}, Closed]],
Cell[CellGroupData[{
Cell[300276, 6585, 1055, 14, 43, "Subsection",ExpressionUUID->"59d71f38-4a7c-42c4-a35e-6e598610a7bf"],
Cell[301334, 6601, 661, 12, 114, "Abstract",ExpressionUUID->"2d7207b5-33a2-4848-878a-9a33759e244c"],
Cell[301998, 6615, 2941, 42, 44, "Input",ExpressionUUID->"abfe8584-59d4-436a-89bd-81fada03aa92",
 InitializationCell->True],
Cell[304942, 6659, 2727, 51, 146, "Input",ExpressionUUID->"b996fb21-f8ae-4ad4-8bbd-0f9ce37aad6c"]
}, Closed]],
Cell[CellGroupData[{
Cell[307706, 6715, 1181, 16, 43, "Subsection",ExpressionUUID->"df62ec4c-b4fc-44ec-b932-0d58a73b5126"],
Cell[308890, 6733, 5281, 120, 552, "Input",ExpressionUUID->"bd611090-ff5e-40b8-99b1-850600c4f95e",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[314196, 6857, 1225, 16, 51, "Subsubsection",ExpressionUUID->"e71d650e-b5f5-4396-a99b-1b1c515f1247"],
Cell[315424, 6875, 303, 4, 62, "Abstract",ExpressionUUID->"cbb62edb-fa52-47fe-8996-b0e8fc6393c3"],
Cell[315730, 6881, 6545, 136, 595, "Input",ExpressionUUID->"4671006c-fe4b-4116-a535-561479e260da"]
}, Closed]],
Cell[CellGroupData[{
Cell[322312, 7022, 1244, 16, 43, "Subsubsection",ExpressionUUID->"64e09817-15a7-4c9a-ac1f-24ac8ff5c970"],
Cell[323559, 7040, 1862, 51, 166, "Input",ExpressionUUID->"0ebbc99c-c379-4c13-9e56-1dad16ba4a23"],
Cell[325424, 7093, 1719, 40, 166, "Input",ExpressionUUID->"eb9689ad-3d48-45d1-aaf3-545efefa1ef1"],
Cell[327146, 7135, 636, 16, 88, "Input",ExpressionUUID->"01a1b047-22a5-4fd1-8190-a6803451f207"]
}, Closed]],
Cell[CellGroupData[{
Cell[327819, 7156, 1297, 17, 43, "Subsubsection",ExpressionUUID->"05a82a43-c939-4e6f-82aa-3379263582cf"],
Cell[329119, 7175, 1072, 20, 84, "Input",ExpressionUUID->"13553c55-2d04-475e-8e7d-6f0453bc7428",
 InitializationCell->True],
Cell[330194, 7197, 2170, 59, 283, "Input",ExpressionUUID->"09e5cb60-1050-4d64-8ce0-92adc6fa4292"],
Cell[332367, 7258, 286, 8, 108, "Abstract",ExpressionUUID->"3b78ae5c-f002-46a6-a3b2-0d6f19f240b1"],
Cell[332656, 7268, 262, 6, 44, "Input",ExpressionUUID->"30ab5ce6-1e06-419f-9c72-0bc3941405bf",
 InitializationCell->True],
Cell[332921, 7276, 2367, 50, 244, "Input",ExpressionUUID->"f70fe180-70ab-4b03-be59-47dd42477ca4"],
Cell[335291, 7328, 839, 19, 49, "Input",ExpressionUUID->"2fae5440-f099-44ad-a30f-e7a5fd6d51cc"],
Cell[336133, 7349, 372, 10, 154, "Abstract",ExpressionUUID->"3b751cc0-bae7-4553-a7db-69d12ecc5a01"],
Cell[336508, 7361, 1004, 21, 84, "Input",ExpressionUUID->"5dab7c26-63e9-45f9-bfdc-778d77d93102",
 InitializationCell->True],
Cell[337515, 7384, 2641, 65, 283, "Input",ExpressionUUID->"13ed54ac-c320-49bb-8633-9b5e196aef5a"],
Cell[340159, 7451, 3303, 68, 283, "Input",ExpressionUUID->"ddd02268-ec2e-4ecc-b8ed-50f866443cd2"],
Cell[343465, 7521, 3412, 72, 361, "Input",ExpressionUUID->"0bbb1b6b-e081-4508-8c65-a94f0703bce8"],
Cell[346880, 7595, 3332, 75, 400, "Input",ExpressionUUID->"dce8626e-3c06-405e-ac52-93f2099c43f4"],
Cell[350215, 7672, 664, 14, 68, "Input",ExpressionUUID->"14351500-7c91-45b2-a402-e06e18fc50a1"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[350928, 7692, 1119, 15, 59, "Subsection",ExpressionUUID->"a19d602d-3682-42b2-b407-13e492342496"],
Cell[CellGroupData[{
Cell[352072, 7711, 352, 5, 45, "Subsubsection",ExpressionUUID->"e6c87574-8e2f-4693-8348-c34a358fbae1"],
Cell[352427, 7718, 704, 13, 114, "Abstract",ExpressionUUID->"6a90a8bc-fc39-4130-99fd-1d62ca80b8c1"],
Cell[353134, 7733, 405, 8, 44, "Input",ExpressionUUID->"37034ed4-1879-4b92-bc6f-f7da8b8a9225",
 InitializationCell->True],
Cell[353542, 7743, 1115, 27, 166, "Input",ExpressionUUID->"d927bf49-3f01-4dab-8d72-d7204b9cc117"],
Cell[354660, 7772, 2955, 74, 439, "Input",ExpressionUUID->"757211b0-6027-42f7-b5cd-607355beae7a"]
}, Closed]],
Cell[CellGroupData[{
Cell[357652, 7851, 403, 6, 37, "Subsubsection",ExpressionUUID->"a67707dc-e65d-4ab2-9263-2b967a2cd363"],
Cell[358058, 7859, 546, 14, 68, "Input",ExpressionUUID->"d0504684-0251-448a-a1d7-8fc2bb358fa8"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[358653, 7879, 1113, 15, 59, "Subsection",ExpressionUUID->"bd36558d-a5cd-411b-b6a1-e7eb12bf8b55"],
Cell[CellGroupData[{
Cell[359791, 7898, 427, 6, 45, "Subsubsection",ExpressionUUID->"f367133f-dcae-4fdc-86fb-00b0df95ada0"],
Cell[360221, 7906, 4287, 110, 517, "Input",ExpressionUUID->"21125c16-7b17-4b6a-b9df-c6d0a35ca81d"]
}, Closed]],
Cell[CellGroupData[{
Cell[364545, 8021, 387, 6, 37, "Subsubsection",ExpressionUUID->"56117cc6-ab6c-4ef9-8b5c-2d96923661d4"],
Cell[364935, 8029, 1364, 34, 224, "Input",ExpressionUUID->"8c01581f-8849-402e-9275-a60093b8d935"]
}, Closed]],
Cell[CellGroupData[{
Cell[366336, 8068, 488, 7, 37, "Subsubsection",ExpressionUUID->"140cec79-705c-49b3-93e0-ebd0e503be14"],
Cell[366827, 8077, 532, 12, 68, "Input",ExpressionUUID->"044e1790-784f-4ca4-8aae-be8f00d05c0a"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[367420, 8096, 1132, 15, 62, "Section",ExpressionUUID->"5b08617f-06df-47be-9f46-90fc17939434"],
Cell[CellGroupData[{
Cell[368577, 8115, 1169, 16, 59, "Subsection",ExpressionUUID->"04390ac5-77fc-4903-891b-c7d8a68bf1de"],
Cell[CellGroupData[{
Cell[369771, 8135, 697, 10, 45, "Subsubsection",ExpressionUUID->"13a219ef-07e5-4173-b011-82366b07517b"],
Cell[370471, 8147, 830, 15, 114, "Abstract",ExpressionUUID->"9ffa6fce-5b77-46ca-a7e4-cdddedeb763b"],
Cell[371304, 8164, 921, 16, 44, "Input",ExpressionUUID->"b5eb7c86-e98e-4d28-bc7d-e3ba9ad1ab6b",
 InitializationCell->True],
Cell[372228, 8182, 2489, 57, 166, "Input",ExpressionUUID->"113e9469-8067-4d38-b0a6-d7f103dedc3a"],
Cell[374720, 8241, 2186, 46, 205, "Input",ExpressionUUID->"499cabd4-9a31-4fd0-ae1c-c1acb70e6428"],
Cell[376909, 8289, 1787, 45, 166, "Input",ExpressionUUID->"f5116177-6145-48d2-a8d4-e61c1f808785"]
}, Closed]],
Cell[CellGroupData[{
Cell[378733, 8339, 751, 10, 37, "Subsubsection",ExpressionUUID->"e3c8fe69-6762-47d2-b407-2ae801e07558"],
Cell[379487, 8351, 943, 24, 49, "Input",ExpressionUUID->"73575f08-75ca-4353-9f09-21b1da0edc08"],
Cell[380433, 8377, 5003, 129, 536, "Input",ExpressionUUID->"f4836780-968c-4b64-a46a-95c758b3c99b"]
}, Closed]],
Cell[CellGroupData[{
Cell[385473, 8511, 596, 8, 37, "Subsubsection",ExpressionUUID->"37478185-fd4a-47a3-a262-d5507f6ae1de"],
Cell[386072, 8521, 2848, 54, 263, "Input",ExpressionUUID->"f516cdf9-e5fa-4552-b514-e541debe64af"]
}, Closed]],
Cell[CellGroupData[{
Cell[388957, 8580, 606, 8, 37, "Subsubsection",ExpressionUUID->"314b7093-fb5e-4b32-9ccd-e8012011c435"],
Cell[389566, 8590, 2197, 39, 146, "Input",ExpressionUUID->"3eff419d-eaf6-493c-ae6c-101c10eb0bf9"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[391812, 8635, 1117, 15, 59, "Subsection",ExpressionUUID->"f05f1729-0360-41d4-995e-95680bb40e24"],
Cell[392932, 8652, 1574, 32, 143, "Input",ExpressionUUID->"fadd9a50-f923-4466-b7e0-587ca83d4aee",
 InitializationCell->True],
Cell[394509, 8686, 895, 23, 107, "Input",ExpressionUUID->"c3827892-5b4b-46ac-9224-b53402c6f991"],
Cell[395407, 8711, 448, 11, 65, "Input",ExpressionUUID->"218f51df-a0fc-47db-89db-f51775e338e6",
 InitializationCell->True],
Cell[395858, 8724, 3549, 75, 224, "Input",ExpressionUUID->"8a12b23d-c3c5-429a-a71e-15aa7840c980"],
Cell[399410, 8801, 323, 7, 28, "Input",ExpressionUUID->"015bdac7-b39e-4eb4-ad88-9d22ed916e78"],
Cell[399736, 8810, 357, 9, 44, "Input",ExpressionUUID->"e338ae49-62b4-4924-bb1e-9d622b0a9ca4",
 InitializationCell->True],
Cell[400096, 8821, 660, 17, 88, "Input",ExpressionUUID->"032f40d0-5bd2-4e9e-acf7-b009ff49711a"],
Cell[400759, 8840, 1608, 40, 143, "Input",ExpressionUUID->"40d0f996-96d9-41e2-8466-960b6e0604ff",
 InitializationCell->True],
Cell[402370, 8882, 2349, 44, 166, "Input",ExpressionUUID->"df49e4c7-bb6f-485b-9dd9-a49f883cf9bd"],
Cell[404722, 8928, 2572, 48, 185, "Input",ExpressionUUID->"9c8275bc-8a7d-44d1-b646-9d9beb60896f"],
Cell[407297, 8978, 592, 14, 49, "Input",ExpressionUUID->"56da7190-0ce3-4e11-b4e0-b8e5b1868d8f"]
}, Closed]],
Cell[CellGroupData[{
Cell[407926, 8997, 1217, 16, 43, "Subsection",ExpressionUUID->"96ebe85e-ac59-448d-9f90-a0f1b68f6f8b"],
Cell[409146, 9015, 737, 16, 84, "Input",ExpressionUUID->"7efbd823-8762-4c70-9d15-a0e19ced5df9",
 InitializationCell->True],
Cell[409886, 9033, 1449, 27, 146, "Input",ExpressionUUID->"528607d2-8730-437e-8788-fcd35565e34c"],
Cell[411338, 9062, 412, 9, 28, "Input",ExpressionUUID->"4e55e748-4190-48c1-a244-51d61f2ad267"]
}, Closed]],
Cell[CellGroupData[{
Cell[411787, 9076, 1276, 17, 43, "Subsection",ExpressionUUID->"92553685-3b93-4515-82ee-da748e8d80dc"],
Cell[413066, 9095, 877, 18, 214, "Abstract",ExpressionUUID->"ff14ec22-7e6d-4f7b-aa5a-254a74f0da09"],
Cell[413946, 9115, 4144, 79, 279, "Input",ExpressionUUID->"6fd5c14b-b0a0-438c-acee-08148800a1bd",
 InitializationCell->True],
Cell[418093, 9196, 5140, 112, 419, "Input",ExpressionUUID->"b6efb721-b3d3-42c8-8378-3e364208eaee"],
Cell[423236, 9310, 2023, 33, 84, "Input",ExpressionUUID->"3bb495d7-8737-4a8e-bfa0-c1e943633cd6",
 InitializationCell->True],
Cell[425262, 9345, 1013, 20, 239, "Abstract",ExpressionUUID->"28575577-4c9e-465f-8035-7b696d894ae7"],
Cell[426278, 9367, 5756, 113, 338, "Input",ExpressionUUID->"523b10ca-7f65-49af-8c23-31a2243f4eb3",
 InitializationCell->True],
Cell[432037, 9482, 1010, 16, 68, "Input",ExpressionUUID->"f49f9f32-aac6-4b12-a1e1-57aadd75db7a"],
Cell[433050, 9500, 1150, 22, 146, "Input",ExpressionUUID->"911e6823-b1cb-4246-8235-9fcef9d04411"]
}, Closed]],
Cell[CellGroupData[{
Cell[434237, 9527, 1329, 18, 43, "Subsection",ExpressionUUID->"ffda348c-707a-4576-9958-3bf53e7c0b40"],
Cell[CellGroupData[{
Cell[435591, 9549, 635, 9, 45, "Subsubsection",ExpressionUUID->"9872da17-9b74-49f1-8c7f-5b56583ce302"],
Cell[436229, 9560, 3063, 80, 341, "Input",ExpressionUUID->"0e3fce83-583a-4a50-9a15-ffe778e1c54a"],
Cell[439295, 9642, 476, 11, 88, "Input",ExpressionUUID->"c5a1212c-25cf-48c0-8b37-4fa8a7d7b9c6"]
}, Closed]],
Cell[CellGroupData[{
Cell[439808, 9658, 620, 9, 37, "Subsubsection",ExpressionUUID->"dc581774-72a4-4de4-bfd4-4286cc10be2a"],
Cell[440431, 9669, 993, 23, 104, "Input",ExpressionUUID->"667692a7-630a-4871-b7cd-2a600830b8fc",
 InitializationCell->True],
Cell[441427, 9694, 1178, 21, 189, "Abstract",ExpressionUUID->"7bd06757-b0ff-4792-b792-f5562b105aff"],
Cell[442608, 9717, 612, 16, 104, "Input",ExpressionUUID->"9336249b-cad8-4213-ab31-2aeb0f9b911c",
 InitializationCell->True],
Cell[443223, 9735, 1515, 36, 88, "Input",ExpressionUUID->"432d5d3e-74af-4061-9e5e-2108251b82e5"],
Cell[444741, 9773, 826, 15, 114, "Abstract",ExpressionUUID->"4ccbb041-c677-45d0-8f0b-c99311c17a0a"],
Cell[445570, 9790, 362, 8, 44, "Input",ExpressionUUID->"56cdb3eb-4f6a-4747-9fb2-7d4b3b735fca",
 InitializationCell->True],
Cell[445935, 9800, 2358, 38, 28, "Input",ExpressionUUID->"a66dd750-3ad2-48ec-a81b-b11284bd5ce8"]
}, Closed]],
Cell[CellGroupData[{
Cell[448330, 9843, 686, 10, 37, "Subsubsection",ExpressionUUID->"c52af2f1-08ff-4f18-8efd-55bfd666bf0d"],
Cell[449019, 9855, 3626, 61, 107, "Input",ExpressionUUID->"3a31fbbe-082d-41b8-b5de-1ac635cd3342"],
Cell[452648, 9918, 846, 23, 68, "Input",ExpressionUUID->"a06f9a06-78f5-4677-be5f-2cd91bf1b4a6"],
Cell[453497, 9943, 1223, 22, 214, "Abstract",ExpressionUUID->"4eb98b75-4d5c-4511-8fbd-d0c97b56c3f8"],
Cell[454723, 9967, 658, 12, 65, "Input",ExpressionUUID->"1fb49f1b-cca7-485c-b877-134994499c33",
 InitializationCell->True],
Cell[455384, 9981, 2582, 50, 146, "Input",ExpressionUUID->"952f83f7-33e1-4a92-8b64-95792f47858c"],
Cell[457969, 10033, 554, 11, 68, "Input",ExpressionUUID->"331a7bf8-efd9-4330-9945-996ed2c96f7b"],
Cell[458526, 10046, 446, 9, 88, "Input",ExpressionUUID->"079919ce-1e4c-48d1-8b73-08a038660f62"],
Cell[458975, 10057, 1095, 24, 88, "Input",ExpressionUUID->"cc5ae4ab-f06c-4e6f-8395-51cdcef949a8"],
Cell[460073, 10083, 500, 12, 68, "Input",ExpressionUUID->"269ac135-e2db-428a-9d5b-500cc1ec1732"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[460634, 10102, 622, 9, 67, "Section",ExpressionUUID->"462bb91e-cca9-42ca-a1c5-5aaf623a0bea"],
Cell[461259, 10113, 2386, 49, 205, "Input",ExpressionUUID->"005b31f7-40f6-4a4c-a4e8-fd16784b653f"]
}, Closed]]
}
]
*)

